<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8">
  <meta name="viewport"
    content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
  <title>LDesign Editor - ç§»åŠ¨ç«¯æ‰‹åŠ¿æ¼”ç¤º</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      min-height: 100vh;
      padding: 20px;
      padding-top: env(safe-area-inset-top, 20px);
      padding-bottom: env(safe-area-inset-bottom, 20px);
    }

    .container {
      max-width: 800px;
      margin: 0 auto;
      background: white;
      border-radius: 16px;
      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 20px;
      text-align: center;
    }

    .header h1 {
      font-size: 24px;
      margin-bottom: 10px;
    }

    .header p {
      font-size: 14px;
      opacity: 0.9;
    }

    .editor-container {
      position: relative;
      min-height: 400px;
      background: white;
    }

    #editor {
      min-height: 400px;
      padding: 20px;
      font-size: 16px;
      line-height: 1.6;
      -webkit-tap-highlight-color: transparent;
    }

    .gesture-hints {
      background: #f5f5f5;
      padding: 20px;
      border-top: 1px solid #e0e0e0;
    }

    .gesture-hints h3 {
      font-size: 18px;
      margin-bottom: 15px;
      color: #333;
    }

    .hint-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
      gap: 15px;
    }

    .hint-item {
      background: white;
      padding: 12px;
      border-radius: 8px;
      border: 1px solid #e0e0e0;
      display: flex;
      align-items: center;
      gap: 10px;
    }

    .hint-icon {
      font-size: 24px;
      width: 40px;
      height: 40px;
      background: #f0f0f0;
      border-radius: 8px;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .hint-text {
      flex: 1;
    }

    .hint-title {
      font-weight: 600;
      font-size: 14px;
      color: #333;
      margin-bottom: 2px;
    }

    .hint-desc {
      font-size: 12px;
      color: #666;
    }

    .status-bar {
      position: fixed;
      top: 10px;
      right: 10px;
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 8px 12px;
      border-radius: 20px;
      font-size: 12px;
      z-index: 10000;
      display: flex;
      gap: 10px;
      align-items: center;
    }

    .status-item {
      display: flex;
      align-items: center;
      gap: 5px;
    }

    .status-label {
      opacity: 0.7;
    }

    .status-value {
      font-weight: 600;
    }

    .demo-content {
      padding: 20px;
      background: #fafafa;
      border-top: 1px solid #e0e0e0;
    }

    .demo-buttons {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-bottom: 20px;
    }

    .demo-button {
      padding: 10px 20px;
      background: #667eea;
      color: white;
      border: none;
      border-radius: 8px;
      font-size: 14px;
      cursor: pointer;
      transition: background-color 0.2s;
    }

    .demo-button:active {
      background: #5a67d8;
    }

    .info-panel {
      background: white;
      border-radius: 8px;
      padding: 15px;
      margin-top: 15px;
    }

    .info-title {
      font-size: 14px;
      font-weight: 600;
      margin-bottom: 10px;
      color: #333;
    }

    .info-content {
      font-size: 13px;
      color: #666;
      line-height: 1.5;
    }

    @media (max-width: 600px) {
      body {
        padding: 0;
      }

      .container {
        border-radius: 0;
      }

      .hint-grid {
        grid-template-columns: 1fr;
      }

      .status-bar {
        top: auto;
        bottom: 70px;
        right: 10px;
        left: 10px;
        justify-content: space-around;
      }
    }
  </style>
</head>

<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ“± ç§»åŠ¨ç«¯æ‰‹åŠ¿æ¼”ç¤º</h1>
      <p>ä½“éªŒä¸“ä¸ºè§¦æ‘¸è®¾å¤‡ä¼˜åŒ–çš„ç¼–è¾‘å™¨åŠŸèƒ½</p>
    </div>

    <div class="editor-container">
      <div id="editor"></div>
    </div>

    <div class="gesture-hints">
      <h3>æ”¯æŒçš„æ‰‹åŠ¿æ“ä½œ</h3>
      <div class="hint-grid">
        <div class="hint-item">
          <div class="hint-icon">ğŸ‘†</div>
          <div class="hint-text">
            <div class="hint-title">å•å‡»</div>
            <div class="hint-desc">å®šä½å…‰æ ‡ã€é€‰æ‹©æ–‡å­—</div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">ğŸ‘†ğŸ‘†</div>
          <div class="hint-text">
            <div class="hint-title">åŒå‡»</div>
            <div class="hint-desc">å¿«é€Ÿç¼©æ”¾å†…å®¹</div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">ğŸ¤</div>
          <div class="hint-text">
            <div class="hint-title">åŒæŒ‡ç¼©æ”¾</div>
            <div class="hint-desc">æ”¾å¤§æˆ–ç¼©å°ç¼–è¾‘åŒºåŸŸ</div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">ğŸ‘ˆ</div>
          <div class="hint-text">
            <div class="hint-title">å·¦æ»‘</div>
            <div class="hint-desc">å…³é—­ä¾§è¾¹èœå•</div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">ğŸ‘‰</div>
          <div class="hint-text">
            <div class="hint-title">å³æ»‘(è¾¹ç¼˜)</div>
            <div class="hint-desc">æ‰“å¼€ä¾§è¾¹èœå•</div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">âœ‹</div>
          <div class="hint-text">
            <div class="hint-title">é•¿æŒ‰</div>
            <div class="hint-desc">æ˜¾ç¤ºä¸Šä¸‹æ–‡èœå•</div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">ğŸ”„</div>
          <div class="hint-text">
            <div class="hint-title">åŒæŒ‡æ—‹è½¬</div>
            <div class="hint-desc">æ—‹è½¬å›¾ç‰‡æˆ–å…ƒç´ </div>
          </div>
        </div>
        <div class="hint-item">
          <div class="hint-icon">ğŸ“±</div>
          <div class="hint-text">
            <div class="hint-title">æ‘‡åŠ¨è®¾å¤‡</div>
            <div class="hint-desc">æ’¤é”€æœ€è¿‘æ“ä½œ</div>
          </div>
        </div>
      </div>
    </div>

    <div class="demo-content">
      <div class="demo-buttons">
        <button class="demo-button" onclick="loadSampleContent()">åŠ è½½ç¤ºä¾‹å†…å®¹</button>
        <button class="demo-button" onclick="resetZoom()">é‡ç½®ç¼©æ”¾</button>
        <button class="demo-button" onclick="toggleToolbar()">åˆ‡æ¢å·¥å…·æ </button>
        <button class="demo-button" onclick="showMenu()">æ˜¾ç¤ºèœå•</button>
        <button class="demo-button" onclick="insertImage()">æ’å…¥å›¾ç‰‡</button>
        <button class="demo-button" onclick="toggleDarkMode()">æš—é»‘æ¨¡å¼</button>
      </div>

      <div class="info-panel">
        <div class="info-title">ğŸ“Š è®¾å¤‡ä¿¡æ¯</div>
        <div class="info-content" id="device-info">
          æ£€æµ‹ä¸­...
        </div>
      </div>

      <div class="info-panel">
        <div class="info-title">ğŸ‘† æœ€è¿‘æ‰‹åŠ¿</div>
        <div class="info-content" id="gesture-log">
          ç­‰å¾…æ‰‹åŠ¿è¾“å…¥...
        </div>
      </div>
    </div>
  </div>

  <div class="status-bar">
    <div class="status-item">
      <span class="status-label">ç¼©æ”¾:</span>
      <span class="status-value" id="zoom-level">100%</span>
    </div>
    <div class="status-item">
      <span class="status-label">æ–¹å‘:</span>
      <span class="status-value" id="orientation">ç«–å±</span>
    </div>
    <div class="status-item">
      <span class="status-label">è§¦ç‚¹:</span>
      <span class="status-value" id="touch-count">0</span>
    </div>
  </div>

  <script type="module">
    import { Editor } from '../src/index.js'
    import { MobileEditorAdapter } from '../src/mobile/MobileEditorAdapter.js'

    // åˆå§‹åŒ–ç¼–è¾‘å™¨
    const editor = new Editor({
      placeholder: 'å¼€å§‹è¾“å…¥æˆ–ä½¿ç”¨æ‰‹åŠ¿æ“ä½œ...',
      autofocus: false,
      features: {
        bold: true,
        italic: true,
        underline: true,
        link: true,
        image: true,
        list: true,
        heading: true,
        code: true,
        table: true
      }
    })

    // æŒ‚è½½ç¼–è¾‘å™¨
    const editorElement = document.getElementById('editor')
    editor.mount(editorElement)

    // åˆå§‹åŒ–ç§»åŠ¨ç«¯é€‚é…å™¨
    const mobileAdapter = new MobileEditorAdapter(editor, {
      enableGestures: true,
      enableSwipeMenu: true,
      enableContextMenu: true,
      enableMobileToolbar: true,
      minZoom: 0.5,
      maxZoom: 3,
      initialZoom: 1
    })

    // ç›‘å¬æ‰‹åŠ¿äº‹ä»¶
    editor.on('pinch', (e) => {
      updateZoomLevel(e.scale)
      logGesture('åŒæŒ‡ç¼©æ”¾', `ç¼©æ”¾æ¯”ä¾‹: ${e.scale.toFixed(2)}`)
    })

    editor.on('swipeleft', () => {
      logGesture('å·¦æ»‘', 'æ£€æµ‹åˆ°å·¦æ»‘æ‰‹åŠ¿')
    })

    editor.on('swiperight', () => {
      logGesture('å³æ»‘', 'æ£€æµ‹åˆ°å³æ»‘æ‰‹åŠ¿')
    })

    editor.on('longpress', (e) => {
      logGesture('é•¿æŒ‰', `ä½ç½®: (${e.x}, ${e.y})`)
    })

    editor.on('doubletap', () => {
      logGesture('åŒå‡»', 'å¿«é€Ÿç¼©æ”¾è§¦å‘')
    })

    editor.on('orientationchange', (e) => {
      document.getElementById('orientation').textContent =
        e.orientation === 'portrait' ? 'ç«–å±' : 'æ¨ªå±'
      logGesture('æ—‹è½¬', `åˆ‡æ¢åˆ°${e.orientation === 'portrait' ? 'ç«–å±' : 'æ¨ªå±'}æ¨¡å¼`)
    })

    // ç›‘å¬è§¦æ‘¸äº‹ä»¶
    let touchCount = 0
    editorElement.addEventListener('touchstart', (e) => {
      touchCount = e.touches.length
      document.getElementById('touch-count').textContent = touchCount
    })

    editorElement.addEventListener('touchend', () => {
      setTimeout(() => {
        document.getElementById('touch-count').textContent = '0'
      }, 100)
    })

    // è®¾å¤‡ä¿¡æ¯
    function updateDeviceInfo() {
      const info = [
        `è®¾å¤‡ç±»å‹: ${detectDeviceType()}`,
        `å±å¹•å°ºå¯¸: ${window.innerWidth} Ã— ${window.innerHeight}`,
        `åƒç´ å¯†åº¦: ${window.devicePixelRatio}`,
        `è§¦æ‘¸æ”¯æŒ: ${('ontouchstart' in window) ? 'æ˜¯' : 'å¦'}`,
        `ç”¨æˆ·ä»£ç†: ${navigator.userAgent.slice(0, 50)}...`
      ].join('<br>')

      document.getElementById('device-info').innerHTML = info
    }

    function detectDeviceType() {
      const ua = navigator.userAgent
      if (/iPad/.test(ua)) return 'iPad'
      if (/iPhone/.test(ua)) return 'iPhone'
      if (/Android/.test(ua) && !/Mobile/.test(ua)) return 'Androidå¹³æ¿'
      if (/Android/.test(ua)) return 'Androidæ‰‹æœº'
      if ('ontouchstart' in window) return 'è§¦æ‘¸è®¾å¤‡'
      return 'æ¡Œé¢è®¾å¤‡'
    }

    // æ‰‹åŠ¿æ—¥å¿—
    const gestureLog = []
    function logGesture(type, detail) {
      const time = new Date().toLocaleTimeString()
      gestureLog.unshift(`[${time}] ${type}: ${detail}`)
      if (gestureLog.length > 5) gestureLog.pop()

      document.getElementById('gesture-log').innerHTML =
        gestureLog.join('<br>') || 'ç­‰å¾…æ‰‹åŠ¿è¾“å…¥...'
    }

    // ç¼©æ”¾çº§åˆ«
    let currentZoom = 1
    function updateZoomLevel(zoom) {
      currentZoom = zoom
      document.getElementById('zoom-level').textContent =
        `${Math.round(zoom * 100)}%`
    }

    // ç¤ºä¾‹å†…å®¹
    window.loadSampleContent = function () {
      const content = `
<h1>ç§»åŠ¨ç«¯å¯Œæ–‡æœ¬ç¼–è¾‘å™¨</h1>
<p>è¿™æ˜¯ä¸€ä¸ªä¸“ä¸º<strong>ç§»åŠ¨è®¾å¤‡</strong>ä¼˜åŒ–çš„å¯Œæ–‡æœ¬ç¼–è¾‘å™¨ï¼Œæ”¯æŒå¤šç§<em>æ‰‹åŠ¿æ“ä½œ</em>å’Œ<u>è§¦æ‘¸äº¤äº’</u>ã€‚</p>

<h2>åŠŸèƒ½ç‰¹æ€§</h2>
<ul>
  <li>âœ¨ æµç•…çš„è§¦æ‘¸å“åº”</li>
  <li>ğŸ¨ ä¸°å¯Œçš„æ ¼å¼é€‰é¡¹</li>
  <li>ğŸ“± è‡ªé€‚åº”å¸ƒå±€</li>
  <li>ğŸš€ é«˜æ€§èƒ½æ¸²æŸ“</li>
</ul>

<blockquote>
  <p>"åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šç¼–è¾‘æ–‡æ¡£ä»æœªå¦‚æ­¤ç®€å•å’Œæ„‰æ‚¦ã€‚"</p>
</blockquote>

<h3>ä»£ç ç¤ºä¾‹</h3>
<pre><code>const editor = new Editor({
  mobile: true,
  gestures: true
})
editor.mount('#app')</code></pre>

<p>è¯•è¯•å„ç§æ‰‹åŠ¿æ“ä½œï¼š<strong>åŒæŒ‡ç¼©æ”¾</strong>æŸ¥çœ‹ç»†èŠ‚ï¼Œ<strong>é•¿æŒ‰</strong>æ˜¾ç¤ºèœå•ï¼Œ<strong>åŒå‡»</strong>å¿«é€Ÿç¼©æ”¾ï¼Œä»è¾¹ç¼˜<strong>å³æ»‘</strong>æ‰“å¼€ä¾§è¾¹æ ã€‚</p>

<p style="color: #667eea;">äº«å—ç§»åŠ¨ç¼–è¾‘çš„ä¹è¶£ï¼ ğŸ‰</p>
      `
      editor.setContent(content)
      logGesture('ç³»ç»Ÿ', 'å·²åŠ è½½ç¤ºä¾‹å†…å®¹')
    }

    window.resetZoom = function () {
      updateZoomLevel(1)
      // è§¦å‘ç¼©æ”¾é‡ç½®
      editor.emit('zoom', { scale: 1 })
      logGesture('ç³»ç»Ÿ', 'ç¼©æ”¾å·²é‡ç½®')
    }

    window.toggleToolbar = function () {
      mobileAdapter.mobileToolbar?.toggle()
      logGesture('ç³»ç»Ÿ', 'åˆ‡æ¢å·¥å…·æ æ˜¾ç¤º')
    }

    window.showMenu = function () {
      mobileAdapter.swipeMenu?.open()
      logGesture('ç³»ç»Ÿ', 'æ‰“å¼€ä¾§è¾¹èœå•')
    }

    window.insertImage = function () {
      const imageUrl = 'data:image/svg+xml,%3Csvg width="200" height="150" xmlns="http://www.w3.org/2000/svg"%3E%3Crect width="200" height="150" fill="%23667eea"/%3E%3Ctext x="50%25" y="50%25" text-anchor="middle" dy=".3em" fill="white" font-size="20"%3Eç¤ºä¾‹å›¾ç‰‡%3C/text%3E%3C/svg%3E'
      editor.insertImage(imageUrl)
      logGesture('ç³»ç»Ÿ', 'æ’å…¥äº†ä¸€å¼ å›¾ç‰‡')
    }

    let isDarkMode = false
    window.toggleDarkMode = function () {
      isDarkMode = !isDarkMode
      if (isDarkMode) {
        document.body.style.background = 'linear-gradient(135deg, #1a202c 0%, #2d3748 100%)'
        editorElement.style.background = '#2d3748'
        editorElement.style.color = '#e2e8f0'
      } else {
        document.body.style.background = 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)'
        editorElement.style.background = 'white'
        editorElement.style.color = '#333'
      }
      logGesture('ç³»ç»Ÿ', `åˆ‡æ¢åˆ°${isDarkMode ? 'æš—é»‘' : 'æ˜äº®'}æ¨¡å¼`)
    }

    // è®¾å¤‡æ‘‡åŠ¨æ£€æµ‹ï¼ˆæ’¤é”€ï¼‰
    if ('DeviceMotionEvent' in window) {
      let lastShake = 0
      window.addEventListener('devicemotion', (e) => {
        const acceleration = e.accelerationIncludingGravity
        if (!acceleration) return

        const magnitude = Math.sqrt(
          acceleration.x * acceleration.x +
          acceleration.y * acceleration.y +
          acceleration.z * acceleration.z
        )

        if (magnitude > 25 && Date.now() - lastShake > 1000) {
          lastShake = Date.now()
          editor.undo()
          logGesture('æ‘‡åŠ¨', 'æ’¤é”€æ“ä½œ')

          // è§¦è§‰åé¦ˆ
          if ('vibrate' in navigator) {
            navigator.vibrate(50)
          }
        }
      })
    }

    // åˆå§‹åŒ–
    updateDeviceInfo()
    window.addEventListener('resize', updateDeviceInfo)

    // åŠ è½½åˆå§‹å†…å®¹
    setTimeout(loadSampleContent, 500)

    console.log('âœ¨ ç§»åŠ¨ç«¯ç¼–è¾‘å™¨å·²åˆå§‹åŒ–')
    console.log('ğŸ“± è¯•è¯•å„ç§æ‰‹åŠ¿æ“ä½œå§ï¼')
  </script>
</body>

</html>





