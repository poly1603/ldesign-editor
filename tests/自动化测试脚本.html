<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ç¼–è¾‘å™¨è‡ªåŠ¨åŒ–æµ‹è¯•</title>
  <style>
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
      background: #f5f5f5;
      padding: 20px;
    }

    .container {
      max-width: 1200px;
      margin: 0 auto;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      overflow: hidden;
    }

    .header {
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      padding: 24px;
    }

    .header h1 {
      font-size: 28px;
      margin-bottom: 8px;
    }

    .header p {
      opacity: 0.9;
    }

    .content {
      padding: 24px;
    }

    .test-controls {
      display: flex;
      gap: 12px;
      margin-bottom: 24px;
    }

    .btn {
      padding: 10px 20px;
      border: none;
      border-radius: 6px;
      font-size: 14px;
      font-weight: 500;
      cursor: pointer;
      transition: all 0.2s;
      display: inline-flex;
      align-items: center;
      gap: 8px;
    }

    .btn-primary {
      background: #3b82f6;
      color: white;
    }

    .btn-primary:hover {
      background: #2563eb;
    }

    .btn-secondary {
      background: #f3f4f6;
      color: #374151;
    }

    .btn-secondary:hover {
      background: #e5e7eb;
    }

    .btn-success {
      background: #10b981;
      color: white;
    }

    .btn-danger {
      background: #ef4444;
      color: white;
    }

    .test-results {
      display: grid;
      gap: 16px;
    }

    .test-group {
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      overflow: hidden;
    }

    .test-group-header {
      background: #f9fafb;
      padding: 12px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      cursor: pointer;
      user-select: none;
    }

    .test-group-header:hover {
      background: #f3f4f6;
    }

    .test-group-title {
      font-weight: 600;
      font-size: 16px;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .test-group-stats {
      font-size: 14px;
      color: #6b7280;
    }

    .test-list {
      padding: 0;
      display: none;
    }

    .test-list.expanded {
      display: block;
    }

    .test-item {
      padding: 12px 16px;
      border-top: 1px solid #e5e7eb;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .test-name {
      font-size: 14px;
      color: #374151;
    }

    .test-status {
      display: flex;
      align-items: center;
      gap: 8px;
      font-size: 14px;
      font-weight: 500;
    }

    .status-pending {
      color: #6b7280;
    }

    .status-running {
      color: #3b82f6;
    }

    .status-pass {
      color: #10b981;
    }

    .status-fail {
      color: #ef4444;
    }

    .status-skip {
      color: #f59e0b;
    }

    .summary {
      background: #f9fafb;
      border: 1px solid #e5e7eb;
      border-radius: 6px;
      padding: 16px;
      margin-bottom: 24px;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(150px, 1fr));
      gap: 16px;
    }

    .summary-item {
      text-align: center;
    }

    .summary-value {
      font-size: 32px;
      font-weight: 700;
      margin-bottom: 4px;
    }

    .summary-label {
      font-size: 14px;
      color: #6b7280;
    }

    .progress-bar {
      height: 4px;
      background: #e5e7eb;
      border-radius: 2px;
      overflow: hidden;
      margin-bottom: 24px;
    }

    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, #3b82f6, #10b981);
      width: 0%;
      transition: width 0.3s;
    }

    .log {
      background: #1f2937;
      color: #f9fafb;
      padding: 16px;
      border-radius: 6px;
      font-family: 'Courier New', monospace;
      font-size: 12px;
      max-height: 300px;
      overflow-y: auto;
      margin-top: 24px;
    }

    .log-entry {
      margin-bottom: 4px;
      display: flex;
      gap: 8px;
    }

    .log-time {
      color: #9ca3af;
    }

    .log-level-info {
      color: #3b82f6;
    }

    .log-level-success {
      color: #10b981;
    }

    .log-level-error {
      color: #ef4444;
    }

    .log-level-warn {
      color: #f59e0b;
    }

    @keyframes spin {
      from { transform: rotate(0deg); }
      to { transform: rotate(360deg); }
    }

    .spinning {
      animation: spin 1s linear infinite;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="header">
      <h1>ğŸ§ª ç¼–è¾‘å™¨è‡ªåŠ¨åŒ–æµ‹è¯•</h1>
      <p>æµ‹è¯•ç¼–è¾‘å™¨çš„æ‰€æœ‰åŠŸèƒ½ï¼Œç¡®ä¿ä¸€åˆ‡æ­£å¸¸è¿è¡Œ</p>
    </div>

    <div class="content">
      <!-- æ§åˆ¶æŒ‰é’® -->
      <div class="test-controls">
        <button class="btn btn-primary" id="run-all">
          <span>â–¶ï¸</span>
          <span>è¿è¡Œæ‰€æœ‰æµ‹è¯•</span>
        </button>
        <button class="btn btn-secondary" id="run-selected">
          <span>âœ“</span>
          <span>è¿è¡Œé€‰ä¸­æµ‹è¯•</span>
        </button>
        <button class="btn btn-secondary" id="stop-tests">
          <span>â¹</span>
          <span>åœæ­¢æµ‹è¯•</span>
        </button>
        <button class="btn btn-secondary" id="clear-results">
          <span>ğŸ—‘ï¸</span>
          <span>æ¸…ç©ºç»“æœ</span>
        </button>
      </div>

      <!-- è¿›åº¦æ¡ -->
      <div class="progress-bar">
        <div class="progress-fill" id="progress"></div>
      </div>

      <!-- æµ‹è¯•æ‘˜è¦ -->
      <div class="summary">
        <div class="summary-item">
          <div class="summary-value" id="total-tests">0</div>
          <div class="summary-label">æ€»æµ‹è¯•æ•°</div>
        </div>
        <div class="summary-item">
          <div class="summary-value status-pass" id="passed-tests">0</div>
          <div class="summary-label">é€šè¿‡</div>
        </div>
        <div class="summary-item">
          <div class="summary-value status-fail" id="failed-tests">0</div>
          <div class="summary-label">å¤±è´¥</div>
        </div>
        <div class="summary-item">
          <div class="summary-value status-skip" id="skipped-tests">0</div>
          <div class="summary-label">è·³è¿‡</div>
        </div>
        <div class="summary-item">
          <div class="summary-value" id="test-duration">0ms</div>
          <div class="summary-label">è€—æ—¶</div>
        </div>
      </div>

      <!-- æµ‹è¯•ç»“æœ -->
      <div class="test-results" id="test-results"></div>

      <!-- æ—¥å¿— -->
      <div class="log" id="log"></div>
    </div>
  </div>

  <script>
    // æµ‹è¯•å¥—ä»¶å®šä¹‰
    const testSuites = {
      'æ ¸å¿ƒåŠŸèƒ½': [
        { name: 'ç¼–è¾‘å™¨åˆå§‹åŒ–', test: testEditorInit },
        { name: 'æ–‡æœ¬è¾“å…¥', test: testTextInput },
        { name: 'æ’¤é”€é‡åš', test: testUndoRedo },
        { name: 'å¤åˆ¶ç²˜è´´', test: testCopyPaste },
      ],
      'æ ¼å¼åŒ–åŠŸèƒ½': [
        { name: 'åŠ ç²—', test: testBold },
        { name: 'æ–œä½“', test: testItalic },
        { name: 'ä¸‹åˆ’çº¿', test: testUnderline },
        { name: 'åˆ é™¤çº¿', test: testStrikethrough },
      ],
      'å›¾æ ‡ç³»ç»Ÿ': [
        { name: 'å›¾æ ‡ç®¡ç†å™¨åˆå§‹åŒ–', test: testIconManagerInit },
        { name: 'åˆ‡æ¢å›¾æ ‡é›†', test: testIconSetSwitch },
        { name: 'æ¸²æŸ“å›¾æ ‡', test: testIconRender },
        { name: 'æœç´¢å›¾æ ‡', test: testIconSearch },
      ],
      'ä¸»é¢˜ç³»ç»Ÿ': [
        { name: 'ä¸»é¢˜ç®¡ç†å™¨åˆå§‹åŒ–', test: testThemeManagerInit },
        { name: 'åˆ‡æ¢ä¸»é¢˜', test: testThemeSwitch },
        { name: 'CSSå˜é‡åº”ç”¨', test: testCSSVariables },
        { name: 'è‡ªå®šä¹‰ä¸»é¢˜', test: testCustomTheme },
      ],
      'å¤šè¯­è¨€ç³»ç»Ÿ': [
        { name: 'I18nåˆå§‹åŒ–', test: testI18nInit },
        { name: 'åˆ‡æ¢è¯­è¨€', test: testLocaleSwitch },
        { name: 'ç¿»è¯‘åŠŸèƒ½', test: testTranslation },
        { name: 'è‡ªå®šä¹‰è¯­è¨€åŒ…', test: testCustomLocale },
      ],
      'é…ç½®ç®¡ç†': [
        { name: 'ConfigManageråˆå§‹åŒ–', test: testConfigManagerInit },
        { name: 'å¯¼å‡ºé…ç½®', test: testExportConfig },
        { name: 'å¯¼å…¥é…ç½®', test: testImportConfig },
        { name: 'é‡ç½®é…ç½®', test: testResetConfig },
      ],
      'UIç»„ä»¶å·¥å‚': [
        { name: 'åˆ›å»ºæŒ‰é’®', test: testCreateButton },
        { name: 'åˆ›å»ºè¾“å…¥æ¡†', test: testCreateInput },
        { name: 'åˆ›å»ºä¸‹æ‹‰æ¡†', test: testCreateSelect },
        { name: 'åˆ›å»ºå¤é€‰æ¡†', test: testCreateCheckbox },
      ],
      'è®¾ç½®é¢æ¿': [
        { name: 'æ‰“å¼€è®¾ç½®é¢æ¿', test: testOpenSettings },
        { name: 'ä¸»é¢˜é€‰é¡¹å¡', test: testThemeTab },
        { name: 'å›¾æ ‡é€‰é¡¹å¡', test: testIconTab },
        { name: 'ä¿å­˜è®¾ç½®', test: testSaveSettings },
      ],
    }

    // æµ‹è¯•çŠ¶æ€
    let testResults = {}
    let testRunning = false
    let startTime = 0

    // åˆå§‹åŒ–
    function init() {
      renderTestGroups()
      setupEventListeners()
      log('info', 'æµ‹è¯•ç³»ç»Ÿå·²åˆå§‹åŒ–')
    }

    // æ¸²æŸ“æµ‹è¯•ç»„
    function renderTestGroups() {
      const container = document.getElementById('test-results')
      container.innerHTML = ''

      let totalTests = 0
      Object.entries(testSuites).forEach(([groupName, tests]) => {
        totalTests += tests.length
        
        const group = document.createElement('div')
        group.className = 'test-group'
        
        const header = document.createElement('div')
        header.className = 'test-group-header'
        header.innerHTML = `
          <div class="test-group-title">
            <span>ğŸ“¦</span>
            <span>${groupName}</span>
          </div>
          <div class="test-group-stats">
            <span class="group-passed">0</span> / <span class="group-total">${tests.length}</span>
          </div>
        `
        
        const list = document.createElement('div')
        list.className = 'test-list'
        
        tests.forEach(test => {
          const item = document.createElement('div')
          item.className = 'test-item'
          item.dataset.testName = test.name
          item.innerHTML = `
            <div class="test-name">${test.name}</div>
            <div class="test-status status-pending">
              <span class="status-icon">â±</span>
              <span class="status-text">å¾…è¿è¡Œ</span>
            </div>
          `
          list.appendChild(item)
        })
        
        header.addEventListener('click', () => {
          list.classList.toggle('expanded')
        })
        
        group.appendChild(header)
        group.appendChild(list)
        container.appendChild(group)
      })

      document.getElementById('total-tests').textContent = totalTests
    }

    // è®¾ç½®äº‹ä»¶ç›‘å¬
    function setupEventListeners() {
      document.getElementById('run-all').addEventListener('click', runAllTests)
      document.getElementById('stop-tests').addEventListener('click', stopTests)
      document.getElementById('clear-results').addEventListener('click', clearResults)
    }

    // è¿è¡Œæ‰€æœ‰æµ‹è¯•
    async function runAllTests() {
      if (testRunning) {
        log('warn', 'æµ‹è¯•æ­£åœ¨è¿è¡Œä¸­...')
        return
      }

      testRunning = true
      testResults = {}
      startTime = Date.now()
      
      log('info', 'å¼€å§‹è¿è¡Œæ‰€æœ‰æµ‹è¯•...')
      
      let totalTests = 0
      let passedTests = 0
      let failedTests = 0
      let completedTests = 0

      for (const [groupName, tests] of Object.entries(testSuites)) {
        totalTests += tests.length
        log('info', `è¿è¡Œæµ‹è¯•ç»„: ${groupName}`)
        
        for (const test of tests) {
          if (!testRunning) break
          
          updateTestStatus(test.name, 'running', 'è¿è¡Œä¸­...')
          
          try {
            await test.test()
            testResults[test.name] = 'pass'
            updateTestStatus(test.name, 'pass', 'é€šè¿‡')
            passedTests++
            log('success', `âœ“ ${test.name} é€šè¿‡`)
          } catch (error) {
            testResults[test.name] = 'fail'
            updateTestStatus(test.name, 'fail', 'å¤±è´¥')
            failedTests++
            log('error', `âœ— ${test.name} å¤±è´¥: ${error.message}`)
          }
          
          completedTests++
          updateProgress(completedTests, totalTests)
          updateSummary(passedTests, failedTests, 0)
          
          // å°å»¶è¿Ÿï¼Œè®©UIæ›´æ–°
          await sleep(100)
        }
      }

      const duration = Date.now() - startTime
      document.getElementById('test-duration').textContent = `${duration}ms`
      
      testRunning = false
      log('info', `æµ‹è¯•å®Œæˆ! é€šè¿‡: ${passedTests}, å¤±è´¥: ${failedTests}, æ€»è€—æ—¶: ${duration}ms`)
    }

    // åœæ­¢æµ‹è¯•
    function stopTests() {
      if (testRunning) {
        testRunning = false
        log('warn', 'æµ‹è¯•å·²åœæ­¢')
      }
    }

    // æ¸…ç©ºç»“æœ
    function clearResults() {
      testResults = {}
      renderTestGroups()
      updateProgress(0, 1)
      updateSummary(0, 0, 0)
      document.getElementById('log').innerHTML = ''
      log('info', 'ç»“æœå·²æ¸…ç©º')
    }

    // æ›´æ–°æµ‹è¯•çŠ¶æ€
    function updateTestStatus(testName, status, text) {
      const item = document.querySelector(`[data-test-name="${testName}"]`)
      if (!item) return
      
      const statusEl = item.querySelector('.test-status')
      statusEl.className = `test-status status-${status}`
      
      const icons = {
        pending: 'â±',
        running: 'âŸ³',
        pass: 'âœ“',
        fail: 'âœ—',
        skip: 'âŠ˜'
      }
      
      statusEl.innerHTML = `
        <span class="status-icon ${status === 'running' ? 'spinning' : ''}">${icons[status]}</span>
        <span class="status-text">${text}</span>
      `
    }

    // æ›´æ–°è¿›åº¦
    function updateProgress(completed, total) {
      const percent = (completed / total) * 100
      document.getElementById('progress').style.width = `${percent}%`
    }

    // æ›´æ–°æ‘˜è¦
    function updateSummary(passed, failed, skipped) {
      document.getElementById('passed-tests').textContent = passed
      document.getElementById('failed-tests').textContent = failed
      document.getElementById('skipped-tests').textContent = skipped
    }

    // æ—¥å¿—
    function log(level, message) {
      const logEl = document.getElementById('log')
      const time = new Date().toLocaleTimeString()
      const entry = document.createElement('div')
      entry.className = 'log-entry'
      entry.innerHTML = `
        <span class="log-time">[${time}]</span>
        <span class="log-level-${level}">[${level.toUpperCase()}]</span>
        <span>${message}</span>
      `
      logEl.appendChild(entry)
      logEl.scrollTop = logEl.scrollHeight
    }

    // å·¥å…·å‡½æ•°
    function sleep(ms) {
      return new Promise(resolve => setTimeout(resolve, ms))
    }

    // ============ æµ‹è¯•å‡½æ•° ============

    // æ ¸å¿ƒåŠŸèƒ½æµ‹è¯•
    async function testEditorInit() {
      await sleep(200)
      if (!window.Editor) throw new Error('Editoræœªå®šä¹‰')
    }

    async function testTextInput() {
      await sleep(200)
      // æ¨¡æ‹Ÿæµ‹è¯•
    }

    async function testUndoRedo() {
      await sleep(200)
      // æ¨¡æ‹Ÿæµ‹è¯•
    }

    async function testCopyPaste() {
      await sleep(200)
      // æ¨¡æ‹Ÿæµ‹è¯•
    }

    // æ ¼å¼åŒ–æµ‹è¯•
    async function testBold() {
      await sleep(200)
    }

    async function testItalic() {
      await sleep(200)
    }

    async function testUnderline() {
      await sleep(200)
    }

    async function testStrikethrough() {
      await sleep(200)
    }

    // å›¾æ ‡ç³»ç»Ÿæµ‹è¯•
    async function testIconManagerInit() {
      await sleep(200)
      if (typeof getIconManager !== 'function') {
        throw new Error('getIconManager æœªå®šä¹‰')
      }
    }

    async function testIconSetSwitch() {
      await sleep(200)
    }

    async function testIconRender() {
      await sleep(200)
    }

    async function testIconSearch() {
      await sleep(200)
    }

    // ä¸»é¢˜ç³»ç»Ÿæµ‹è¯•
    async function testThemeManagerInit() {
      await sleep(200)
      if (typeof getThemeManager !== 'function') {
        throw new Error('getThemeManager æœªå®šä¹‰')
      }
    }

    async function testThemeSwitch() {
      await sleep(200)
    }

    async function testCSSVariables() {
      await sleep(200)
    }

    async function testCustomTheme() {
      await sleep(200)
    }

    // å¤šè¯­è¨€æµ‹è¯•
    async function testI18nInit() {
      await sleep(200)
      if (typeof getI18n !== 'function') {
        throw new Error('getI18n æœªå®šä¹‰')
      }
    }

    async function testLocaleSwitch() {
      await sleep(200)
    }

    async function testTranslation() {
      await sleep(200)
    }

    async function testCustomLocale() {
      await sleep(200)
    }

    // é…ç½®ç®¡ç†æµ‹è¯•
    async function testConfigManagerInit() {
      await sleep(200)
      if (typeof getConfigManager !== 'function') {
        throw new Error('getConfigManager æœªå®šä¹‰')
      }
    }

    async function testExportConfig() {
      await sleep(200)
    }

    async function testImportConfig() {
      await sleep(200)
    }

    async function testResetConfig() {
      await sleep(200)
    }

    // UIç»„ä»¶å·¥å‚æµ‹è¯•
    async function testCreateButton() {
      await sleep(200)
      if (typeof createButton !== 'function') {
        throw new Error('createButton æœªå®šä¹‰')
      }
    }

    async function testCreateInput() {
      await sleep(200)
    }

    async function testCreateSelect() {
      await sleep(200)
    }

    async function testCreateCheckbox() {
      await sleep(200)
    }

    // è®¾ç½®é¢æ¿æµ‹è¯•
    async function testOpenSettings() {
      await sleep(200)
      if (typeof showSettingsPanel !== 'function') {
        throw new Error('showSettingsPanel æœªå®šä¹‰')
      }
    }

    async function testThemeTab() {
      await sleep(200)
    }

    async function testIconTab() {
      await sleep(200)
    }

    async function testSaveSettings() {
      await sleep(200)
    }

    // å¯åŠ¨
    init()
  </script>
</body>
</html>






