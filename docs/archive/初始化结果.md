# ğŸ¯ é¡¹ç›®åˆå§‹åŒ–ç»“æœ

**æ—¥æœŸ**: 2025-10-30  
**ç¯å¢ƒ**: Windows + PowerShell + Node.js v20.19.5 + pnpm 9.15.9

---

## âœ… å·²å®Œæˆ

### 1. ç¯å¢ƒéªŒè¯
- âœ“ Node.js v20.19.5 (è¦æ±‚ >= 18.0.0)
- âœ“ pnpm 9.15.9 (è¦æ±‚ >= 8.0.0)
- âœ“ é¡¹ç›®ç»“æ„å®Œæ•´ï¼ˆ8ä¸ªåŒ…ï¼‰
- âœ“ æ ¸å¿ƒæ–‡ä»¶å­˜åœ¨
- âœ“ æ–‡æ¡£é½å…¨ï¼ˆ10+ ä»½ï¼‰

### 2. ä¾èµ–å®‰è£…
```bash
pnpm install
```
- âœ“ æˆåŠŸå®‰è£… 5206 ä¸ªä¾èµ–
- âœ“ Husky Git hooks å·²å®‰è£…
- âš ï¸ éƒ¨åˆ† peer dependency è­¦å‘Šï¼ˆæ­£å¸¸ï¼Œå¯å¿½ç•¥ï¼‰

### 3. ä»£ç ä¿®å¤
- âœ“ ä¿®å¤ FindReplaceDialog.ts é‡å¤å£°æ˜é”™è¯¯
  - å°†é‡å¤çš„ `closeBtn` æ”¹ä¸º `cancelBtn`
- âœ“ åˆ›å»º PostCSS é…ç½®æ–‡ä»¶

---

## âŒ å½“å‰é—®é¢˜

### æ„å»ºå¤±è´¥

**é—®é¢˜**: æ ¸å¿ƒåŒ…æ„å»ºå¤±è´¥
```
pnpm build
```

**é”™è¯¯**:
```
BuilderError: Rollup æ„å»ºå¤±è´¥
Cannot read properties of undefined (reading 'alwaysProcess')
rollup-plugin-postcss@4.0.2
```

**åŸå› **: @ldesign/builder ä¸­çš„ PostCSS æ’ä»¶é…ç½®é—®é¢˜

### TypeScript ç±»å‹é”™è¯¯

**é—®é¢˜**: 623 ä¸ª TypeScript é”™è¯¯
```
pnpm type-check
```

**ä¸»è¦é”™è¯¯ç±»å‹**:
1. AI Provider æ¥å£ä¸åŒ¹é… (AIService.ts)
2. ç¼ºå°‘ CodeMirror ç›¸å…³æ¨¡å—
3. EventEmitter ç±»å‹ä¸åŒ¹é…
4. Schema toDOM ç­¾åé—®é¢˜
5. CLI å‘½ä»¤åŠ¨æ€å¯¼å…¥å¤±è´¥
6. å·¥å…·å‡½æ•°é‡å¤å¯¼å‡º

---

## ğŸ”§ ä¿®å¤å»ºè®®

### ä¼˜å…ˆçº§ 1: ä¿®å¤æ„å»ºç³»ç»Ÿ â­â­â­

#### æ–¹æ¡ˆ A: ä¿®å¤ @ldesign/builderï¼ˆæ¨èï¼‰
1. æ£€æŸ¥ `tools/builder` åŒ…çš„ PostCSS é…ç½®
2. æ›´æ–° `rollup-plugin-postcss` é…ç½®
3. ç¡®ä¿ PostCSS æ’ä»¶æ­£ç¡®åˆå§‹åŒ–

```bash
cd D:\WorkBench\ldesign\tools\builder
# æ£€æŸ¥ src/plugins/*.ts ä¸­çš„ postcss é…ç½®
```

#### æ–¹æ¡ˆ B: ä¸´æ—¶è§£å†³æ–¹æ¡ˆ
1. æ³¨é‡Šæ‰ CSS å¯¼å…¥
2. ä½¿ç”¨çº¯ TypeScript æ„å»º
3. å•ç‹¬å¤„ç†æ ·å¼æ–‡ä»¶

```typescript
// ä¸´æ—¶æ³¨é‡Š src/index.ts ä¸­çš„ CSS å¯¼å…¥
// import './styles/editor.css'
// import './styles/themes/default.css'
```

### ä¼˜å…ˆçº§ 2: ä¿®å¤ç±»å‹é”™è¯¯ â­â­

#### AI Provider æ¥å£
æ–‡ä»¶: `src/ai/providers/*.ts`
```typescript
// ç»Ÿä¸€ AIProviderInterface å’Œå®ç°ç±»çš„æ¥å£å®šä¹‰
// ç¡®ä¿ AIRequestã€AIResponse ç±»å‹åŒ¹é…
```

#### CodeMirror ä¾èµ–
```bash
# å®‰è£…ç¼ºå¤±çš„ CodeMirror åŒ…
pnpm add codemirror @codemirror/state @codemirror/view
```

#### EventEmitter ç±»å‹
æ–‡ä»¶: `src/collaboration/CollaborationManager.ts`
```typescript
// ä¿®å¤ EventEmitter æ³›å‹å‚æ•°
// CollaborationEvents åº”ä¸º Record<string, any[]>
```

### ä¼˜å…ˆçº§ 3: æ¸…ç†é‡å¤å¯¼å‡º â­

æ–‡ä»¶: `src/utils/index.ts`
```typescript
// æ£€æŸ¥å¹¶ç§»é™¤é‡å¤çš„ export
// ç¡®ä¿æ¯ä¸ªå·¥å…·å‡½æ•°åªå¯¼å‡ºä¸€æ¬¡
```

---

## ğŸ“ æ¨èæ‰§è¡Œé¡ºåº

### ç¬¬ä¸€é˜¶æ®µï¼šä¿®å¤æ„å»º (1-2å¤©)
```bash
# 1. ä¿®å¤ builder PostCSS é…ç½®
cd D:\WorkBench\ldesign\tools\builder
# æ‰¾åˆ°å¹¶ä¿®å¤ postcss æ’ä»¶åˆå§‹åŒ–é—®é¢˜

# 2. æµ‹è¯•æ„å»º
cd D:\WorkBench\ldesign\libraries\editor\packages\core
pnpm build

# 3. å¦‚æœæˆåŠŸï¼Œç»§ç»­ä¸‹ä¸€é˜¶æ®µ
```

### ç¬¬äºŒé˜¶æ®µï¼šä¿®å¤æ ¸å¿ƒç±»å‹ (2-3å¤©)
```bash
# 1. ä¿®å¤ AI Provider æ¥å£
# 2. ä¿®å¤ EventEmitter ç±»å‹
# 3. ä¿®å¤ Schema å®šä¹‰
# 4. è¿è¡Œç±»å‹æ£€æŸ¥
pnpm type-check
```

### ç¬¬ä¸‰é˜¶æ®µï¼šå®Œå–„åŠŸèƒ½ (1å‘¨)
```bash
# 1. å®‰è£…ç¼ºå¤±ä¾èµ–
# 2. ä¿®å¤ CLI å‘½ä»¤
# 3. æ¸…ç†é‡å¤å¯¼å‡º
# 4. è¿è¡Œæµ‹è¯•
pnpm test
```

---

## ğŸš€ ä¸´æ—¶è§£å†³æ–¹æ¡ˆï¼ˆå¿«é€ŸéªŒè¯ï¼‰

å¦‚æœä½ æƒ³å¿«é€ŸéªŒè¯é¡¹ç›®å…¶ä»–éƒ¨åˆ†ï¼š

### 1. è·³è¿‡æ ¸å¿ƒåŒ…æ„å»º
```bash
# ç›´æ¥å¼€å‘ Demo åº”ç”¨ï¼ˆä½¿ç”¨æºç ï¼‰
cd demos/react-demo
pnpm dev
```

### 2. ä½¿ç”¨é¢„æ„å»ºç‰ˆæœ¬
```bash
# å¦‚æœæœ‰æ—§çš„ dist ç›®å½•ï¼Œæš‚æ—¶ä½¿ç”¨å®ƒ
# æ³¨æ„ï¼šè¿™ä¸ä¼šåŒ…å«æœ€æ–°ä¿®æ”¹
```

### 3. åˆ†æ¨¡å—æµ‹è¯•
```bash
# æµ‹è¯•ç‹¬ç«‹æ¨¡å—
cd packages/vue
pnpm type-check

cd packages/react
pnpm type-check
```

---

## ğŸ“š å‚è€ƒæ–‡æ¡£

- [å¿«é€Ÿå¯åŠ¨æŒ‡å—.md](./å¿«é€Ÿå¯åŠ¨æŒ‡å—.md) - é¡¹ç›®ä½¿ç”¨è¯´æ˜
- [æœ€ç»ˆå®ŒæˆæŠ¥å‘Š.md](./æœ€ç»ˆå®ŒæˆæŠ¥å‘Š.md) - å½“å‰è¿›åº¦
- [ä¸‹ä¸€æ­¥è®¡åˆ’.md](./ä¸‹ä¸€æ­¥è®¡åˆ’.md) - ä»»åŠ¡æ¸…å•
- [ARCHITECTURE.md](./ARCHITECTURE.md) - æ¶æ„è®¾è®¡

---

## ğŸ’¡ éœ€è¦å¸®åŠ©ï¼Ÿ

1. **æŸ¥çœ‹æ„å»ºæ—¥å¿—**
   ```bash
   pnpm build 2>&1 | Out-File build-log.txt
   ```

2. **æ£€æŸ¥ builder æºç **
   ```bash
   cd D:\WorkBench\ldesign\tools\builder
   Get-ChildItem -Recurse -Filter "*postcss*"
   ```

3. **æŸ¥çœ‹ç±»å‹é”™è¯¯è¯¦æƒ…**
   ```bash
   pnpm type-check > type-errors.txt
   ```

---

## ğŸ‰ ä¸‹ä¸€æ­¥

**æ¨è**ï¼š
1. ä¿®å¤ `@ldesign/builder` çš„ PostCSS é…ç½®
2. æˆ–è€…æš‚æ—¶ä½¿ç”¨ä¸´æ—¶æ–¹æ¡ˆï¼ˆæ³¨é‡Š CSS å¯¼å…¥ï¼‰
3. ç„¶åé€æ­¥ä¿®å¤ TypeScript ç±»å‹é”™è¯¯

**éœ€è¦æˆ‘å¸®å¿™å—ï¼Ÿ**
- ğŸ”§ ä¿®å¤ builder PostCSS é…ç½®
- ğŸ“ ä¿®å¤ç‰¹å®šç±»å‹é”™è¯¯
- ğŸš€ è®¾ç½®ä¸´æ—¶å¼€å‘ç¯å¢ƒ
- ğŸ“Š åˆ†æé”™è¯¯ä¼˜å…ˆçº§

---

**ç¥å¼€å‘é¡ºåˆ©ï¼** ğŸ¯
