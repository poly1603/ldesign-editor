{"version":3,"file":"LdEditor.js","sources":["../../src/components/LdEditor.tsx"],"sourcesContent":["/**\r\n * LdEditor - Vue 3 编辑器组件\r\n */\r\n\r\nimport { defineComponent, onMounted, onUnmounted, ref, watch, type PropType } from 'vue'\r\nimport type { EditorOptions } from '@ldesign/editor-core'\r\nimport { Editor, standardPlugins } from '@ldesign/editor-core'\r\n\r\nexport interface EditorProps extends Omit<EditorOptions, 'onChange' | 'onUpdate'> {\r\n  /** v-model绑定的内容 */\r\n  modelValue?: string\r\n}\r\n\r\nexport interface EditorEmits {\r\n  /** 内容更新事件 */\r\n  'update:modelValue': [value: string]\r\n  /** 变化事件 */\r\n  'change': [content: string]\r\n  /** 聚焦事件 */\r\n  'focus': []\r\n  /** 失焦事件 */\r\n  'blur': []\r\n}\r\n\r\nexport interface EditorInstance {\r\n  /** 编辑器实例 */\r\n  editor: Editor | null\r\n  /** 获取HTML内容 */\r\n  getHTML: () => string\r\n  /** 设置HTML内容 */\r\n  setHTML: (content: string) => void\r\n  /** 聚焦 */\r\n  focus: () => void\r\n}\r\n\r\n/**\r\n * LDesign 编辑器 Vue 组件\r\n * \r\n * @example\r\n * ```vue\r\n * <template>\r\n *   <LdEditor v-model=\"content\" placeholder=\"开始输入...\" />\r\n * </template>\r\n * \r\n * <script setup lang=\"ts\">\r\n * import { ref } from 'vue'\r\n * import { LdEditor } from '@ldesign/editor-vue'\r\n * \r\n * const content = ref('<p>Hello World</p>')\r\n * </script>\r\n * ```\r\n */\r\nexport const LdEditor = defineComponent({\r\n  name: 'LdEditor',\r\n\r\n  props: {\r\n    /**\r\n     * 编辑器内容（v-model）\r\n     */\r\n    modelValue: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n\r\n    /**\r\n     * 占位符文本\r\n     */\r\n    placeholder: {\r\n      type: String,\r\n      default: ''\r\n    },\r\n\r\n    /**\r\n     * 是否只读\r\n     */\r\n    readonly: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n\r\n    /**\r\n     * 是否自动聚焦\r\n     */\r\n    autofocus: {\r\n      type: Boolean,\r\n      default: false\r\n    },\r\n\r\n    /**\r\n     * 虚拟滚动配置\r\n     */\r\n    virtualScroll: {\r\n      type: Object as PropType<EditorOptions['virtualScroll']>,\r\n      default: undefined\r\n    },\r\n\r\n    /**\r\n     * WASM加速配置\r\n     */\r\n    wasm: {\r\n      type: Object as PropType<EditorOptions['wasm']>,\r\n      default: undefined\r\n    },\r\n\r\n    /**\r\n     * PWA配置\r\n     */\r\n    pwa: {\r\n      type: Object as PropType<EditorOptions['pwa']>,\r\n      default: undefined\r\n    },\r\n\r\n    /**\r\n     * 调试面板配置\r\n     */\r\n    debugPanel: {\r\n      type: Object as PropType<EditorOptions['debugPanel']>,\r\n      default: undefined\r\n    },\r\n\r\n    /**\r\n     * 插件列表\r\n     * @default standardPlugins\r\n     */\r\n    plugins: {\r\n      type: Array as PropType<EditorOptions['plugins']>,\r\n      default: () => standardPlugins\r\n    }\r\n  },\r\n\r\n  emits: {\r\n    /**\r\n     * v-model更新事件\r\n     */\r\n    'update:modelValue': (value: string) => true,\r\n\r\n    /**\r\n     * 内容变化事件\r\n     */\r\n    'change': (content: string) => true,\r\n\r\n    /**\r\n     * 聚焦事件\r\n     */\r\n    'focus': () => true,\r\n\r\n    /**\r\n     * 失焦事件\r\n     */\r\n    'blur': () => true\r\n  },\r\n\r\n  setup(props, { emit, expose }) {\r\n    const containerRef = ref<HTMLDivElement>()\r\n    let editor: Editor | null = null\r\n\r\n    onMounted(() => {\r\n      if (!containerRef.value) return\r\n\r\n      // 创建编辑器实例\r\n      editor = new Editor({\r\n        content: props.modelValue,\r\n        placeholder: props.placeholder,\r\n        autofocus: props.autofocus,\r\n        virtualScroll: props.virtualScroll,\r\n        wasm: props.wasm,\r\n        pwa: props.pwa,\r\n        debugPanel: props.debugPanel,\r\n        plugins: props.plugins,\r\n\r\n        // 事件处理\r\n        onChange: (content: string) => {\r\n          emit('update:modelValue', content)\r\n          emit('change', content)\r\n        },\r\n\r\n        onFocus: () => {\r\n          emit('focus')\r\n        },\r\n\r\n        onBlur: () => {\r\n          emit('blur')\r\n        }\r\n      })\r\n\r\n      // 挂载编辑器\r\n      editor.mount(containerRef.value)\r\n    })\r\n\r\n    // 监听 modelValue 变化\r\n    watch(() => props.modelValue, (newValue) => {\r\n      if (editor && newValue !== editor.getHTML?.()) {\r\n        editor.setHTML?.(newValue)\r\n      }\r\n    })\r\n\r\n    // 监听只读状态\r\n    watch(() => props.readonly, (readonly) => {\r\n      if (editor) {\r\n        editor.setEditable?.(!readonly)\r\n      }\r\n    })\r\n\r\n    onUnmounted(() => {\r\n      editor?.destroy?.()\r\n      editor = null\r\n    })\r\n\r\n    // 暴露方法给父组件\r\n    const instance: EditorInstance = {\r\n      editor,\r\n      getHTML: () => editor?.getHTML?.() || '',\r\n      setHTML: (content: string) => editor?.setHTML?.(content),\r\n      focus: () => editor?.focus?.()\r\n    }\r\n\r\n    expose(instance)\r\n\r\n    return () => (\r\n      <div\r\n        ref={containerRef}\r\n        class=\"ld-editor-vue-wrapper\"\r\n        style={{\r\n          width: '100%',\r\n          height: '100%'\r\n        }}\r\n      />\r\n    )\r\n  }\r\n})\r\n\r\nexport default LdEditor\r\n\r\n\r\n"],"names":["LdEditor","defineComponent","name","props","modelValue","type","String","default","placeholder","readonly","Boolean","autofocus","virtualScroll","Object","undefined","wasm","pwa","debugPanel","plugins","Array","standardPlugins","emits","value","content","focus","blur","setup","emit","expose","containerRef","ref","editor","onMounted","Editor","onChange","onFocus","onBlur","mount","watch","newValue","getHTML","setHTML","setEditable","onUnmounted","destroy","_createVNode","width","height"],"mappings":";;;;;;;;iHAoDO,MAAMA,EAAWC,EAAAA,gBAAgB,CACtCC,KAAM,WAENC,MAAO,CAILC,WAAY,CACVC,KAAMC,OACNC,QAAS,EACX,EAKAC,YAAa,CACXH,KAAMC,OACNC,QAAS,EACX,EAKAE,SAAU,CACRJ,KAAMK,QACNH,QAAS,EACX,EAKAI,UAAW,CACTN,KAAMK,QACNH,QAAS,EACX,EAKAK,cAAe,CACbP,KAAMQ,OACNN,QAASO,MACX,EAKAC,KAAM,CACJV,KAAMQ,OACNN,QAASO,MACX,EAKAE,IAAK,CACHX,KAAMQ,OACNN,QAASO,MACX,EAKAG,WAAY,CACVZ,KAAMQ,OACNN,QAASO,MACX,EAMAI,QAAS,CACPb,KAAMc,MACNZ,QAASA,IAAMa,iBACjB,CACF,EAEAC,MAAO,CAIL,oBAAsBC,GAAkB,GAKxC,OAAWC,GAAoB,GAK/B,MAASC,IAAM,GAKf,KAAQC,IAAM,EAChB,EAEAC,MAAMvB,EAAO,CAAEwB,KAAAA,EAAMC,OAAAA,CAAO,EAAG,CAC7B,MAAMC,EAAeC,EAAAA,MACrB,IAAIC,EAAwB,KAE5BC,OAAAA,EAAAA,UAAU,IAAM,CACTH,EAAaP,QAGlBS,EAAS,IAAIE,SAAO,CAClBV,QAASpB,EAAMC,WACfI,YAAaL,EAAMK,YACnBG,UAAWR,EAAMQ,UACjBC,cAAeT,EAAMS,cACrBG,KAAMZ,EAAMY,KACZC,IAAKb,EAAMa,IACXC,WAAYd,EAAMc,WAClBC,QAASf,EAAMe,QAGfgB,SAAWX,GAAoB,CAC7BI,EAAK,oBAAqBJ,CAAO,EACjCI,EAAK,SAAUJ,CAAO,CACxB,EAEAY,QAASA,IAAM,CACbR,EAAK,OAAO,CACd,EAEAS,OAAQA,IAAM,CACZT,EAAK,MAAM,CACb,CACF,CAAC,EAGDI,EAAOM,MAAMR,EAAaP,KAAK,EACjC,CAAC,EAGDgB,EAAAA,MAAM,IAAMnC,EAAMC,WAAamC,GAAa,CACtCR,GAAUQ,IAAaR,EAAOS,UAAAA,GAChCT,EAAOU,UAAUF,CAAQ,CAE7B,CAAC,EAGDD,EAAAA,MAAM,IAAMnC,EAAMM,SAAWA,GAAa,CACpCsB,GACFA,EAAOW,cAAc,CAACjC,CAAQ,CAElC,CAAC,EAEDkC,EAAAA,YAAY,IAAM,CAChBZ,GAAQa,UAAAA,EACRb,EAAS,IACX,CAAC,EAUDH,EAPiC,CAC/BG,OAAAA,EACAS,QAASA,IAAMT,GAAQS,UAAAA,GAAe,GACtCC,QAAUlB,GAAoBQ,GAAQU,UAAUlB,CAAO,EACvDC,MAAOA,IAAMO,GAAQP,QAAAA,CACvB,CAEe,EAER,IAAAqB,EAAAA,YAAA,MAAA,CAAA,IAEEhB,EAAY,MAAA,wBAAA,MAEV,CACLiB,MAAO,OACPC,OAAQ,MACV,CAAC,EAAA,KAAA,GAAA,CAGP,CACF,CAAC"}