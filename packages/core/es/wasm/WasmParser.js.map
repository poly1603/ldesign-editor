{"version":3,"file":"WasmParser.js","sources":["../../src/wasm/WasmParser.ts"],"sourcesContent":["/**\r\n * WebAssembly文档解析器包装器\r\n * 提供高性能的文档解析功能\r\n */\r\n\r\nimport { createLogger } from '../utils/logger'\r\nimport { getPerformanceMonitor } from '../utils/PerformanceMonitor'\r\n\r\nconst logger = createLogger('WasmParser')\r\nconst performanceMonitor = getPerformanceMonitor()\r\n\r\nexport interface ParsedNode {\r\n  type: NodeType\r\n  start: number\r\n  end: number\r\n  content?: string\r\n  children?: ParsedNode[]\r\n  attributes?: Record<string, any>\r\n}\r\n\r\nexport enum NodeType {\r\n  TEXT = 0,\r\n  PARAGRAPH = 1,\r\n  HEADING = 2,\r\n  LIST = 3,\r\n  LIST_ITEM = 4,\r\n  BLOCKQUOTE = 5,\r\n  CODE_BLOCK = 6,\r\n  HORIZONTAL_RULE = 7,\r\n  IMAGE = 8,\r\n  LINK = 9,\r\n  BOLD = 10,\r\n  ITALIC = 11,\r\n  CODE = 12,\r\n  TABLE = 13,\r\n  TABLE_ROW = 14,\r\n  TABLE_CELL = 15,\r\n}\r\n\r\nexport interface ParseResult {\r\n  nodes: ParsedNode[]\r\n  parseTime: number\r\n  nodeCount: number\r\n  memoryUsed: number\r\n}\r\n\r\nexport interface WasmParserOptions {\r\n  /** 最大文档大小（字符数） */\r\n  maxDocumentSize?: number\r\n  /** 是否启用缓存 */\r\n  enableCache?: boolean\r\n  /** 缓存大小 */\r\n  cacheSize?: number\r\n  /** 是否解析内联样式 */\r\n  parseInlineStyles?: boolean\r\n  /** 是否验证结构 */\r\n  validateStructure?: boolean\r\n}\r\n\r\nexport class WasmParser {\r\n  private wasmInstance?: WebAssembly.Instance\r\n  private wasmMemory?: WebAssembly.Memory\r\n  private initialized = false\r\n  private initPromise?: Promise<void>\r\n  private options: Required<WasmParserOptions>\r\n  private cache = new Map<string, ParseResult>()\r\n\r\n  /** 导出的WASM函数 */\r\n  private exports?: {\r\n    memory: WebAssembly.Memory\r\n    parseDocument: (textPtr: number, textLen: number, outputPtr: number) => number\r\n    nodeToHTML: (nodePtr: number, outputPtr: number) => number\r\n    getMemorySize: () => number\r\n    getHeapUsage: () => number\r\n  }\r\n\r\n  constructor(options: WasmParserOptions = {}) {\r\n    this.options = {\r\n      maxDocumentSize: 10000000, // 1000万字符\r\n      enableCache: true,\r\n      cacheSize: 50,\r\n      parseInlineStyles: true,\r\n      validateStructure: true,\r\n      ...options,\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 初始化WASM模块\r\n   */\r\n  async initialize(): Promise<void> {\r\n    if (this.initialized)\r\n      return\r\n    if (this.initPromise)\r\n      return this.initPromise\r\n\r\n    this.initPromise = this.doInitialize()\r\n    await this.initPromise\r\n  }\r\n\r\n  private async doInitialize(): Promise<void> {\r\n    try {\r\n      logger.info('Initializing WebAssembly parser module')\r\n      const startTime = performance.now()\r\n\r\n      // 加载WASM字节码\r\n      const wasmBytes = await this.loadWasmBytes()\r\n\r\n      // 创建内存\r\n      this.wasmMemory = new WebAssembly.Memory({\r\n        initial: 2, // 128KB\r\n        maximum: 200, // 12.8MB\r\n      })\r\n\r\n      // 实例化WASM模块\r\n      const importObject = {\r\n        env: {\r\n          memory: this.wasmMemory,\r\n          log: (ptr: number, len: number) => {\r\n            const msg = this.readString(ptr, len)\r\n            logger.debug('WASM:', msg)\r\n          },\r\n          error: (ptr: number, len: number) => {\r\n            const msg = this.readString(ptr, len)\r\n            logger.error('WASM:', msg)\r\n          },\r\n        },\r\n      }\r\n\r\n      const { instance } = await WebAssembly.instantiate(wasmBytes, importObject)\r\n      this.wasmInstance = instance\r\n      this.exports = instance.exports as any\r\n\r\n      this.initialized = true\r\n      const initTime = performance.now() - startTime\r\n      logger.info(`WebAssembly parser module initialized in ${initTime.toFixed(2)}ms`)\r\n    }\r\n    catch (error) {\r\n      logger.error('Failed to initialize WebAssembly:', error)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 加载WASM字节码\r\n   */\r\n  private async loadWasmBytes(): Promise<ArrayBuffer> {\r\n    // 开发环境：从文件加载\r\n    if (process.env.NODE_ENV === 'development') {\r\n      const response = await fetch('/src/wasm/parser.wasm')\r\n      return response.arrayBuffer()\r\n    }\r\n\r\n    // 生产环境：使用内联的Base64\r\n    const base64 = await import('./parser.wasm.base64')\r\n    return Uint8Array.from(atob(base64.default), c => c.charCodeAt(0)).buffer\r\n  }\r\n\r\n  /**\r\n   * 解析文档\r\n   */\r\n  async parse(text: string): Promise<ParseResult> {\r\n    await this.initialize()\r\n\r\n    const mark = performanceMonitor.mark('wasm-parse-start')\r\n    const startTime = performance.now()\r\n\r\n    // 检查缓存\r\n    const cacheKey = this.getCacheKey(text)\r\n    if (this.options.enableCache && this.cache.has(cacheKey)) {\r\n      logger.debug('Parse result from cache')\r\n      return this.cache.get(cacheKey)!\r\n    }\r\n\r\n    try {\r\n      // 检查文档大小限制\r\n      if (text.length > this.options.maxDocumentSize)\r\n        throw new Error(`Document size exceeds limit of ${this.options.maxDocumentSize} characters`)\r\n\r\n      // 写入文本到WASM内存\r\n      const textPtr = this.writeString(text, 0)\r\n      const outputPtr = textPtr + text.length + 1024 // 留出缓冲区\r\n\r\n      // 调用WASM解析函数\r\n      const nodeCount = this.exports!.parseDocument(textPtr, text.length, outputPtr)\r\n\r\n      // 读取解析结果\r\n      const nodes = this.readNodes(outputPtr, nodeCount, text)\r\n\r\n      // 后处理\r\n      if (this.options.parseInlineStyles)\r\n        this.parseInlineStyles(nodes, text)\r\n\r\n      if (this.options.validateStructure)\r\n        this.validateNodeStructure(nodes)\r\n\r\n      const result: ParseResult = {\r\n        nodes,\r\n        parseTime: performance.now() - startTime,\r\n        nodeCount,\r\n        memoryUsed: this.exports!.getHeapUsage(),\r\n      }\r\n\r\n      // 缓存结果\r\n      if (this.options.enableCache)\r\n        this.addToCache(cacheKey, result)\r\n\r\n      performanceMonitor.measure('wasm-parse', mark)\r\n      logger.info(`Document parsed: ${nodeCount} nodes in ${result.parseTime.toFixed(2)}ms`)\r\n\r\n      return result\r\n    }\r\n    catch (error) {\r\n      logger.error('Parse failed:', error)\r\n      throw error\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 将节点转换为HTML\r\n   */\r\n  async toHTML(nodes: ParsedNode[]): Promise<string> {\r\n    await this.initialize()\r\n\r\n    const htmlParts: string[] = []\r\n\r\n    for (const node of nodes)\r\n      htmlParts.push(this.nodeToHTMLString(node))\r\n\r\n    return htmlParts.join('')\r\n  }\r\n\r\n  /**\r\n   * 节点转HTML字符串\r\n   */\r\n  private nodeToHTMLString(node: ParsedNode): string {\r\n    const tag = this.getHTMLTag(node.type)\r\n    const content = node.content || ''\r\n    const childrenHTML = node.children?.map(child => this.nodeToHTMLString(child)).join('') || ''\r\n\r\n    if (!tag)\r\n      return content + childrenHTML\r\n\r\n    const attrs = this.buildHTMLAttributes(node.attributes)\r\n    return `<${tag}${attrs}>${content}${childrenHTML}</${tag}>`\r\n  }\r\n\r\n  /**\r\n   * 获取HTML标签\r\n   */\r\n  private getHTMLTag(type: NodeType): string | null {\r\n    const tagMap: Record<NodeType, string | null> = {\r\n      [NodeType.TEXT]: null,\r\n      [NodeType.PARAGRAPH]: 'p',\r\n      [NodeType.HEADING]: 'h1', // 应该根据level动态\r\n      [NodeType.LIST]: 'ul',\r\n      [NodeType.LIST_ITEM]: 'li',\r\n      [NodeType.BLOCKQUOTE]: 'blockquote',\r\n      [NodeType.CODE_BLOCK]: 'pre',\r\n      [NodeType.HORIZONTAL_RULE]: 'hr',\r\n      [NodeType.IMAGE]: 'img',\r\n      [NodeType.LINK]: 'a',\r\n      [NodeType.BOLD]: 'strong',\r\n      [NodeType.ITALIC]: 'em',\r\n      [NodeType.CODE]: 'code',\r\n      [NodeType.TABLE]: 'table',\r\n      [NodeType.TABLE_ROW]: 'tr',\r\n      [NodeType.TABLE_CELL]: 'td',\r\n    }\r\n\r\n    return tagMap[type] || null\r\n  }\r\n\r\n  /**\r\n   * 构建HTML属性\r\n   */\r\n  private buildHTMLAttributes(attrs?: Record<string, any>): string {\r\n    if (!attrs)\r\n      return ''\r\n\r\n    const parts: string[] = []\r\n    for (const [key, value] of Object.entries(attrs))\r\n      parts.push(` ${key}=\"${this.escapeHTML(String(value))}\"`)\r\n\r\n    return parts.join('')\r\n  }\r\n\r\n  /**\r\n   * 转义HTML特殊字符\r\n   */\r\n  private escapeHTML(text: string): string {\r\n    return text\r\n      .replace(/&/g, '&amp;')\r\n      .replace(/</g, '&lt;')\r\n      .replace(/>/g, '&gt;')\r\n      .replace(/\"/g, '&quot;')\r\n      .replace(/'/g, '&#39;')\r\n  }\r\n\r\n  /**\r\n   * 写入字符串到WASM内存\r\n   */\r\n  private writeString(str: string, offset: number): number {\r\n    const encoder = new TextEncoder()\r\n    const bytes = encoder.encode(str)\r\n    const mem = new Uint8Array(this.wasmMemory!.buffer, offset)\r\n\r\n    for (let i = 0; i < bytes.length; i++)\r\n      mem[i] = bytes[i]\r\n\r\n    return offset\r\n  }\r\n\r\n  /**\r\n   * 从WASM内存读取字符串\r\n   */\r\n  private readString(ptr: number, length: number): string {\r\n    const mem = new Uint8Array(this.wasmMemory!.buffer, ptr)\r\n    const bytes = new Uint8Array(length)\r\n\r\n    for (let i = 0; i < length; i++)\r\n      bytes[i] = mem[i]\r\n\r\n    const decoder = new TextDecoder()\r\n    return decoder.decode(bytes)\r\n  }\r\n\r\n  /**\r\n   * 读取节点数组\r\n   */\r\n  private readNodes(ptr: number, count: number, originalText: string): ParsedNode[] {\r\n    const nodes: ParsedNode[] = []\r\n    const view = new DataView(this.wasmMemory!.buffer)\r\n\r\n    for (let i = 0; i < count; i++) {\r\n      const nodePtr = view.getUint32(ptr + i * 4, true)\r\n      const node = this.readNode(nodePtr, originalText)\r\n      if (node)\r\n        nodes.push(node)\r\n    }\r\n\r\n    return nodes\r\n  }\r\n\r\n  /**\r\n   * 读取单个节点\r\n   */\r\n  private readNode(ptr: number, originalText: string): ParsedNode | null {\r\n    const view = new DataView(this.wasmMemory!.buffer)\r\n\r\n    try {\r\n      const type = view.getUint32(ptr, true) as NodeType\r\n      const start = view.getUint32(ptr + 4, true)\r\n      const end = view.getUint32(ptr + 8, true)\r\n      const childrenPtr = view.getUint32(ptr + 12, true)\r\n\r\n      const node: ParsedNode = {\r\n        type,\r\n        start,\r\n        end,\r\n        content: originalText.slice(start, end),\r\n      }\r\n\r\n      // 读取子节点（如果有）\r\n      if (childrenPtr !== 0) {\r\n        // 实现子节点读取逻辑\r\n        node.children = []\r\n      }\r\n\r\n      return node\r\n    }\r\n    catch (error) {\r\n      logger.error('Failed to read node:', error)\r\n      return null\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 解析内联样式\r\n   */\r\n  private parseInlineStyles(nodes: ParsedNode[], text: string): void {\r\n    for (const node of nodes) {\r\n      if (node.type === NodeType.TEXT || node.type === NodeType.PARAGRAPH) {\r\n        // 解析加粗 **text** 或 __text__\r\n        const boldRegex = /(\\*\\*|__)(.*?)\\1/g\r\n        let match\r\n        while ((match = boldRegex.exec(node.content || '')) !== null) {\r\n          // 创建加粗节点\r\n          const boldNode: ParsedNode = {\r\n            type: NodeType.BOLD,\r\n            start: node.start + match.index,\r\n            end: node.start + match.index + match[0].length,\r\n            content: match[2],\r\n          }\r\n\r\n          if (!node.children)\r\n            node.children = []\r\n          node.children.push(boldNode)\r\n        }\r\n\r\n        // 解析斜体 *text* 或 _text_\r\n        const italicRegex = /(\\*|_)(.*?)\\1/g\r\n        while ((match = italicRegex.exec(node.content || '')) !== null) {\r\n          // 确保不是加粗标记\r\n          if (match[0].length === match[2].length + 2) {\r\n            const italicNode: ParsedNode = {\r\n              type: NodeType.ITALIC,\r\n              start: node.start + match.index,\r\n              end: node.start + match.index + match[0].length,\r\n              content: match[2],\r\n            }\r\n\r\n            if (!node.children)\r\n              node.children = []\r\n            node.children.push(italicNode)\r\n          }\r\n        }\r\n\r\n        // 解析行内代码 `code`\r\n        const codeRegex = /`([^`]+)`/g\r\n        while ((match = codeRegex.exec(node.content || '')) !== null) {\r\n          const codeNode: ParsedNode = {\r\n            type: NodeType.CODE,\r\n            start: node.start + match.index,\r\n            end: node.start + match.index + match[0].length,\r\n            content: match[1],\r\n          }\r\n\r\n          if (!node.children)\r\n            node.children = []\r\n          node.children.push(codeNode)\r\n        }\r\n      }\r\n\r\n      // 递归处理子节点\r\n      if (node.children)\r\n        this.parseInlineStyles(node.children, text)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 验证节点结构\r\n   */\r\n  private validateNodeStructure(nodes: ParsedNode[]): void {\r\n    for (const node of nodes) {\r\n      // 验证位置信息\r\n      if (node.start < 0 || node.end < node.start)\r\n        logger.warn(`Invalid node position: start=${node.start}, end=${node.end}`)\r\n\r\n      // 验证节点类型\r\n      if (!Object.values(NodeType).includes(node.type))\r\n        logger.warn(`Unknown node type: ${node.type}`)\r\n\r\n      // 验证特定类型的约束\r\n      switch (node.type) {\r\n        case NodeType.LIST:\r\n          // 列表必须包含列表项\r\n          if (!node.children || node.children.length === 0)\r\n            logger.warn('List node has no children')\r\n\r\n          break\r\n\r\n        case NodeType.TABLE:\r\n          // 表格必须包含行\r\n          if (!node.children || node.children.length === 0)\r\n            logger.warn('Table node has no rows')\r\n\r\n          break\r\n      }\r\n\r\n      // 递归验证子节点\r\n      if (node.children)\r\n        this.validateNodeStructure(node.children)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取缓存键\r\n   */\r\n  private getCacheKey(text: string): string {\r\n    // 使用文本长度和前100个字符的哈希\r\n    const preview = text.slice(0, 100)\r\n    return `${text.length}:${this.simpleHash(preview)}`\r\n  }\r\n\r\n  /**\r\n   * 简单哈希函数\r\n   */\r\n  private simpleHash(str: string): string {\r\n    let hash = 0\r\n    for (let i = 0; i < str.length; i++) {\r\n      const char = str.charCodeAt(i)\r\n      hash = ((hash << 5) - hash) + char\r\n      hash = hash & hash\r\n    }\r\n    return hash.toString(36)\r\n  }\r\n\r\n  /**\r\n   * 添加到缓存\r\n   */\r\n  private addToCache(key: string, result: ParseResult): void {\r\n    if (this.cache.size >= this.options.cacheSize) {\r\n      const firstKey = this.cache.keys().next().value\r\n      this.cache.delete(firstKey)\r\n    }\r\n    this.cache.set(key, result)\r\n  }\r\n\r\n  /**\r\n   * 获取性能统计\r\n   */\r\n  getStats(): {\r\n    initialized: boolean\r\n    memorySize: number\r\n    heapUsage: number\r\n    cacheSize: number\r\n  } {\r\n    return {\r\n      initialized: this.initialized,\r\n      memorySize: this.exports?.getMemorySize() || 0,\r\n      heapUsage: this.exports?.getHeapUsage() || 0,\r\n      cacheSize: this.cache.size,\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 清理资源\r\n   */\r\n  dispose(): void {\r\n    this.cache.clear()\r\n    this.wasmInstance = undefined\r\n    this.wasmMemory = undefined\r\n    this.initialized = false\r\n    logger.info('WasmParser disposed')\r\n  }\r\n}\r\n"],"names":["logger","createLogger","performanceMonitor","getPerformanceMonitor","NodeType","TEXT","PARAGRAPH","HEADING","LIST","LIST_ITEM","BLOCKQUOTE","CODE_BLOCK","HORIZONTAL_RULE","IMAGE","LINK","BOLD","ITALIC","CODE","TABLE","TABLE_ROW","TABLE_CELL","WasmParser","constructor","options","initialized","cache","Map","maxDocumentSize","enableCache","cacheSize","parseInlineStyles","validateStructure","initialize","initPromise","doInitialize","info","startTime","performance","now","wasmBytes","loadWasmBytes","wasmMemory","WebAssembly","Memory","initial","maximum","importObject","env","memory","log","ptr","len","msg","readString","debug","error","instance","instantiate","wasmInstance","exports","initTime","toFixed","process","NODE_ENV","response","fetch","arrayBuffer","base64","Uint8Array","from","atob","default","c","charCodeAt","buffer","parse","text","mark","cacheKey","getCacheKey","has","get","length","Error","textPtr","writeString","outputPtr","nodeCount","parseDocument","nodes","readNodes","validateNodeStructure","result","parseTime","memoryUsed","getHeapUsage","addToCache","measure","toHTML","htmlParts","node","push","nodeToHTMLString","join","tag","getHTMLTag","type","content","childrenHTML","children","map","child","attrs","buildHTMLAttributes","attributes","tagMap","parts","key","value","Object","entries","escapeHTML","String","replace","str","offset","encoder","TextEncoder","bytes","encode","mem","i","decoder","TextDecoder","decode","count","originalText","view","DataView","nodePtr","getUint32","readNode","start","end","childrenPtr","slice","boldRegex","match","exec","boldNode","index","italicRegex","italicNode","codeRegex","codeNode","warn","values","includes","preview","simpleHash","hash","char","toString","size","firstKey","keys","next","delete","set","getStats","memorySize","getMemorySize","heapUsage","dispose","clear","undefined"],"mappings":"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"}