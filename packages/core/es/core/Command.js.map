{"version":3,"file":"Command.js","sources":["../../src/core/Command.ts"],"sourcesContent":["/**\r\n * Command - 命令系统\r\n * 处理编辑器命令和快捷键\r\n */\r\n\r\nimport type { Command } from '../types'\r\nimport { createLogger } from '../utils/logger'\r\nimport { History } from './History'\r\n\r\nconst logger = createLogger('CommandManager')\r\n\r\n/**\r\n * 命令管理器\r\n */\r\nexport class CommandManager {\r\n  private commands: Map<string, Command> = new Map()\r\n  private editor: any\r\n  public history: History\r\n\r\n  constructor(editor: any) {\r\n    this.editor = editor\r\n    this.history = new History(editor)\r\n    logger.debug('CommandManager initialized')\r\n  }\r\n\r\n  /**\r\n   * 撤销\r\n   */\r\n  undo(): boolean {\r\n    const result = this.history.undo()\r\n    if (result)\r\n      this.editor.emit('content-change')\r\n\r\n    return result\r\n  }\r\n\r\n  /**\r\n   * 重做\r\n   */\r\n  redo(): boolean {\r\n    const result = this.history.redo()\r\n    if (result)\r\n      this.editor.emit('content-change')\r\n\r\n    return result\r\n  }\r\n\r\n  /**\r\n   * 检查是否可以撤销\r\n   */\r\n  canUndo(): boolean {\r\n    return this.history.canUndo()\r\n  }\r\n\r\n  /**\r\n   * 检查是否可以重做\r\n   */\r\n  canRedo(): boolean {\r\n    return this.history.canRedo()\r\n  }\r\n\r\n  /**\r\n   * 注册命令\r\n   */\r\n  register(name: string, command: Command): void {\r\n    this.commands.set(name, command)\r\n  }\r\n\r\n  /**\r\n   * 执行命令\r\n   */\r\n  execute(name: string, ...args: any[]): boolean {\r\n    logger.debug(`Executing command: \"${name}\" with args:`, args)\r\n    const command = this.commands.get(name)\r\n    if (!command) {\r\n      logger.warn(`Command \"${name}\" not found`)\r\n      logger.debug('Available commands:', Array.from(this.commands.keys()))\r\n      return false\r\n    }\r\n\r\n    const state = this.editor.getState()\r\n    logger.debug('State:', state)\r\n    logger.debug('Calling command function')\r\n    const result = command(state, this.editor.dispatch.bind(this.editor), ...args)\r\n    logger.debug('Command returned:', result)\r\n    return result\r\n  }\r\n\r\n  /**\r\n   * 检查命令是否可用\r\n   */\r\n  canExecute(name: string): boolean {\r\n    const command = this.commands.get(name)\r\n    if (!command)\r\n      return false\r\n\r\n    const state = this.editor.getState()\r\n    return command(state)\r\n  }\r\n\r\n  /**\r\n   * 获取命令\r\n   */\r\n  get(name: string): Command | undefined {\r\n    return this.commands.get(name)\r\n  }\r\n\r\n  /**\r\n   * 检查命令是否存在\r\n   */\r\n  has(name: string): boolean {\r\n    return this.commands.has(name)\r\n  }\r\n\r\n  /**\r\n   * 获取所有命令\r\n   */\r\n  getCommands(): string[] {\r\n    return Array.from(this.commands.keys())\r\n  }\r\n\r\n  /**\r\n   * 移除命令\r\n   */\r\n  unregister(name: string): void {\r\n    this.commands.delete(name)\r\n  }\r\n\r\n  /**\r\n   * 清除所有命令\r\n   */\r\n  clear(): void {\r\n    this.commands.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * 键盘快捷键管理器\r\n */\r\nexport class KeymapManager {\r\n  private keymap: Map<string, Command> = new Map()\r\n  private editor: any\r\n\r\n  constructor(editor: any) {\r\n    this.editor = editor\r\n  }\r\n\r\n  /**\r\n   * 注册快捷键\r\n   * 支持两种形式：\r\n   * - register('Mod-B', command)\r\n   * - register({ key: 'Ctrl+Z', command: 'undo' | Command })\r\n   */\r\n  register(keys: string | { key: string, command: Command | string }, command?: Command): void {\r\n    if (typeof keys === 'string') {\r\n      if (!command)\r\n        return\r\n      this.keymap.set(this.normalizeKey(keys), command)\r\n      return\r\n    }\r\n\r\n    const keyStr = keys.key\r\n    const cmdOrName = keys.command\r\n    const handler: Command = (state, dispatch) => {\r\n      if (typeof cmdOrName === 'string')\r\n        return this.editor.commands.execute(cmdOrName)\r\n\r\n      return cmdOrName(state, dispatch)\r\n    }\r\n    this.keymap.set(this.normalizeKey(keyStr), handler)\r\n  }\r\n\r\n  /**\r\n   * 处理键盘事件\r\n   */\r\n  handleKeyDown(event: KeyboardEvent): boolean {\r\n    const key = this.eventToKey(event)\r\n    const command = this.keymap.get(key)\r\n\r\n    if (command) {\r\n      const state = this.editor.getState()\r\n      const result = command(state, this.editor.dispatch.bind(this.editor))\r\n\r\n      if (result) {\r\n        event.preventDefault()\r\n        return true\r\n      }\r\n    }\r\n\r\n    return false\r\n  }\r\n\r\n  /**\r\n   * 事件转快捷键字符串\r\n   */\r\n  private eventToKey(event: KeyboardEvent): string {\r\n    const parts: string[] = []\r\n\r\n    if (event.ctrlKey || event.metaKey)\r\n      parts.push('Mod')\r\n    if (event.altKey)\r\n      parts.push('Alt')\r\n    if (event.shiftKey)\r\n      parts.push('Shift')\r\n\r\n    const key = event.key\r\n    if (key.length === 1)\r\n      parts.push(key.toUpperCase())\r\n    else\r\n      parts.push(key)\r\n\r\n    return parts.join('-')\r\n  }\r\n\r\n  /**\r\n   * 规范化快捷键\r\n   */\r\n  private normalizeKey(key: string): string {\r\n    return key\r\n      .split(/[-+]/) // 同时支持用 - 或 + 连接\r\n      .map((part) => {\r\n        if (part === 'Ctrl' || part === 'Cmd' || part === 'Command' || part === 'Meta')\r\n          return 'Mod'\r\n        if (part === 'Option')\r\n          return 'Alt'\r\n        return part\r\n      })\r\n      .join('-')\r\n  }\r\n\r\n  /**\r\n   * 移除快捷键\r\n   */\r\n  unregister(keys: string): void {\r\n    this.keymap.delete(this.normalizeKey(keys))\r\n  }\r\n\r\n  /**\r\n   * 清除所有快捷键\r\n   */\r\n  clear(): void {\r\n    this.keymap.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * 内置命令\r\n */\r\n\r\n// 撤销\r\nexport const undo: Command = (_state, _dispatch) => {\r\n  // 撤销由 CommandManager 中的 History 实例处理\r\n  return true\r\n}\r\n\r\n// 重做\r\nexport const redo: Command = (_state, _dispatch) => {\r\n  // 重做由 CommandManager 中的 History 实例处理\r\n  return true\r\n}\r\n\r\n// 切换标记\r\nexport function toggleMark(markType: string): Command {\r\n  return (state, dispatch) => {\r\n    if (!dispatch)\r\n      return true\r\n\r\n    const selection = window.getSelection()\r\n    if (!selection || selection.rangeCount === 0)\r\n      return false\r\n\r\n    try {\r\n      // 使用 document.execCommand 来切换标记\r\n      // 这是浏览器原生支持的，兼容性好\r\n      const commandMap: Record<string, string> = {\r\n        bold: 'bold',\r\n        italic: 'italic',\r\n        underline: 'underline',\r\n        strike: 'strikeThrough',\r\n        code: 'insertHTML', // 代码需要特殊处理\r\n        superscript: 'superscript',\r\n        subscript: 'subscript',\r\n      }\r\n\r\n      const command = commandMap[markType]\r\n      if (!command)\r\n        return false\r\n\r\n      if (markType === 'code') {\r\n        // 代码标记特殊处理\r\n        const text = selection.toString()\r\n        if (text)\r\n          document.execCommand('insertHTML', false, `<code>${text}</code>`)\r\n      }\r\n      else {\r\n        document.execCommand(command, false)\r\n      }\r\n\r\n      return true\r\n    }\r\n    catch (e) {\r\n      console.error('Failed to toggle mark:', e)\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\n// 设置节点类型\r\nexport function setBlockType(nodeType: string, attrs?: any): Command {\r\n  return (state, dispatch) => {\r\n    if (!dispatch)\r\n      return true\r\n\r\n    const selection = window.getSelection()\r\n    if (!selection || selection.rangeCount === 0)\r\n      return false\r\n\r\n    try {\r\n      const range = selection.getRangeAt(0)\r\n      let block = range.commonAncestorContainer as Node\r\n\r\n      // 查找块级元素\r\n      while (block && (block.nodeType !== Node.ELEMENT_NODE || !isBlockElement(block as HTMLElement))) {\r\n        if (!block.parentNode)\r\n          return false\r\n        block = block.parentNode\r\n      }\r\n\r\n      const blockElement = block as HTMLElement\r\n\r\n      // 创建新节点\r\n      const newNode = document.createElement(nodeType)\r\n      if (attrs) {\r\n        Object.entries(attrs).forEach(([key, value]) => {\r\n          newNode.setAttribute(key, String(value))\r\n        })\r\n      }\r\n\r\n      // 转移内容\r\n      while (blockElement.firstChild)\r\n        newNode.appendChild(blockElement.firstChild)\r\n\r\n      // 替换节点\r\n      blockElement.parentNode?.replaceChild(newNode, blockElement)\r\n\r\n      // 恢复选区\r\n      const newRange = document.createRange()\r\n      newRange.selectNodeContents(newNode)\r\n      selection.removeAllRanges()\r\n      selection.addRange(newRange)\r\n\r\n      return true\r\n    }\r\n    catch (e) {\r\n      console.error('Failed to set block type:', e)\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\n// 插入节点\r\nexport function insertNode(node: any): Command {\r\n  return (state, dispatch) => {\r\n    if (!dispatch)\r\n      return true\r\n\r\n    const selection = window.getSelection()\r\n    if (!selection || selection.rangeCount === 0)\r\n      return false\r\n\r\n    try {\r\n      const range = selection.getRangeAt(0)\r\n\r\n      // 删除选中的内容\r\n      range.deleteContents()\r\n\r\n      // 插入新节点\r\n      if (typeof node === 'string') {\r\n        // 如果是字符串，创建文本节点\r\n        const textNode = document.createTextNode(node)\r\n        range.insertNode(textNode)\r\n      }\r\n      else if (node instanceof HTMLElement) {\r\n        // 如果是 HTML 元素，直接插入\r\n        range.insertNode(node)\r\n      }\r\n      else {\r\n        return false\r\n      }\r\n\r\n      // 移动光标到插入内容之后\r\n      range.collapse(false)\r\n      selection.removeAllRanges()\r\n      selection.addRange(range)\r\n\r\n      return true\r\n    }\r\n    catch (e) {\r\n      console.error('Failed to insert node:', e)\r\n      return false\r\n    }\r\n  }\r\n}\r\n\r\n// 删除选区\r\nexport const deleteSelection: Command = (state, dispatch) => {\r\n  if (state.selection.empty)\r\n    return false\r\n\r\n  if (dispatch) {\r\n    try {\r\n      const selection = window.getSelection()\r\n      if (!selection || selection.rangeCount === 0)\r\n        return false\r\n\r\n      const range = selection.getRangeAt(0)\r\n      if (range.collapsed)\r\n        return false\r\n\r\n      // 删除选中的内容\r\n      range.deleteContents()\r\n\r\n      // 确保光标位置正确\r\n      selection.removeAllRanges()\r\n      selection.addRange(range)\r\n\r\n      return true\r\n    }\r\n    catch (e) {\r\n      console.error('Failed to delete selection:', e)\r\n      return false\r\n    }\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * 辅助函数：判断是否是块级元素\r\n */\r\nfunction isBlockElement(element: HTMLElement): boolean {\r\n  const blockTags = [\r\n    'P',\r\n    'H1',\r\n    'H2',\r\n    'H3',\r\n    'H4',\r\n    'H5',\r\n    'H6',\r\n    'DIV',\r\n    'BLOCKQUOTE',\r\n    'PRE',\r\n    'UL',\r\n    'OL',\r\n    'LI',\r\n    'TABLE',\r\n    'TR',\r\n    'TD',\r\n    'TH',\r\n  ]\r\n  return blockTags.includes(element.tagName)\r\n}\r\n"],"names":["logger","createLogger","CommandManager","constructor","editor","commands","Map","history","History","debug","undo","result","emit","redo","canUndo","canRedo","register","name","command","set","execute","args","get","warn","Array","from","keys","state","getState","dispatch","bind","canExecute","has","getCommands","unregister","delete","clear","KeymapManager","keymap","normalizeKey","keyStr","key","cmdOrName","handler","handleKeyDown","event","eventToKey","preventDefault","parts","ctrlKey","metaKey","push","altKey","shiftKey","length","toUpperCase","join","split","map","part"],"mappings":"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"}