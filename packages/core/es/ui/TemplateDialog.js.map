{"version":3,"file":"TemplateDialog.js","sources":["../../src/ui/TemplateDialog.ts"],"sourcesContent":["/**\r\n * Ê®°ÊùøÈÄâÊã©Âô®ÂØπËØùÊ°Ü\r\n */\r\n\r\nimport type { TemplateManager } from '../template/TemplateManager'\r\nimport type { Template } from '../template/types'\r\nimport { TemplateCategory } from '../template/types'\r\n\r\nexport class TemplateDialog {\r\n  private container: HTMLElement\r\n  private templateManager: TemplateManager\r\n  private onSelect?: (template: Template) => void\r\n  private selectedCategory: TemplateCategory | 'all' = 'all'\r\n  private searchQuery: string = ''\r\n\r\n  constructor(templateManager: TemplateManager) {\r\n    this.templateManager = templateManager\r\n    this.container = this.createDialog()\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫ÂØπËØùÊ°Ü\r\n   */\r\n  show(onSelect?: (template: Template) => void): void {\r\n    this.onSelect = onSelect\r\n    document.body.appendChild(this.container)\r\n    this.loadTemplates()\r\n  }\r\n\r\n  /**\r\n   * ÈöêËóèÂØπËØùÊ°Ü\r\n   */\r\n  hide(): void {\r\n    if (this.container.parentNode)\r\n      this.container.parentNode.removeChild(this.container)\r\n  }\r\n\r\n  /**\r\n   * ÂàõÂª∫ÂØπËØùÊ°ÜÁªìÊûÑ\r\n   */\r\n  private createDialog(): HTMLElement {\r\n    const dialog = document.createElement('div')\r\n    dialog.className = 'template-dialog-overlay'\r\n    dialog.innerHTML = `\r\n      <div class=\"template-dialog\">\r\n        <div class=\"template-dialog-header\">\r\n          <h2>ÈÄâÊã©Ê®°Êùø</h2>\r\n          <button class=\"template-dialog-close\" aria-label=\"ÂÖ≥Èó≠\">√ó</button>\r\n        </div>\r\n        \r\n        <div class=\"template-dialog-toolbar\">\r\n          <div class=\"template-search\">\r\n            <input type=\"text\" placeholder=\"ÊêúÁ¥¢Ê®°Êùø...\" class=\"template-search-input\">\r\n          </div>\r\n          <div class=\"template-categories\">\r\n            <button class=\"category-btn active\" data-category=\"all\">ÂÖ®ÈÉ®</button>\r\n            <button class=\"category-btn\" data-category=\"business\">ÂïÜÂä°</button>\r\n            <button class=\"category-btn\" data-category=\"personal\">‰∏™‰∫∫</button>\r\n            <button class=\"category-btn\" data-category=\"creative\">ÂàõÊÑè</button>\r\n            <button class=\"category-btn\" data-category=\"education\">ÊïôËÇ≤</button>\r\n            <button class=\"category-btn\" data-category=\"technical\">ÊäÄÊúØ</button>\r\n            <button class=\"category-btn\" data-category=\"custom\">Ëá™ÂÆö‰πâ</button>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"template-dialog-content\">\r\n          <div class=\"template-grid\"></div>\r\n        </div>\r\n        \r\n        <div class=\"template-dialog-footer\">\r\n          <button class=\"btn-secondary\" id=\"import-template\">ÂØºÂÖ•Ê®°Êùø</button>\r\n          <button class=\"btn-secondary\" id=\"create-from-current\">‰ªéÂΩìÂâçÂÜÖÂÆπÂàõÂª∫</button>\r\n          <button class=\"btn-primary\" id=\"manage-templates\">ÁÆ°ÁêÜÊ®°Êùø</button>\r\n        </div>\r\n      </div>\r\n    `\r\n\r\n    // Ê∑ªÂä†Ê†∑Âºè\r\n    this.addStyles()\r\n\r\n    // ÁªëÂÆö‰∫ã‰ª∂\r\n    this.bindEvents(dialog)\r\n\r\n    return dialog\r\n  }\r\n\r\n  /**\r\n   * ÁªëÂÆö‰∫ã‰ª∂\r\n   */\r\n  private bindEvents(dialog: HTMLElement): void {\r\n    // ÂÖ≥Èó≠ÊåâÈíÆ\r\n    const closeBtn = dialog.querySelector('.template-dialog-close')\r\n    closeBtn?.addEventListener('click', () => this.hide())\r\n\r\n    // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠\r\n    dialog.addEventListener('click', (e) => {\r\n      if (e.target === dialog)\r\n        this.hide()\r\n    })\r\n\r\n    // ÊêúÁ¥¢\r\n    const searchInput = dialog.querySelector('.template-search-input') as HTMLInputElement\r\n    searchInput?.addEventListener('input', (e) => {\r\n      this.searchQuery = (e.target as HTMLInputElement).value\r\n      this.loadTemplates()\r\n    })\r\n\r\n    // ÂàÜÁ±ªÂàáÊç¢\r\n    const categoryBtns = dialog.querySelectorAll('.category-btn')\r\n    categoryBtns.forEach((btn) => {\r\n      btn.addEventListener('click', (e) => {\r\n        categoryBtns.forEach(b => b.classList.remove('active'))\r\n        btn.classList.add('active')\r\n        this.selectedCategory = (btn as HTMLElement).dataset.category as any\r\n        this.loadTemplates()\r\n      })\r\n    })\r\n\r\n    // ÂØºÂÖ•Ê®°Êùø\r\n    const importBtn = dialog.querySelector('#import-template')\r\n    importBtn?.addEventListener('click', () => this.handleImport())\r\n\r\n    // ‰ªéÂΩìÂâçÂÜÖÂÆπÂàõÂª∫\r\n    const createBtn = dialog.querySelector('#create-from-current')\r\n    createBtn?.addEventListener('click', () => this.handleCreateFromCurrent())\r\n\r\n    // ÁÆ°ÁêÜÊ®°Êùø\r\n    const manageBtn = dialog.querySelector('#manage-templates')\r\n    manageBtn?.addEventListener('click', () => this.showManageDialog())\r\n  }\r\n\r\n  /**\r\n   * Âä†ËΩΩÊ®°ÊùøÂàóË°®\r\n   */\r\n  private async loadTemplates(): Promise<void> {\r\n    const grid = this.container.querySelector('.template-grid')\r\n    if (!grid)\r\n      return\r\n\r\n    grid.innerHTML = '<div class=\"loading\">Âä†ËΩΩ‰∏≠...</div>'\r\n\r\n    try {\r\n      let templates: Template[] = []\r\n\r\n      if (this.searchQuery)\r\n        templates = await this.templateManager.searchTemplates(this.searchQuery)\r\n      else if (this.selectedCategory === 'all')\r\n        templates = await this.templateManager.getAllTemplates()\r\n      else\r\n        templates = await this.templateManager.getTemplatesByCategory(this.selectedCategory as TemplateCategory)\r\n\r\n      if (templates.length === 0) {\r\n        grid.innerHTML = '<div class=\"empty-state\">Ê≤°ÊúâÊâæÂà∞Ê®°Êùø</div>'\r\n        return\r\n      }\r\n\r\n      grid.innerHTML = templates.map(template => this.renderTemplateCard(template)).join('')\r\n\r\n      // ÁªëÂÆöÊ®°ÊùøÂç°ÁâáÁÇπÂáª‰∫ã‰ª∂\r\n      grid.querySelectorAll('.template-card').forEach((card) => {\r\n        card.addEventListener('click', () => {\r\n          const templateId = (card as HTMLElement).dataset.templateId\r\n          if (templateId)\r\n            this.selectTemplate(templateId)\r\n        })\r\n      })\r\n    }\r\n    catch (error) {\r\n      console.error('Failed to load templates:', error)\r\n      grid.innerHTML = '<div class=\"error\">Âä†ËΩΩÊ®°ÊùøÂ§±Ë¥•</div>'\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÊ®°ÊùøÂç°Áâá\r\n   */\r\n  private renderTemplateCard(template: Template): string {\r\n    const { metadata } = template\r\n    const icon = this.getTemplateIcon(metadata.category)\r\n    const badges = [\r\n      metadata.isBuiltin ? '<span class=\"badge badge-builtin\">ÂÜÖÁΩÆ</span>' : '',\r\n      metadata.isCustom ? '<span class=\"badge badge-custom\">Ëá™ÂÆö‰πâ</span>' : '',\r\n    ].filter(Boolean).join('')\r\n\r\n    return `\r\n      <div class=\"template-card\" data-template-id=\"${metadata.id}\">\r\n        <div class=\"template-icon\">${icon}</div>\r\n        <h3 class=\"template-name\">${metadata.name}</h3>\r\n        <p class=\"template-desc\">${metadata.description || 'Êó†ÊèèËø∞'}</p>\r\n        <div class=\"template-meta\">\r\n          ${badges}\r\n          ${metadata.tags ? metadata.tags.map(tag => `<span class=\"tag\">${tag}</span>`).join('') : ''}\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * Ëé∑ÂèñÊ®°ÊùøÂõæÊ†á\r\n   */\r\n  private getTemplateIcon(category: TemplateCategory): string {\r\n    const icons: Record<TemplateCategory, string> = {\r\n      [TemplateCategory.BUSINESS]: 'üìä',\r\n      [TemplateCategory.PERSONAL]: 'üë§',\r\n      [TemplateCategory.CREATIVE]: 'üé®',\r\n      [TemplateCategory.EDUCATION]: 'üìö',\r\n      [TemplateCategory.TECHNICAL]: 'üíª',\r\n      [TemplateCategory.CUSTOM]: '‚öôÔ∏è',\r\n    }\r\n    return icons[category] || 'üìÑ'\r\n  }\r\n\r\n  /**\r\n   * ÈÄâÊã©Ê®°Êùø\r\n   */\r\n  private async selectTemplate(templateId: string): Promise<void> {\r\n    const template = await this.templateManager.getTemplate(templateId)\r\n    if (template) {\r\n      if (template.variables && template.variables.length > 0) {\r\n        // Â¶ÇÊûúÊúâÂèòÈáèÔºåÊòæÁ§∫ÂèòÈáèÂ°´ÂÖÖÂØπËØùÊ°Ü\r\n        this.showVariableDialog(template)\r\n      }\r\n      else {\r\n        // Áõ¥Êé•Â∫îÁî®Ê®°Êùø\r\n        this.applyTemplate(template)\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫ÂèòÈáèÂ°´ÂÖÖÂØπËØùÊ°Ü\r\n   */\r\n  private showVariableDialog(template: Template): void {\r\n    const dialog = document.createElement('div')\r\n    dialog.className = 'variable-dialog-overlay'\r\n\r\n    const variableInputs = template.variables?.map(v => `\r\n      <div class=\"variable-input-group\">\r\n        <label for=\"${v.key}\">\r\n          ${v.label}\r\n          ${v.required ? '<span class=\"required\">*</span>' : ''}\r\n        </label>\r\n        ${this.renderVariableInput(v)}\r\n      </div>\r\n    `).join('') || ''\r\n\r\n    dialog.innerHTML = `\r\n      <div class=\"variable-dialog\">\r\n        <div class=\"variable-dialog-header\">\r\n          <h3>Â°´ÂÖÖÊ®°ÊùøÂèòÈáè - ${template.metadata.name}</h3>\r\n          <button class=\"close-btn\">√ó</button>\r\n        </div>\r\n        <div class=\"variable-dialog-content\">\r\n          ${variableInputs}\r\n        </div>\r\n        <div class=\"variable-dialog-footer\">\r\n          <button class=\"btn-secondary cancel-btn\">ÂèñÊ∂à</button>\r\n          <button class=\"btn-primary apply-btn\">Â∫îÁî®Ê®°Êùø</button>\r\n        </div>\r\n      </div>\r\n    `\r\n\r\n    document.body.appendChild(dialog)\r\n\r\n    // ÁªëÂÆö‰∫ã‰ª∂\r\n    dialog.querySelector('.close-btn')?.addEventListener('click', () => {\r\n      document.body.removeChild(dialog)\r\n    })\r\n\r\n    dialog.querySelector('.cancel-btn')?.addEventListener('click', () => {\r\n      document.body.removeChild(dialog)\r\n    })\r\n\r\n    dialog.querySelector('.apply-btn')?.addEventListener('click', () => {\r\n      const variables: Record<string, any> = {}\r\n\r\n      template.variables?.forEach((v) => {\r\n        const input = dialog.querySelector(`[name=\"${v.key}\"]`) as HTMLInputElement\r\n        if (input)\r\n          variables[v.key] = input.value || v.defaultValue || ''\r\n      })\r\n\r\n      document.body.removeChild(dialog)\r\n      this.applyTemplate(template, variables)\r\n    })\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÂèòÈáèËæìÂÖ•Êéß‰ª∂\r\n   */\r\n  private renderVariableInput(variable: { key: string, type: string, defaultValue?: any, options?: Array<{ label: string, value: any }> }): string {\r\n    switch (variable.type) {\r\n      case 'text':\r\n        return `<input type=\"text\" name=\"${variable.key}\" value=\"${variable.defaultValue || ''}\" />`\r\n      case 'date':\r\n        return `<input type=\"date\" name=\"${variable.key}\" value=\"${variable.defaultValue || ''}\" />`\r\n      case 'select':\r\n        const options = variable.options?.map((opt: any) =>\r\n          `<option value=\"${opt.value}\">${opt.label}</option>`,\r\n        ).join('') || ''\r\n        return `<select name=\"${variable.key}\">${options}</select>`\r\n      case 'boolean':\r\n        return `<input type=\"checkbox\" name=\"${variable.key}\" ${variable.defaultValue ? 'checked' : ''} />`\r\n      default:\r\n        return `<input type=\"text\" name=\"${variable.key}\" value=\"${variable.defaultValue || ''}\" />`\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Â∫îÁî®Ê®°Êùø\r\n   */\r\n  private applyTemplate(template: Template, variables?: Record<string, any>): void {\r\n    if (this.onSelect)\r\n      this.onSelect(template)\r\n\r\n    this.hide()\r\n  }\r\n\r\n  /**\r\n   * Â§ÑÁêÜÂØºÂÖ•\r\n   */\r\n  private handleImport(): void {\r\n    const input = document.createElement('input')\r\n    input.type = 'file'\r\n    input.accept = '.json'\r\n\r\n    input.addEventListener('change', async (e) => {\r\n      const file = (e.target as HTMLInputElement).files?.[0]\r\n      if (file) {\r\n        const reader = new FileReader()\r\n        reader.onload = async (event) => {\r\n          try {\r\n            const jsonStr = event.target?.result as string\r\n            await this.templateManager.importTemplate(jsonStr)\r\n            alert('Ê®°ÊùøÂØºÂÖ•ÊàêÂäüÔºÅ')\r\n            this.loadTemplates()\r\n          }\r\n          catch (error) {\r\n            alert(`Ê®°ÊùøÂØºÂÖ•Â§±Ë¥•Ôºö${error}`)\r\n          }\r\n        }\r\n        reader.readAsText(file)\r\n      }\r\n    })\r\n\r\n    input.click()\r\n  }\r\n\r\n  /**\r\n   * ‰ªéÂΩìÂâçÂÜÖÂÆπÂàõÂª∫Ê®°Êùø\r\n   */\r\n  private handleCreateFromCurrent(): void {\r\n    // Ëøô‰∏™ÂäüËÉΩÈúÄË¶ÅËÆøÈóÆÁºñËæëÂô®ÂÆû‰æãÔºåÂ∞ÜÂú®Êèí‰ª∂‰∏≠ÂÆûÁé∞\r\n    this.hide()\r\n    if ((window as any).editor) {\r\n      // Ëß¶ÂèëÂàõÂª∫Ê®°Êùø‰∫ã‰ª∂\r\n      (window as any).editor.emit('template:create-from-content')\r\n    }\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫Ê®°ÊùøÁÆ°ÁêÜÂØπËØùÊ°Ü\r\n   */\r\n  private async showManageDialog(): Promise<void> {\r\n    const overlay = document.createElement('div')\r\n    overlay.className = 'template-manage-overlay'\r\n    overlay.style.cssText = `\r\n      position: fixed;\r\n      top: 0;\r\n      left: 0;\r\n      right: 0;\r\n      bottom: 0;\r\n      background: rgba(0, 0, 0, 0.5);\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      z-index: 10001;\r\n    `\r\n\r\n    const dialog = document.createElement('div')\r\n    dialog.className = 'template-manage-dialog'\r\n    dialog.style.cssText = `\r\n      background: white;\r\n      border-radius: 8px;\r\n      width: 700px;\r\n      max-height: 600px;\r\n      display: flex;\r\n      flex-direction: column;\r\n      box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\r\n    `\r\n\r\n    // Â§¥ÈÉ®\r\n    const header = document.createElement('div')\r\n    header.className = 'dialog-header'\r\n    header.style.cssText = `\r\n      padding: 20px;\r\n      border-bottom: 1px solid #e0e0e0;\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n    `\r\n    header.innerHTML = `\r\n      <h2 style=\"margin: 0; font-size: 18px;\">Ê®°ÊùøÁÆ°ÁêÜ</h2>\r\n      <button class=\"close-btn\" style=\"border: none; background: none; font-size: 24px; cursor: pointer; color: #666;\">&times;</button>\r\n    `\r\n\r\n    // ÂÜÖÂÆπÂå∫Âüü\r\n    const content = document.createElement('div')\r\n    content.className = 'dialog-content'\r\n    content.style.cssText = `\r\n      padding: 20px;\r\n      flex: 1;\r\n      overflow-y: auto;\r\n    `\r\n\r\n    // Ê®°ÊùøÂàóË°®\r\n    const templates = await this.templateManager.getAllTemplates()\r\n\r\n    templates.forEach((template: Template) => {\r\n      const item = document.createElement('div')\r\n      item.className = 'template-item'\r\n      item.style.cssText = `\r\n        padding: 16px;\r\n        border: 1px solid #e0e0e0;\r\n        border-radius: 6px;\r\n        margin-bottom: 12px;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n      `\r\n\r\n      const info = document.createElement('div')\r\n      info.innerHTML = `\r\n        <div style=\"font-weight: 600; margin-bottom: 4px;\">${template.metadata.name}</div>\r\n        <div style=\"font-size: 12px; color: #666;\">${template.metadata.category}</div>\r\n      `\r\n\r\n      const actions = document.createElement('div')\r\n      actions.style.cssText = 'display: flex; gap: 8px;'\r\n\r\n      // ÁºñËæëÊåâÈíÆ\r\n      const editBtn = document.createElement('button')\r\n      editBtn.textContent = 'ÁºñËæë'\r\n      editBtn.style.cssText = `\r\n        padding: 6px 12px;\r\n        border: 1px solid #3b82f6;\r\n        background: white;\r\n        color: #3b82f6;\r\n        border-radius: 4px;\r\n        cursor: pointer;\r\n      `\r\n      editBtn.addEventListener('click', () => {\r\n    this.showEditTemplateDialog(template.metadata.id, template)\r\n      })\r\n\r\n      // Âà†Èô§ÊåâÈíÆ\r\n      const deleteBtn = document.createElement('button')\r\n      deleteBtn.textContent = 'Âà†Èô§'\r\n      deleteBtn.style.cssText = `\r\n        padding: 6px 12px;\r\n        border: 1px solid #ef4444;\r\n        background: white;\r\n        color: #ef4444;\r\n        border-radius: 4px;\r\n        cursor: pointer;\r\n      `\r\n      deleteBtn.addEventListener('click', () => {\r\n        if (confirm(`Á°ÆÂÆöË¶ÅÂà†Èô§Ê®°Êùø \"${template.metadata.name}\" ÂêóÔºü`)) {\r\n          this.templateManager.deleteTemplate(template.metadata.id)\r\n          item.remove()\r\n        }\r\n      })\r\n\r\n      actions.appendChild(editBtn)\r\n      actions.appendChild(deleteBtn)\r\n\r\n      item.appendChild(info)\r\n      item.appendChild(actions)\r\n      content.appendChild(item)\r\n    })\r\n\r\n    // Â∫ïÈÉ®ÊåâÈíÆ\r\n    const footer = document.createElement('div')\r\n    footer.style.cssText = `\r\n      padding: 16px 20px;\r\n      border-top: 1px solid #e0e0e0;\r\n      display: flex;\r\n      justify-content: space-between;\r\n    `\r\n\r\n    const addBtn = document.createElement('button')\r\n    addBtn.textContent = '+ Êñ∞Âª∫Ê®°Êùø'\r\n    addBtn.style.cssText = `\r\n      padding: 8px 16px;\r\n      border: none;\r\n      background: #3b82f6;\r\n      color: white;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n    `\r\n    addBtn.addEventListener('click', () => {\r\n      this.showCreateTemplateDialog()\r\n    })\r\n\r\n    const closeBtn = document.createElement('button')\r\n    closeBtn.textContent = 'ÂÖ≥Èó≠'\r\n    closeBtn.style.cssText = `\r\n      padding: 8px 16px;\r\n      border: 1px solid #d1d5db;\r\n      background: white;\r\n      color: #374151;\r\n      border-radius: 6px;\r\n      cursor: pointer;\r\n    `\r\n    closeBtn.addEventListener('click', () => {\r\n      document.body.removeChild(overlay)\r\n    })\r\n\r\n    footer.appendChild(addBtn)\r\n    footer.appendChild(closeBtn)\r\n\r\n    dialog.appendChild(header)\r\n    dialog.appendChild(content)\r\n    dialog.appendChild(footer)\r\n    overlay.appendChild(dialog)\r\n\r\n    // ÂÖ≥Èó≠ÊåâÈíÆ‰∫ã‰ª∂\r\n    header.querySelector('.close-btn')?.addEventListener('click', () => {\r\n      document.body.removeChild(overlay)\r\n    })\r\n\r\n    // ÁÇπÂáªÈÅÆÁΩ©Â±ÇÂÖ≥Èó≠\r\n    overlay.addEventListener('click', (e) => {\r\n      if (e.target === overlay)\r\n        document.body.removeChild(overlay)\r\n    })\r\n\r\n    document.body.appendChild(overlay)\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫ÂàõÂª∫Ê®°ÊùøÂØπËØùÊ°Ü\r\n   */\r\n  private showCreateTemplateDialog(): void {\r\n    // ÁÆÄÂåñÂÆûÁé∞ÔºåÂÆûÈôÖÂ∫îËØ•ÊúâÂÆåÊï¥ÁöÑË°®Âçï\r\n    const name = prompt('ËØ∑ËæìÂÖ•Ê®°ÊùøÂêçÁß∞:')\r\n    if (!name)\r\n      return\r\n\r\n    const content = prompt('ËØ∑ËæìÂÖ•Ê®°ÊùøÂÜÖÂÆπ:')\r\n    if (!content)\r\n      return\r\n\r\n    this.templateManager.saveCustomTemplate({\r\n      metadata: {\r\n        id: `custom-${Date.now()}`,\r\n        name,\r\n        category: TemplateCategory.CUSTOM,\r\n      },\r\n      content,\r\n    })\r\n\r\n    alert('Ê®°ÊùøÂ∑≤ÂàõÂª∫ÔºÅ')\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫ÁºñËæëÊ®°ÊùøÂØπËØùÊ°Ü\r\n   */\r\n  private showEditTemplateDialog(id: string, template: Template): void {\r\n    const name = prompt('ËØ∑ËæìÂÖ•Ê®°ÊùøÂêçÁß∞:', template.metadata.name)\r\n    if (!name)\r\n      return\r\n\r\n    const content = prompt('ËØ∑ËæìÂÖ•Ê®°ÊùøÂÜÖÂÆπ:', template.content)\r\n    if (!content)\r\n      return\r\n\r\n    this.templateManager.updateTemplate(id, {\r\n      metadata: {\r\n        ...template.metadata,\r\n        name,\r\n      },\r\n      content,\r\n    })\r\n\r\n    alert('Ê®°ÊùøÂ∑≤Êõ¥Êñ∞ÔºÅ')\r\n  }\r\n\r\n  /**\r\n   * Ê∑ªÂä†Ê†∑Âºè\r\n   */\r\n  private addStyles(): void {\r\n    if (document.getElementById('template-dialog-styles'))\r\n      return\r\n\r\n    const style = document.createElement('style')\r\n    style.id = 'template-dialog-styles'\r\n    style.textContent = `\r\n      .template-dialog-overlay,\r\n      .variable-dialog-overlay {\r\n        position: fixed;\r\n        top: 0;\r\n        left: 0;\r\n        right: 0;\r\n        bottom: 0;\r\n        background: rgba(0, 0, 0, 0.5);\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        z-index: 10000;\r\n      }\r\n\r\n      .template-dialog,\r\n      .variable-dialog {\r\n        background: white;\r\n        border-radius: 8px;\r\n        width: 90%;\r\n        max-width: 900px;\r\n        max-height: 80vh;\r\n        display: flex;\r\n        flex-direction: column;\r\n        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);\r\n      }\r\n\r\n      .template-dialog-header,\r\n      .variable-dialog-header {\r\n        padding: 20px;\r\n        border-bottom: 1px solid #e0e0e0;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n      }\r\n\r\n      .template-dialog-header h2,\r\n      .variable-dialog-header h3 {\r\n        margin: 0;\r\n        font-size: 20px;\r\n        color: #333;\r\n      }\r\n\r\n      .template-dialog-close,\r\n      .close-btn {\r\n        background: none;\r\n        border: none;\r\n        font-size: 28px;\r\n        cursor: pointer;\r\n        color: #999;\r\n        padding: 0;\r\n        width: 30px;\r\n        height: 30px;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n      }\r\n\r\n      .template-dialog-close:hover,\r\n      .close-btn:hover {\r\n        color: #333;\r\n      }\r\n\r\n      .template-dialog-toolbar {\r\n        padding: 15px 20px;\r\n        border-bottom: 1px solid #e0e0e0;\r\n      }\r\n\r\n      .template-search {\r\n        margin-bottom: 15px;\r\n      }\r\n\r\n      .template-search-input {\r\n        width: 100%;\r\n        padding: 8px 12px;\r\n        border: 1px solid #ddd;\r\n        border-radius: 4px;\r\n        font-size: 14px;\r\n      }\r\n\r\n      .template-categories {\r\n        display: flex;\r\n        gap: 10px;\r\n        flex-wrap: wrap;\r\n      }\r\n\r\n      .category-btn {\r\n        padding: 6px 12px;\r\n        border: 1px solid #ddd;\r\n        background: white;\r\n        border-radius: 4px;\r\n        cursor: pointer;\r\n        font-size: 14px;\r\n        transition: all 0.2s;\r\n      }\r\n\r\n      .category-btn:hover {\r\n        background: #f5f5f5;\r\n      }\r\n\r\n      .category-btn.active {\r\n        background: #3498db;\r\n        color: white;\r\n        border-color: #3498db;\r\n      }\r\n\r\n      .template-dialog-content,\r\n      .variable-dialog-content {\r\n        flex: 1;\r\n        padding: 20px;\r\n        overflow-y: auto;\r\n      }\r\n\r\n      .template-grid {\r\n        display: grid;\r\n        grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));\r\n        gap: 20px;\r\n      }\r\n\r\n      .template-card {\r\n        border: 1px solid #e0e0e0;\r\n        border-radius: 8px;\r\n        padding: 20px;\r\n        cursor: pointer;\r\n        transition: all 0.2s;\r\n        background: white;\r\n      }\r\n\r\n      .template-card:hover {\r\n        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);\r\n        transform: translateY(-2px);\r\n      }\r\n\r\n      .template-icon {\r\n        font-size: 36px;\r\n        margin-bottom: 12px;\r\n      }\r\n\r\n      .template-name {\r\n        font-size: 16px;\r\n        font-weight: 600;\r\n        margin: 0 0 8px 0;\r\n        color: #333;\r\n      }\r\n\r\n      .template-desc {\r\n        font-size: 14px;\r\n        color: #666;\r\n        margin: 0 0 12px 0;\r\n        line-height: 1.4;\r\n      }\r\n\r\n      .template-meta {\r\n        display: flex;\r\n        flex-wrap: wrap;\r\n        gap: 6px;\r\n      }\r\n\r\n      .badge {\r\n        font-size: 11px;\r\n        padding: 2px 8px;\r\n        border-radius: 12px;\r\n        font-weight: 500;\r\n      }\r\n\r\n      .badge-builtin {\r\n        background: #e3f2fd;\r\n        color: #1976d2;\r\n      }\r\n\r\n      .badge-custom {\r\n        background: #f3e5f5;\r\n        color: #7b1fa2;\r\n      }\r\n\r\n      .tag {\r\n        font-size: 12px;\r\n        padding: 2px 8px;\r\n        background: #f5f5f5;\r\n        color: #666;\r\n        border-radius: 4px;\r\n      }\r\n\r\n      .template-dialog-footer,\r\n      .variable-dialog-footer {\r\n        padding: 15px 20px;\r\n        border-top: 1px solid #e0e0e0;\r\n        display: flex;\r\n        justify-content: space-between;\r\n        align-items: center;\r\n      }\r\n\r\n      .variable-dialog-footer {\r\n        justify-content: flex-end;\r\n        gap: 10px;\r\n      }\r\n\r\n      .btn-primary,\r\n      .btn-secondary {\r\n        padding: 8px 16px;\r\n        border-radius: 4px;\r\n        border: none;\r\n        font-size: 14px;\r\n        cursor: pointer;\r\n        transition: all 0.2s;\r\n      }\r\n\r\n      .btn-primary {\r\n        background: #3498db;\r\n        color: white;\r\n      }\r\n\r\n      .btn-primary:hover {\r\n        background: #2980b9;\r\n      }\r\n\r\n      .btn-secondary {\r\n        background: white;\r\n        color: #333;\r\n        border: 1px solid #ddd;\r\n      }\r\n\r\n      .btn-secondary:hover {\r\n        background: #f5f5f5;\r\n      }\r\n\r\n      .variable-input-group {\r\n        margin-bottom: 15px;\r\n      }\r\n\r\n      .variable-input-group label {\r\n        display: block;\r\n        margin-bottom: 5px;\r\n        font-size: 14px;\r\n        color: #333;\r\n      }\r\n\r\n      .variable-input-group input,\r\n      .variable-input-group select {\r\n        width: 100%;\r\n        padding: 8px 12px;\r\n        border: 1px solid #ddd;\r\n        border-radius: 4px;\r\n        font-size: 14px;\r\n      }\r\n\r\n      .required {\r\n        color: #e74c3c;\r\n      }\r\n\r\n      .loading,\r\n      .empty-state,\r\n      .error {\r\n        text-align: center;\r\n        padding: 40px;\r\n        color: #666;\r\n      }\r\n\r\n      .error {\r\n        color: #e74c3c;\r\n      }\r\n    `\r\n    document.head.appendChild(style)\r\n  }\r\n}\r\n\r\n/**\r\n * ÊòæÁ§∫Ê®°ÊùøÈÄâÊã©ÂØπËØùÊ°Ü\r\n */\r\nexport function showTemplateDialog(\r\n  templateManager: TemplateManager,\r\n  onSelect?: (template: Template) => void,\r\n): TemplateDialog {\r\n  const dialog = new TemplateDialog(templateManager)\r\n  dialog.show(onSelect)\r\n  return dialog\r\n}\r\n"],"names":["TemplateDialog","constructor","templateManager","selectedCategory","searchQuery","container","createDialog","show","onSelect","document","body","appendChild","loadTemplates","hide","parentNode","removeChild","dialog","createElement","className","innerHTML","addStyles","bindEvents","closeBtn","querySelector","addEventListener","e","target","searchInput","value","categoryBtns","querySelectorAll","forEach","btn","b","classList","remove","add","dataset","category","importBtn","handleImport","createBtn","handleCreateFromCurrent","manageBtn","showManageDialog","grid","templates","searchTemplates","getAllTemplates","getTemplatesByCategory","length","map","template","renderTemplateCard","join","card","templateId","selectTemplate","error","console","metadata","icon","getTemplateIcon","badges","isBuiltin","isCustom","filter","Boolean","id","name","description","tags","tag","icons","TemplateCategory","BUSINESS","PERSONAL","CREATIVE","EDUCATION","TECHNICAL","CUSTOM","getTemplate","variables","showVariableDialog","applyTemplate","variableInputs","v","key","label","required","renderVariableInput","input","defaultValue","variable","type","options","opt","accept","file","files","reader","FileReader","onload","event","jsonStr","result","importTemplate","alert","readAsText","click","window","editor","emit","overlay","style","cssText","header","content","item","info","actions","editBtn","textContent","showEditTemplateDialog","deleteBtn","confirm","deleteTemplate","footer","addBtn","showCreateTemplateDialog","prompt","saveCustomTemplate","Date","now","updateTemplate","getElementById","head","showTemplateDialog"],"mappings":"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"}