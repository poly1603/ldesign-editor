{"version":3,"file":"GanttEditor.js","sources":["../../../../src/plugins/diagrams/editors/GanttEditor.ts"],"sourcesContent":["/**\r\n * 甘特图编辑器\r\n */\r\n\r\nimport type { DiagramEditor, GanttData } from '../types'\r\n\r\nexport class GanttEditor implements DiagramEditor {\r\n  private container?: HTMLElement\r\n  private data?: GanttData\r\n  private onSave?: (data: GanttData) => void\r\n  private onCancel?: () => void\r\n\r\n  async render(container: HTMLElement, options: {\r\n    data: GanttData\r\n    onSave: (data: GanttData) => void\r\n    onCancel: () => void\r\n  }): Promise<void> {\r\n    this.container = container\r\n    this.data = JSON.parse(JSON.stringify(options.data))\r\n    this.onSave = options.onSave\r\n    this.onCancel = options.onCancel\r\n    this.createUI()\r\n  }\r\n\r\n  private createUI(): void {\r\n    if (!this.container || !this.data)\r\n      return\r\n\r\n    this.container.innerHTML = `\r\n      <div style=\"padding: 20px; height: 100%; overflow-y: auto;\">\r\n        <h4>甘特图编辑器</h4>\r\n        <div style=\"margin-top: 20px;\">\r\n          ${this.data.tasks.map((task, i) => `\r\n            <div style=\"border: 1px solid #ddd; border-radius: 4px; padding: 12px; margin-bottom: 12px; background: white;\">\r\n              <div style=\"display: flex; justify-content: space-between; align-items: center;\">\r\n                <div style=\"flex: 1;\">\r\n                  <strong>${task.name}</strong>\r\n                  <div style=\"font-size: 13px; color: #666; margin-top: 4px;\">\r\n                    开始: ${new Date(task.start).toLocaleDateString()} | 结束: ${new Date(task.end).toLocaleDateString()} | 进度: ${task.progress}%\r\n                  </div>\r\n                </div>\r\n                <button onclick=\"window.delGanttTask(${i})\" style=\"padding: 4px 8px; border: 1px solid #f44336; color: #f44336; border-radius: 4px; cursor: pointer;\">删除</button>\r\n              </div>\r\n            </div>\r\n          `).join('')}\r\n          \r\n          <button id=\"addTask\" style=\"padding: 10px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 10px;\">\r\n            ➕ 添加任务\r\n          </button>\r\n        </div>\r\n        \r\n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end; gap: 10px;\">\r\n          <button id=\"cancel\" style=\"padding: 8px 20px; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;\">取消</button>\r\n          <button id=\"save\" style=\"padding: 8px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;\">保存</button>\r\n        </div>\r\n      </div>\r\n    `\r\n\r\n    this.bindEvents()\r\n  }\r\n\r\n  private bindEvents(): void {\r\n    (window as any).delGanttTask = (i: number) => {\r\n      if (this.data && confirm('确定删除？')) {\r\n        this.data.tasks.splice(i, 1)\r\n        this.createUI()\r\n      }\r\n    }\r\n\r\n    this.container?.querySelector('#addTask')?.addEventListener('click', () => {\r\n      const name = prompt('任务名称：', '新任务')\r\n      if (name && this.data) {\r\n        const start = new Date()\r\n        const end = new Date(Date.now() + 7 * 24 * 60 * 60 * 1000)\r\n        this.data.tasks.push({\r\n          name,\r\n          start: start.toISOString(),\r\n          end: end.toISOString(),\r\n          progress: 0,\r\n        })\r\n        this.createUI()\r\n      }\r\n    })\r\n\r\n    this.container?.querySelector('#save')?.addEventListener('click', () => {\r\n      if (this.onSave && this.data)\r\n        this.onSave(this.data)\r\n    })\r\n    this.container?.querySelector('#cancel')?.addEventListener('click', () => this.onCancel?.())\r\n  }\r\n\r\n  destroy(): void {\r\n    delete (window as any).delGanttTask\r\n  }\r\n}\r\n"],"names":["GanttEditor","render","container","options","data","JSON","parse","stringify","onSave","onCancel","createUI","innerHTML","tasks","map","task","i","name","Date","start","toLocaleDateString","end","progress","join","bindEvents","window","delGanttTask","confirm","splice","querySelector","addEventListener","prompt","now","push","toISOString","destroy"],"mappings":"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"}