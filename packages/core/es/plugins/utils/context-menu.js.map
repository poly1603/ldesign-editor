{"version":3,"file":"context-menu.js","sources":["../../../src/plugins/utils/context-menu.ts"],"sourcesContent":["/**\r\n * Context Menu Plugin - Right-click menu functionality\r\n */\r\n\r\nimport type { Plugin } from '../../types'\r\nimport { getLucideIcon } from '../../ui/icons/lucide'\r\n\r\nexport const ContextMenuPlugin: Plugin = {\r\n  name: 'contextMenu',\r\n\r\n  install(editor: any) {\r\n    let contextMenu: HTMLDivElement | null = null\r\n\r\n    // Hide menu function\r\n    const hideContextMenu = () => {\r\n      if (contextMenu) {\r\n        contextMenu.remove()\r\n        contextMenu = null\r\n      }\r\n    }\r\n\r\n    // Show menu function\r\n    const showContextMenu = (e: MouseEvent) => {\r\n      e.preventDefault()\r\n      hideContextMenu()\r\n\r\n      const selection = window.getSelection()\r\n      const hasSelection = selection && selection.toString().length > 0\r\n\r\n      // Create menu\r\n      contextMenu = document.createElement('div')\r\n      contextMenu.className = 'ldesign-context-menu'\r\n      contextMenu.style.cssText = `\r\n        position: fixed;\r\n        left: ${e.clientX}px;\r\n        top: ${e.clientY}px;\r\n        background: white;\r\n        border: 1px solid #e5e7eb;\r\n        border-radius: 8px;\r\n        box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);\r\n        padding: 4px;\r\n        min-width: 200px;\r\n        z-index: 10000;\r\n        font-size: 14px;\r\n        color: #374151;\r\n        user-select: none;\r\n      `\r\n\r\n      // Menu items\r\n      const menuItems = [\r\n        ...(hasSelection\r\n          ? [\r\n            {\r\n              label: 'Copy',\r\n              icon: getLucideIcon('copy'),\r\n              shortcut: 'Ctrl+C',\r\n              action: () => {\r\n                document.execCommand('copy')\r\n                if (window.Toast && typeof window.Toast.show === 'function')\r\n                  window.Toast.show('Copied to clipboard', 'success')\r\n              },\r\n            },\r\n            {\r\n              label: 'Paste',\r\n              icon: getLucideIcon('clipboard'),\r\n              shortcut: 'Ctrl+V',\r\n              action: () => {\r\n                document.execCommand('paste')\r\n              },\r\n            },\r\n            {\r\n              label: 'Cut',\r\n              icon: getLucideIcon('scissors'),\r\n              shortcut: 'Ctrl+X',\r\n              action: () => {\r\n                document.execCommand('cut')\r\n                if (window.Toast && typeof window.Toast.show === 'function')\r\n                  window.Toast.show('Cut to clipboard', 'success')\r\n              },\r\n            },\r\n            { divider: true },\r\n            {\r\n              label: 'Bold',\r\n              icon: getLucideIcon('bold'),\r\n              shortcut: 'Ctrl+B',\r\n              action: () => editor.commands.get('bold')?.(),\r\n            },\r\n            {\r\n              label: 'Italic',\r\n              icon: getLucideIcon('italic'),\r\n              shortcut: 'Ctrl+I',\r\n              action: () => editor.commands.get('italic')?.(),\r\n            },\r\n            {\r\n              label: 'Underline',\r\n              icon: getLucideIcon('underline'),\r\n              shortcut: 'Ctrl+U',\r\n              action: () => editor.commands.get('underline')?.(),\r\n            },\r\n            { divider: true },\r\n          ]\r\n          : []),\r\n        {\r\n          label: 'Select All',\r\n          icon: getLucideIcon('selectAll'),\r\n          shortcut: 'Ctrl+A',\r\n          action: () => {\r\n            const range = document.createRange()\r\n            range.selectNodeContents(editor.contentElement)\r\n            const sel = window.getSelection()\r\n            if (sel) {\r\n              sel.removeAllRanges()\r\n              sel.addRange(range)\r\n            }\r\n          },\r\n        },\r\n        { divider: true },\r\n        {\r\n          label: 'Insert Image',\r\n          icon: getLucideIcon('image'),\r\n          action: () => editor.commands.get('insertImage')?.(),\r\n        },\r\n        {\r\n          label: 'Insert Link',\r\n          icon: getLucideIcon('link'),\r\n          action: () => editor.commands.get('createLink')?.(),\r\n        },\r\n        {\r\n          label: 'Insert Table',\r\n          icon: getLucideIcon('table'),\r\n          action: () => editor.commands.get('insertTable')?.(),\r\n        },\r\n      ]\r\n\r\n      // Render menu items\r\n      menuItems.forEach((item) => {\r\n        if (item.divider) {\r\n          const divider = document.createElement('div')\r\n          divider.style.cssText = 'height: 1px; background: #e5e7eb; margin: 4px 0;'\r\n          contextMenu!.appendChild(divider)\r\n        }\r\n        else {\r\n          const menuItem = document.createElement('div')\r\n          menuItem.style.cssText = `\r\n            padding: 8px 12px;\r\n            cursor: pointer;\r\n            border-radius: 4px;\r\n            display: flex;\r\n            align-items: center;\r\n            gap: 8px;\r\n            transition: background 0.2s;\r\n          `\r\n\r\n          // Icon\r\n          if (item.icon) {\r\n            const icon = document.createElement('span')\r\n            icon.style.cssText = 'width: 16px; height: 16px; opacity: 0.7;'\r\n            icon.innerHTML = item.icon\r\n            menuItem.appendChild(icon)\r\n          }\r\n\r\n          // Label\r\n          const label = document.createElement('span')\r\n          label.textContent = item.label || ''\r\n          label.style.flex = '1'\r\n          menuItem.appendChild(label)\r\n\r\n          // Shortcut\r\n          if (item.shortcut) {\r\n            const shortcut = document.createElement('span')\r\n            shortcut.textContent = item.shortcut\r\n            shortcut.style.cssText = 'font-size: 12px; opacity: 0.5;'\r\n            menuItem.appendChild(shortcut)\r\n          }\r\n\r\n          // Hover effect\r\n          menuItem.onmouseenter = () => {\r\n            menuItem.style.background = '#f3f4f6'\r\n          }\r\n\r\n          menuItem.onmouseleave = () => {\r\n            menuItem.style.background = 'transparent'\r\n          }\r\n\r\n          // Click handler\r\n          menuItem.onclick = (e) => {\r\n            e.stopPropagation()\r\n            item.action?.()\r\n            hideContextMenu()\r\n          }\r\n\r\n          contextMenu!.appendChild(menuItem)\r\n        }\r\n      })\r\n\r\n      // Add to page\r\n      document.body.appendChild(contextMenu)\r\n\r\n      // Adjust position if menu goes off screen\r\n      requestAnimationFrame(() => {\r\n        if (!contextMenu)\r\n          return\r\n\r\n        const rect = contextMenu.getBoundingClientRect()\r\n        const windowWidth = window.innerWidth\r\n        const windowHeight = window.innerHeight\r\n\r\n        if (rect.right > windowWidth)\r\n          contextMenu.style.left = `${windowWidth - rect.width - 10}px`\r\n\r\n        if (rect.bottom > windowHeight)\r\n          contextMenu.style.top = `${windowHeight - rect.height - 10}px`\r\n      })\r\n    }\r\n\r\n    // Event listeners\r\n    if (editor.contentElement)\r\n      editor.contentElement.addEventListener('contextmenu', showContextMenu)\r\n\r\n    // Hide on click outside\r\n    document.addEventListener('click', hideContextMenu)\r\n\r\n    // Hide on ESC\r\n    document.addEventListener('keydown', (e) => {\r\n      if (e.key === 'Escape')\r\n        hideContextMenu()\r\n    })\r\n\r\n    // Register command\r\n    editor.commands.register('contextMenu', showContextMenu)\r\n\r\n    console.log('[ContextMenuPlugin] Loaded')\r\n  },\r\n}\r\n\r\n// Declare Toast type for TypeScript\r\ndeclare global {\r\n  interface Window {\r\n    Toast?: {\r\n      show: (message: string, type: string) => void\r\n    }\r\n  }\r\n}\r\n\r\nexport default ContextMenuPlugin\r\n"],"names":["ContextMenuPlugin","name","install","editor","contextMenu","hideContextMenu","remove","showContextMenu","e","preventDefault","selection","window","getSelection","hasSelection","toString","length","document","createElement","className","style","cssText","clientX","clientY","menuItems","label","icon","getLucideIcon","shortcut","action","execCommand","Toast","show","divider","commands","get","range","createRange","selectNodeContents","contentElement","sel","removeAllRanges","addRange","forEach","item","appendChild","menuItem","innerHTML","textContent","flex","onmouseenter","background","onmouseleave","onclick","stopPropagation","body","requestAnimationFrame","rect","getBoundingClientRect","windowWidth","innerWidth","windowHeight","innerHeight","right","left","width","bottom","top","height","addEventListener","key","register","console","log"],"mappings":"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"}