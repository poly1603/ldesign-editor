{"version":3,"file":"index.js","sources":["../../../src/plugins/horizontal-rule/index.ts"],"sourcesContent":["/**\r\n * 水平线插件\r\n */\r\n\r\nimport type { Command, Plugin } from '../../types'\r\nimport { createPlugin } from '../../core/Plugin'\r\n\r\n/**\r\n * 插入水平线\r\n */\r\nconst insertHorizontalRule: Command = (state, dispatch) => {\r\n  if (!dispatch)\r\n    return true\r\n\r\n  const selection = window.getSelection()\r\n  if (!selection || selection.rangeCount === 0)\r\n    return false\r\n\r\n  const range = selection.getRangeAt(0)\r\n  const hr = document.createElement('hr')\r\n\r\n  range.deleteContents()\r\n  range.insertNode(hr)\r\n\r\n  // 在水平线后插入一个段落，方便继续输入\r\n  const p = document.createElement('p')\r\n  p.innerHTML = '<br>'\r\n  hr.parentNode?.insertBefore(p, hr.nextSibling)\r\n\r\n  // 将光标移到新段落\r\n  const newRange = document.createRange()\r\n  newRange.setStart(p, 0)\r\n  newRange.collapse(true)\r\n  selection.removeAllRanges()\r\n  selection.addRange(newRange)\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * 水平线插件\r\n */\r\nexport const HorizontalRulePlugin: Plugin = createPlugin({\r\n  name: 'horizontalRule',\r\n  commands: {\r\n    insertHorizontalRule,\r\n  },\r\n  keys: {\r\n    'Mod-Shift--': insertHorizontalRule,\r\n  },\r\n  toolbar: [{\r\n    name: 'horizontalRule',\r\n    title: '水平线',\r\n    icon: 'minus',\r\n    command: insertHorizontalRule,\r\n  }],\r\n})\r\n"],"names":["insertHorizontalRule","state","dispatch","selection","window","getSelection","rangeCount","range","getRangeAt","hr","document","createElement","deleteContents","insertNode","p","innerHTML","parentNode","insertBefore","nextSibling","newRange","createRange","setStart","collapse","removeAllRanges","addRange","HorizontalRulePlugin","createPlugin","name","commands","keys","toolbar","title","icon","command"],"mappings":";;;;;;;;;;;AAUA,MAAMA,oBAAAA,GAAgCA,CAACC,KAAAA,EAAOC,QAAAA,KAAa;AACzD,EAAA,IAAI,CAACA,QAAAA;AACH,IAAA,OAAO,IAAA;AAET,EAAA,MAAMC,SAAAA,GAAYC,OAAOC,YAAAA,EAAa;AACtC,EAAA,IAAI,CAACF,SAAAA,IAAaA,SAAAA,CAAUG,UAAAA,KAAe,CAAA;AACzC,IAAA,OAAO,KAAA;AAET,EAAA,MAAMC,KAAAA,GAAQJ,SAAAA,CAAUK,UAAAA,CAAW,CAAC,CAAA;AACpC,EAAA,MAAMC,EAAAA,GAAKC,QAAAA,CAASC,aAAAA,CAAc,IAAI,CAAA;AAEtCJ,EAAAA,KAAAA,CAAMK,cAAAA,EAAe;AACrBL,EAAAA,KAAAA,CAAMM,WAAWJ,EAAE,CAAA;AAGnB,EAAA,MAAMK,CAAAA,GAAIJ,QAAAA,CAASC,aAAAA,CAAc,GAAG,CAAA;AACpCG,EAAAA,CAAAA,CAAEC,SAAAA,GAAY,MAAA;AACdN,EAAAA,EAAAA,CAAGO,UAAAA,EAAYC,YAAAA,CAAaH,CAAAA,EAAGL,EAAAA,CAAGS,WAAW,CAAA;AAG7C,EAAA,MAAMC,QAAAA,GAAWT,SAASU,WAAAA,EAAY;AACtCD,EAAAA,QAAAA,CAASE,QAAAA,CAASP,GAAG,CAAC,CAAA;AACtBK,EAAAA,QAAAA,CAASG,SAAS,IAAI,CAAA;AACtBnB,EAAAA,SAAAA,CAAUoB,eAAAA,EAAgB;AAC1BpB,EAAAA,SAAAA,CAAUqB,SAASL,QAAQ,CAAA;AAE3B,EAAA,OAAO,IAAA;AACT,CAAA;AAKO,MAAMM,uBAA+BC,YAAAA,CAAa;AAAA,EACvDC,IAAAA,EAAM,gBAAA;AAAA,EACNC,QAAAA,EAAU;AAAA,IACR5B;AAAAA,GACF;AAAA,EACA6B,IAAAA,EAAM;AAAA,IACJ,aAAA,EAAe7B;AAAAA,GACjB;AAAA,EACA8B,SAAS,CAAC;AAAA,IACRH,IAAAA,EAAM,gBAAA;AAAA,IACNI,KAAAA,EAAO,oBAAA;AAAA,IACPC,IAAAA,EAAM,OAAA;AAAA,IACNC,OAAAA,EAASjC;AAAAA,GACV;AACH,CAAC;;;;;;;"}