{"version":3,"file":"list.js","sources":["../../../src/plugins/text/list.ts"],"sourcesContent":["/**\r\n * 列表插件\r\n * 提供有序列表和无序列表功�?\r\n */\r\n\r\nimport type { Command, Plugin } from '../../types'\r\nimport { createPlugin } from '../../core/Plugin'\r\n\r\n/**\r\n * 切换无序列表\r\n */\r\nconst toggleBulletList: Command = (state, dispatch) => {\r\n  if (!dispatch)\r\n    return true\r\n  document.execCommand('insertUnorderedList', false)\r\n  return true\r\n}\r\n\r\n/**\r\n * 切换有序列表\r\n */\r\nconst toggleOrderedList: Command = (state, dispatch) => {\r\n  if (!dispatch)\r\n    return true\r\n  document.execCommand('insertOrderedList', false)\r\n  return true\r\n}\r\n\r\n/**\r\n * 检查是否在列表�?\r\n */\r\nfunction isListActive(listType: 'UL' | 'OL') {\r\n  return () => {\r\n    const selection = window.getSelection()\r\n    if (!selection || selection.rangeCount === 0)\r\n      return false\r\n\r\n    let node = selection.anchorNode\r\n    while (node && node !== document.body) {\r\n      if (node.nodeName === listType)\r\n        return true\r\n      node = node.parentNode\r\n    }\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * 无序列表插件\r\n */\r\nexport const BulletListPlugin: Plugin = createPlugin({\r\n  name: 'bulletList',\r\n  commands: {\r\n    toggleBulletList,\r\n  },\r\n  keys: {\r\n    'Mod-Shift-8': toggleBulletList,\r\n  },\r\n  toolbar: [{\r\n    name: 'bulletList',\r\n    title: '无序列表',\r\n    icon: 'list',\r\n    command: toggleBulletList,\r\n    active: isListActive('UL'),\r\n  }],\r\n})\r\n\r\n/**\r\n * 有序列表插件\r\n */\r\nexport const OrderedListPlugin: Plugin = createPlugin({\r\n  name: 'orderedList',\r\n  commands: {\r\n    toggleOrderedList,\r\n  },\r\n  keys: {\r\n    'Mod-Shift-7': toggleOrderedList,\r\n  },\r\n  toolbar: [{\r\n    name: 'orderedList',\r\n    title: '有序列表',\r\n    icon: 'list-ordered',\r\n    command: toggleOrderedList,\r\n    active: isListActive('OL'),\r\n  }],\r\n})\r\n\r\n/**\r\n * 任务列表插件\r\n */\r\nexport const TaskListPlugin: Plugin = createPlugin({\r\n  name: 'taskList',\r\n  commands: {\r\n    toggleTaskList: (state, dispatch) => {\r\n      if (!dispatch)\r\n        return true\r\n\r\n      const selection = window.getSelection()\r\n      if (!selection || selection.rangeCount === 0)\r\n        return false\r\n\r\n      const range = selection.getRangeAt(0)\r\n      const li = document.createElement('li')\r\n      li.innerHTML = '<input type=\"checkbox\"> '\r\n\r\n      range.insertNode(li)\r\n      return true\r\n    },\r\n  },\r\n  toolbar: [{\r\n    name: 'taskList',\r\n    title: '任务列表',\r\n    icon: 'list-checks',\r\n    command: (state, dispatch) => true,\r\n  }],\r\n})\r\n"],"names":["toggleBulletList","state","dispatch","document","execCommand","toggleOrderedList","isListActive","listType","selection","window","getSelection","rangeCount","node","anchorNode","body","nodeName","parentNode","BulletListPlugin","createPlugin","name","commands","keys","toolbar","title","icon","command","active","OrderedListPlugin","TaskListPlugin","toggleTaskList","range","getRangeAt","li","createElement","innerHTML","insertNode"],"mappings":"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"}