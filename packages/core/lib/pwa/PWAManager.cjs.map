{"version":3,"file":"PWAManager.cjs","sources":["../../src/pwa/PWAManager.ts"],"sourcesContent":["/**\r\n * PWA管理器\r\n * 管理Service Worker、离线缓存、后台同步等PWA功能\r\n */\r\n\r\nimport type { PWAConfig, PWAStatus } from './types'\r\nimport { EventEmitter } from '../core/EventEmitter'\r\nimport { createLogger } from '../utils/logger'\r\nimport { BackgroundSyncManager } from './BackgroundSyncManager'\r\nimport { CacheManager } from './CacheManager'\r\nimport { InstallPromptManager } from './InstallPromptManager'\r\nimport { ServiceWorkerManager } from './ServiceWorkerManager'\r\n\r\nconst logger = createLogger('PWAManager')\r\n\r\nexport class PWAManager extends EventEmitter<any> {\r\n  private config: Required<PWAConfig>\r\n  private swManager: ServiceWorkerManager\r\n  private cacheManager: CacheManager\r\n  private syncManager: BackgroundSyncManager\r\n  private installManager: InstallPromptManager\r\n  private status: PWAStatus = 'idle'\r\n  private updateAvailable = false\r\n\r\n  constructor(config: PWAConfig = {}) {\r\n    super()\r\n\r\n    this.config = {\r\n      enabled: true,\r\n      scope: '/',\r\n      updateInterval: 60000, // 1分钟\r\n      cacheStrategy: 'network-first',\r\n      offlineSupport: true,\r\n      backgroundSync: true,\r\n      installPrompt: true,\r\n      updateOnReload: false,\r\n      skipWaiting: false,\r\n      ...config,\r\n    }\r\n\r\n    // 初始化子管理器\r\n    this.swManager = new ServiceWorkerManager(this.config)\r\n    this.cacheManager = new CacheManager(this.config)\r\n    this.syncManager = new BackgroundSyncManager(this.config)\r\n    this.installManager = new InstallPromptManager(this.config)\r\n\r\n    this.setupEventListeners()\r\n  }\r\n\r\n  /**\r\n   * 初始化PWA\r\n   */\r\n  async initialize(): Promise<void> {\r\n    if (!this.config.enabled) {\r\n      logger.info('PWA is disabled')\r\n      return\r\n    }\r\n\r\n    if (!this.isSupported()) {\r\n      logger.warn('PWA is not supported in this browser')\r\n      this.emit('unsupported', [])\r\n      return\r\n    }\r\n\r\n    logger.info('Initializing PWA')\r\n    this.status = 'initializing'\r\n    this.emit('status-change', ['initializing'])\r\n\r\n    try {\r\n      // 注册Service Worker\r\n      await this.swManager.register()\r\n\r\n      // 初始化缓存\r\n      await this.cacheManager.initialize()\r\n\r\n      // 初始化后台同步\r\n      if (this.config.backgroundSync)\r\n        await this.syncManager.initialize()\r\n\r\n      // 显示安装提示\r\n      if (this.config.installPrompt)\r\n        await this.installManager.initialize()\r\n\r\n      this.status = 'ready'\r\n      this.emit('status-change', ['ready'])\r\n      this.emit('ready', [])\r\n\r\n      // 开始检查更新\r\n      this.startUpdateCheck()\r\n\r\n      logger.info('PWA initialized successfully')\r\n    }\r\n    catch (error) {\r\n      logger.error('Failed to initialize PWA:', error)\r\n      this.status = 'error'\r\n      this.emit('status-change', ['error'])\r\n      this.emit('error', [error as Error])\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 检查PWA支持\r\n   */\r\n  isSupported(): boolean {\r\n    return (\r\n      'serviceWorker' in navigator\r\n      && 'caches' in window\r\n      && 'PushManager' in window\r\n    )\r\n  }\r\n\r\n  /**\r\n   * 设置事件监听\r\n   */\r\n  private setupEventListeners(): void {\r\n    // Service Worker事件\r\n    this.swManager.on('update-available', () => {\r\n      this.updateAvailable = true\r\n      this.emit('update-available', [])\r\n    })\r\n\r\n    this.swManager.on('update-installed', () => {\r\n      this.emit('update-installed', [])\r\n    })\r\n\r\n    this.swManager.on('update-activated', () => {\r\n      this.updateAvailable = false\r\n      this.emit('update-activated', [])\r\n    })\r\n\r\n    this.swManager.on('offline', () => {\r\n      this.emit('offline', [])\r\n    })\r\n\r\n    this.swManager.on('online', () => {\r\n      this.emit('online', [])\r\n    })\r\n\r\n    // 缓存事件\r\n    this.cacheManager.on('cache-updated', (cacheName: any) => {\r\n      this.emit('cache-updated', [cacheName])\r\n    })\r\n\r\n    // 同步事件\r\n    this.syncManager.on('sync-success', (tag: any) => {\r\n      this.emit('sync-success', [tag])\r\n    })\r\n\r\n    this.syncManager.on('sync-error', (error: any) => {\r\n      this.emit('sync-error', [error])\r\n    })\r\n\r\n    // 安装提示事件\r\n    this.installManager.on('prompt-shown', () => {\r\n      this.emit('install-prompt-shown', [])\r\n    })\r\n\r\n    this.installManager.on('installed', () => {\r\n      this.emit('installed', [])\r\n    })\r\n\r\n    this.installManager.on('dismissed', () => {\r\n      this.emit('install-dismissed', [])\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 开始检查更新\r\n   */\r\n  private startUpdateCheck(): void {\r\n    if (this.config.updateInterval <= 0)\r\n      return\r\n\r\n    setInterval(async () => {\r\n      try {\r\n        await this.checkForUpdates()\r\n      }\r\n      catch (error) {\r\n        logger.error('Update check failed:', error)\r\n      }\r\n    }, this.config.updateInterval)\r\n  }\r\n\r\n  /**\r\n   * 检查更新\r\n   */\r\n  async checkForUpdates(): Promise<boolean> {\r\n    return await this.swManager.checkForUpdates()\r\n  }\r\n\r\n  /**\r\n   * 应用更新\r\n   */\r\n  async applyUpdate(): Promise<void> {\r\n    if (!this.updateAvailable) {\r\n      logger.warn('No update available')\r\n      return\r\n    }\r\n\r\n    await this.swManager.update()\r\n\r\n    if (this.config.updateOnReload)\r\n      window.location.reload()\r\n  }\r\n\r\n  /**\r\n   * 跳过等待，立即激活新版本\r\n   */\r\n  async skipWaiting(): Promise<void> {\r\n    await this.swManager.skipWaiting()\r\n  }\r\n\r\n  /**\r\n   * 缓存资源\r\n   */\r\n  async cacheResources(urls: string[]): Promise<void> {\r\n    await this.cacheManager.addResources(urls)\r\n  }\r\n\r\n  /**\r\n   * 清除缓存\r\n   */\r\n  async clearCache(cacheName?: string): Promise<void> {\r\n    await this.cacheManager.clear(cacheName)\r\n  }\r\n\r\n  /**\r\n   * 获取缓存大小\r\n   */\r\n  async getCacheSize(): Promise<number> {\r\n    return await this.cacheManager.getSize()\r\n  }\r\n\r\n  /**\r\n   * 注册后台同步\r\n   */\r\n  async registerSync(tag: string, data?: any): Promise<void> {\r\n    await this.syncManager.register(tag, data)\r\n  }\r\n\r\n  /**\r\n   * 显示安装提示\r\n   */\r\n  async showInstallPrompt(): Promise<boolean> {\r\n    return await this.installManager.show()\r\n  }\r\n\r\n  /**\r\n   * 检查是否已安装\r\n   */\r\n  isInstalled(): boolean {\r\n    return this.installManager.isInstalled()\r\n  }\r\n\r\n  /**\r\n   * 获取状态\r\n   */\r\n  getStatus(): PWAStatus {\r\n    return this.status\r\n  }\r\n\r\n  /**\r\n   * 是否有更新\r\n   */\r\n  hasUpdate(): boolean {\r\n    return this.updateAvailable\r\n  }\r\n\r\n  /**\r\n   * 是否在线\r\n   */\r\n  isOnline(): boolean {\r\n    return navigator.onLine\r\n  }\r\n\r\n  /**\r\n   * 获取统计信息\r\n   */\r\n  async getStats() {\r\n    const [cacheSize, swStatus] = await Promise.all([\r\n      this.cacheManager.getSize(),\r\n      this.swManager.getStatus(),\r\n    ])\r\n\r\n    return {\r\n      status: this.status,\r\n      online: this.isOnline(),\r\n      installed: this.isInstalled(),\r\n      updateAvailable: this.updateAvailable,\r\n      cacheSize,\r\n      serviceWorker: swStatus,\r\n      backgroundSync: this.syncManager.isSupported(),\r\n      pushNotifications: 'Notification' in window && Notification.permission === 'granted',\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 注销PWA\r\n   */\r\n  async unregister(): Promise<void> {\r\n    logger.info('Unregistering PWA')\r\n\r\n    await this.swManager.unregister()\r\n    await this.cacheManager.clear()\r\n\r\n    this.status = 'idle'\r\n    this.emit('status-change', ['idle'])\r\n\r\n    logger.info('PWA unregistered')\r\n  }\r\n\r\n  /**\r\n   * 销毁\r\n   */\r\n  destroy(): void {\r\n    this.swManager.destroy()\r\n    this.cacheManager.destroy()\r\n    this.syncManager.destroy()\r\n    this.installManager.destroy()\r\n    if (typeof (this as any).removeAllListeners === 'function') {\r\n      (this as any).removeAllListeners()\r\n    }\r\n  }\r\n}\r\n"],"names":["logger","createLogger","PWAManager","EventEmitter","constructor","config","status","updateAvailable","enabled","scope","updateInterval","cacheStrategy","offlineSupport","backgroundSync","installPrompt","updateOnReload","skipWaiting","swManager","ServiceWorkerManager","cacheManager","CacheManager","syncManager","BackgroundSyncManager","installManager","InstallPromptManager","setupEventListeners","initialize","info","isSupported","warn","emit","register","startUpdateCheck","error","navigator","window","on","cacheName","tag","setInterval","checkForUpdates","applyUpdate","update","location","reload","cacheResources","urls","addResources","clearCache","clear","getCacheSize","getSize","registerSync","data","showInstallPrompt","show","isInstalled","getStatus","hasUpdate","isOnline","onLine","getStats","cacheSize","swStatus","Promise","all","online","installed","serviceWorker","pushNotifications","Notification","permission","unregister","destroy","removeAllListeners"],"mappings":"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"}