{"version":3,"file":"table-toolbar.cjs","sources":["../../../src/plugins/table/table-toolbar.ts"],"sourcesContent":["/**\r\n * 表格悬浮工具栏插件\r\n * 提供单元格操作、行列管理、样式设置等功能\r\n */\r\n\r\nimport type { Plugin } from '../../types'\r\nimport { createPlugin } from '../../core/Plugin'\r\n\r\n// 工具栏样式\r\nconst TOOLBAR_STYLES = `\r\n.table-toolbar {\r\n  position: absolute;\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2px;\r\n  padding: 6px 8px;\r\n  background: #fff;\r\n  border: 1px solid #e5e7eb;\r\n  border-radius: 8px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  z-index: 1000;\r\n  font-size: 13px;\r\n  user-select: none;\r\n}\r\n\r\n.table-toolbar-group {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 2px;\r\n  padding: 0 4px;\r\n  border-right: 1px solid #e5e7eb;\r\n}\r\n\r\n.table-toolbar-group:last-child {\r\n  border-right: none;\r\n}\r\n\r\n.table-toolbar-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  width: 28px;\r\n  height: 28px;\r\n  padding: 0;\r\n  background: transparent;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  color: #374151;\r\n  transition: all 0.15s ease;\r\n}\r\n\r\n.table-toolbar-btn:hover {\r\n  background: #f3f4f6;\r\n  color: #1f2937;\r\n}\r\n\r\n.table-toolbar-btn:active {\r\n  background: #e5e7eb;\r\n}\r\n\r\n.table-toolbar-btn.active {\r\n  background: #3b82f6;\r\n  color: #fff;\r\n}\r\n\r\n.table-toolbar-btn:disabled {\r\n  opacity: 0.4;\r\n  cursor: not-allowed;\r\n}\r\n\r\n.table-toolbar-btn svg {\r\n  width: 16px;\r\n  height: 16px;\r\n}\r\n\r\n.table-toolbar-dropdown {\r\n  position: relative;\r\n}\r\n\r\n.table-toolbar-dropdown-menu {\r\n  position: absolute;\r\n  top: 100%;\r\n  left: 0;\r\n  margin-top: 4px;\r\n  padding: 4px;\r\n  background: #fff;\r\n  border: 1px solid #e5e7eb;\r\n  border-radius: 6px;\r\n  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);\r\n  min-width: 140px;\r\n  z-index: 1001;\r\n}\r\n\r\n.table-toolbar-dropdown-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8px;\r\n  width: 100%;\r\n  padding: 8px 12px;\r\n  background: transparent;\r\n  border: none;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  color: #374151;\r\n  font-size: 13px;\r\n  text-align: left;\r\n  transition: background 0.15s ease;\r\n}\r\n\r\n.table-toolbar-dropdown-item:hover {\r\n  background: #f3f4f6;\r\n}\r\n\r\n.table-toolbar-dropdown-item svg {\r\n  width: 14px;\r\n  height: 14px;\r\n  opacity: 0.7;\r\n}\r\n\r\n.table-toolbar-color-picker {\r\n  display: grid;\r\n  grid-template-columns: repeat(6, 1fr);\r\n  gap: 4px;\r\n  padding: 8px;\r\n}\r\n\r\n.table-toolbar-color-btn {\r\n  width: 24px;\r\n  height: 24px;\r\n  border: 2px solid transparent;\r\n  border-radius: 4px;\r\n  cursor: pointer;\r\n  transition: transform 0.1s ease;\r\n}\r\n\r\n.table-toolbar-color-btn:hover {\r\n  transform: scale(1.15);\r\n  border-color: #3b82f6;\r\n}\r\n\r\n.table-toolbar-separator {\r\n  width: 1px;\r\n  height: 20px;\r\n  background: #e5e7eb;\r\n  margin: 0 4px;\r\n}\r\n\r\n/* 单元格选中状态 */\r\n.table-cell-selected {\r\n  background: rgba(59, 130, 246, 0.1) !important;\r\n  outline: 2px solid #3b82f6;\r\n  outline-offset: -2px;\r\n}\r\n\r\n/* 表格hover效果 */\r\n.table-wrapper:hover {\r\n  outline: 2px solid #3b82f6;\r\n  outline-offset: 2px;\r\n}\r\n`\r\n\r\n// SVG 图标\r\nconst ICONS = {\r\n  addRowAbove: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 10h18M3 14h18M10 3v18M14 3v18\"/><path d=\"M12 3v4M10 5h4\"/></svg>`,\r\n  addRowBelow: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 10h18M3 14h18M10 3v18M14 3v18\"/><path d=\"M12 17v4M10 19h4\"/></svg>`,\r\n  addColLeft: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M10 3v18M14 3v18M3 10h18M3 14h18\"/><path d=\"M3 12h4M5 10v4\"/></svg>`,\r\n  addColRight: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M10 3v18M14 3v18M3 10h18M3 14h18\"/><path d=\"M17 12h4M19 10v4\"/></svg>`,\r\n  deleteRow: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 6h18M3 12h18M3 18h18\"/><path d=\"M17 9l-4 6M13 9l4 6\" stroke=\"#ef4444\"/></svg>`,\r\n  deleteCol: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M6 3v18M12 3v18M18 3v18\"/><path d=\"M9 10l6 4M9 14l6-4\" stroke=\"#ef4444\"/></svg>`,\r\n  deleteTable: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M9 9l6 6M15 9l-6 6\" stroke=\"#ef4444\"/></svg>`,\r\n  mergeCells: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M3 12h18M12 3v18\"/><path d=\"M8 8l4 4-4 4M16 8l-4 4 4 4\"/></svg>`,\r\n  splitCell: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M12 3v18\"/><path d=\"M8 12H3M21 12h-5\"/></svg>`,\r\n  bgColor: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\"/><path d=\"M3 15h18\" fill=\"currentColor\"/></svg>`,\r\n  borderStyle: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><rect x=\"3\" y=\"3\" width=\"18\" height=\"18\" rx=\"2\" stroke-dasharray=\"4 2\"/></svg>`,\r\n  alignLeft: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 6h18M3 12h12M3 18h18\"/></svg>`,\r\n  alignCenter: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 6h18M6 12h12M3 18h18\"/></svg>`,\r\n  alignRight: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><path d=\"M3 6h18M9 12h12M3 18h18\"/></svg>`,\r\n  more: `<svg viewBox=\"0 0 24 24\" fill=\"none\" stroke=\"currentColor\" stroke-width=\"2\"><circle cx=\"12\" cy=\"12\" r=\"1\"/><circle cx=\"19\" cy=\"12\" r=\"1\"/><circle cx=\"5\" cy=\"12\" r=\"1\"/></svg>`,\r\n}\r\n\r\n// 预设颜色\r\nconst PRESET_COLORS = [\r\n  '#ffffff', '#f3f4f6', '#e5e7eb', '#d1d5db', '#9ca3af', '#6b7280',\r\n  '#fef3c7', '#fde68a', '#fcd34d', '#fbbf24', '#f59e0b', '#d97706',\r\n  '#d1fae5', '#a7f3d0', '#6ee7b7', '#34d399', '#10b981', '#059669',\r\n  '#dbeafe', '#bfdbfe', '#93c5fd', '#60a5fa', '#3b82f6', '#2563eb',\r\n  '#ede9fe', '#ddd6fe', '#c4b5fd', '#a78bfa', '#8b5cf6', '#7c3aed',\r\n  '#fce7f3', '#fbcfe8', '#f9a8d4', '#f472b6', '#ec4899', '#db2777',\r\n]\r\n\r\n// 边框样式选项\r\nconst BORDER_STYLES = [\r\n  { value: 'none', label: '无边框' },\r\n  { value: 'solid', label: '实线' },\r\n  { value: 'dashed', label: '虚线' },\r\n  { value: 'dotted', label: '点线' },\r\n  { value: 'double', label: '双线' },\r\n]\r\n\r\n/**\r\n * 表格工具栏类\r\n */\r\nclass TableToolbar {\r\n  private toolbar: HTMLElement | null = null\r\n  private currentTable: HTMLTableElement | null = null\r\n  private currentCell: HTMLTableCellElement | null = null\r\n  private selectedCells: HTMLTableCellElement[] = []\r\n  private isSelecting = false\r\n  private startCell: HTMLTableCellElement | null = null\r\n  private styleInjected = false\r\n\r\n  constructor() {\r\n    this.injectStyles()\r\n    this.setupEventListeners()\r\n  }\r\n\r\n  /**\r\n   * 注入样式\r\n   */\r\n  private injectStyles() {\r\n    if (this.styleInjected) return\r\n    \r\n    const styleId = 'table-toolbar-styles'\r\n    if (document.getElementById(styleId)) {\r\n      this.styleInjected = true\r\n      return\r\n    }\r\n\r\n    const style = document.createElement('style')\r\n    style.id = styleId\r\n    style.textContent = TOOLBAR_STYLES\r\n    document.head.appendChild(style)\r\n    this.styleInjected = true\r\n  }\r\n\r\n  /**\r\n   * 设置事件监听\r\n   */\r\n  private setupEventListeners() {\r\n    // 点击表格单元格\r\n    document.addEventListener('click', (e) => {\r\n      const target = e.target as HTMLElement\r\n      const cell = target.closest('td, th') as HTMLTableCellElement\r\n      const table = target.closest('table') as HTMLTableElement\r\n\r\n      if (cell && table) {\r\n        this.selectCell(cell, table)\r\n      } else if (!target.closest('.table-toolbar')) {\r\n        this.hideToolbar()\r\n      }\r\n    })\r\n\r\n    // 表格单元格选择（拖拽选择多个单元格）\r\n    document.addEventListener('mousedown', (e) => {\r\n      const target = e.target as HTMLElement\r\n      const cell = target.closest('td, th') as HTMLTableCellElement\r\n      \r\n      if (cell && e.shiftKey) {\r\n        this.isSelecting = true\r\n        this.startCell = cell\r\n        e.preventDefault()\r\n      }\r\n    })\r\n\r\n    document.addEventListener('mousemove', (e) => {\r\n      if (!this.isSelecting || !this.startCell) return\r\n\r\n      const target = e.target as HTMLElement\r\n      const cell = target.closest('td, th') as HTMLTableCellElement\r\n\r\n      if (cell && cell.closest('table') === this.startCell.closest('table')) {\r\n        this.selectRange(this.startCell, cell)\r\n      }\r\n    })\r\n\r\n    document.addEventListener('mouseup', () => {\r\n      this.isSelecting = false\r\n      this.startCell = null\r\n    })\r\n\r\n    // 键盘快捷键\r\n    document.addEventListener('keydown', (e) => {\r\n      if (!this.currentCell) return\r\n\r\n      if (e.key === 'Escape') {\r\n        this.hideToolbar()\r\n        this.clearSelection()\r\n      }\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 选择单元格\r\n   */\r\n  private selectCell(cell: HTMLTableCellElement, table: HTMLTableElement) {\r\n    this.clearSelection()\r\n    \r\n    this.currentCell = cell\r\n    this.currentTable = table\r\n    this.selectedCells = [cell]\r\n    \r\n    cell.classList.add('table-cell-selected')\r\n    this.showToolbar(cell)\r\n  }\r\n\r\n  /**\r\n   * 选择单元格范围\r\n   */\r\n  private selectRange(start: HTMLTableCellElement, end: HTMLTableCellElement) {\r\n    const table = start.closest('table')\r\n    if (!table) return\r\n\r\n    this.clearSelection()\r\n\r\n    const startRow = (start.parentElement as HTMLTableRowElement).rowIndex\r\n    const endRow = (end.parentElement as HTMLTableRowElement).rowIndex\r\n    const startCol = start.cellIndex\r\n    const endCol = end.cellIndex\r\n\r\n    const minRow = Math.min(startRow, endRow)\r\n    const maxRow = Math.max(startRow, endRow)\r\n    const minCol = Math.min(startCol, endCol)\r\n    const maxCol = Math.max(startCol, endCol)\r\n\r\n    this.selectedCells = []\r\n    \r\n    for (let i = minRow; i <= maxRow; i++) {\r\n      const row = table.rows[i]\r\n      for (let j = minCol; j <= maxCol; j++) {\r\n        const cell = row.cells[j]\r\n        if (cell) {\r\n          cell.classList.add('table-cell-selected')\r\n          this.selectedCells.push(cell)\r\n        }\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 清除选择\r\n   */\r\n  private clearSelection() {\r\n    this.selectedCells.forEach(cell => {\r\n      cell.classList.remove('table-cell-selected')\r\n    })\r\n    this.selectedCells = []\r\n  }\r\n\r\n  /**\r\n   * 显示工具栏\r\n   */\r\n  private showToolbar(cell: HTMLTableCellElement) {\r\n    this.hideToolbar()\r\n    \r\n    this.toolbar = this.createToolbar()\r\n    document.body.appendChild(this.toolbar)\r\n    \r\n    this.positionToolbar(cell)\r\n  }\r\n\r\n  /**\r\n   * 隐藏工具栏\r\n   */\r\n  private hideToolbar() {\r\n    if (this.toolbar) {\r\n      this.toolbar.remove()\r\n      this.toolbar = null\r\n    }\r\n    this.clearSelection()\r\n    this.currentCell = null\r\n    this.currentTable = null\r\n  }\r\n\r\n  /**\r\n   * 定位工具栏\r\n   */\r\n  private positionToolbar(cell: HTMLTableCellElement) {\r\n    if (!this.toolbar) return\r\n\r\n    const rect = cell.getBoundingClientRect()\r\n    const toolbarRect = this.toolbar.getBoundingClientRect()\r\n    \r\n    let top = rect.top - toolbarRect.height - 8\r\n    let left = rect.left + (rect.width - toolbarRect.width) / 2\r\n\r\n    // 边界检查\r\n    if (top < 10) {\r\n      top = rect.bottom + 8\r\n    }\r\n    if (left < 10) {\r\n      left = 10\r\n    }\r\n    if (left + toolbarRect.width > window.innerWidth - 10) {\r\n      left = window.innerWidth - toolbarRect.width - 10\r\n    }\r\n\r\n    this.toolbar.style.top = `${top + window.scrollY}px`\r\n    this.toolbar.style.left = `${left + window.scrollX}px`\r\n  }\r\n\r\n  /**\r\n   * 创建工具栏\r\n   */\r\n  private createToolbar(): HTMLElement {\r\n    const toolbar = document.createElement('div')\r\n    toolbar.className = 'table-toolbar'\r\n\r\n    // 行列操作组\r\n    const rowColGroup = document.createElement('div')\r\n    rowColGroup.className = 'table-toolbar-group'\r\n    \r\n    rowColGroup.appendChild(this.createButton('addRowAbove', '在上方插入行', () => this.addRow('above')))\r\n    rowColGroup.appendChild(this.createButton('addRowBelow', '在下方插入行', () => this.addRow('below')))\r\n    rowColGroup.appendChild(this.createButton('addColLeft', '在左侧插入列', () => this.addColumn('left')))\r\n    rowColGroup.appendChild(this.createButton('addColRight', '在右侧插入列', () => this.addColumn('right')))\r\n    \r\n    toolbar.appendChild(rowColGroup)\r\n\r\n    // 删除操作组\r\n    const deleteGroup = document.createElement('div')\r\n    deleteGroup.className = 'table-toolbar-group'\r\n    \r\n    deleteGroup.appendChild(this.createButton('deleteRow', '删除行', () => this.deleteRow()))\r\n    deleteGroup.appendChild(this.createButton('deleteCol', '删除列', () => this.deleteColumn()))\r\n    deleteGroup.appendChild(this.createButton('deleteTable', '删除表格', () => this.deleteTable()))\r\n    \r\n    toolbar.appendChild(deleteGroup)\r\n\r\n    // 合并/拆分组\r\n    const mergeGroup = document.createElement('div')\r\n    mergeGroup.className = 'table-toolbar-group'\r\n    \r\n    mergeGroup.appendChild(this.createButton('mergeCells', '合并单元格', () => this.mergeCells(), this.selectedCells.length < 2))\r\n    mergeGroup.appendChild(this.createButton('splitCell', '拆分单元格', () => this.splitCell()))\r\n    \r\n    toolbar.appendChild(mergeGroup)\r\n\r\n    // 样式组\r\n    const styleGroup = document.createElement('div')\r\n    styleGroup.className = 'table-toolbar-group'\r\n    \r\n    styleGroup.appendChild(this.createColorDropdown())\r\n    styleGroup.appendChild(this.createBorderDropdown())\r\n    styleGroup.appendChild(this.createAlignDropdown())\r\n    \r\n    toolbar.appendChild(styleGroup)\r\n\r\n    return toolbar\r\n  }\r\n\r\n  /**\r\n   * 创建按钮\r\n   */\r\n  private createButton(icon: string, title: string, onClick: () => void, disabled = false): HTMLButtonElement {\r\n    const button = document.createElement('button')\r\n    button.className = 'table-toolbar-btn'\r\n    button.title = title\r\n    button.innerHTML = ICONS[icon as keyof typeof ICONS] || ''\r\n    button.disabled = disabled\r\n    button.onclick = (e) => {\r\n      e.stopPropagation()\r\n      onClick()\r\n    }\r\n    return button\r\n  }\r\n\r\n  /**\r\n   * 创建颜色选择下拉\r\n   */\r\n  private createColorDropdown(): HTMLElement {\r\n    const dropdown = document.createElement('div')\r\n    dropdown.className = 'table-toolbar-dropdown'\r\n\r\n    const button = document.createElement('button')\r\n    button.className = 'table-toolbar-btn'\r\n    button.title = '背景颜色'\r\n    button.innerHTML = ICONS.bgColor\r\n    \r\n    const menu = document.createElement('div')\r\n    menu.className = 'table-toolbar-dropdown-menu'\r\n    menu.style.display = 'none'\r\n\r\n    const colorPicker = document.createElement('div')\r\n    colorPicker.className = 'table-toolbar-color-picker'\r\n\r\n    PRESET_COLORS.forEach(color => {\r\n      const colorBtn = document.createElement('button')\r\n      colorBtn.className = 'table-toolbar-color-btn'\r\n      colorBtn.style.background = color\r\n      colorBtn.title = color\r\n      colorBtn.onclick = (e) => {\r\n        e.stopPropagation()\r\n        this.setCellBackground(color)\r\n        menu.style.display = 'none'\r\n      }\r\n      colorPicker.appendChild(colorBtn)\r\n    })\r\n\r\n    menu.appendChild(colorPicker)\r\n    dropdown.appendChild(button)\r\n    dropdown.appendChild(menu)\r\n\r\n    button.onclick = (e) => {\r\n      e.stopPropagation()\r\n      menu.style.display = menu.style.display === 'none' ? 'block' : 'none'\r\n    }\r\n\r\n    return dropdown\r\n  }\r\n\r\n  /**\r\n   * 创建边框样式下拉\r\n   */\r\n  private createBorderDropdown(): HTMLElement {\r\n    const dropdown = document.createElement('div')\r\n    dropdown.className = 'table-toolbar-dropdown'\r\n\r\n    const button = document.createElement('button')\r\n    button.className = 'table-toolbar-btn'\r\n    button.title = '边框样式'\r\n    button.innerHTML = ICONS.borderStyle\r\n\r\n    const menu = document.createElement('div')\r\n    menu.className = 'table-toolbar-dropdown-menu'\r\n    menu.style.display = 'none'\r\n\r\n    BORDER_STYLES.forEach(style => {\r\n      const item = document.createElement('button')\r\n      item.className = 'table-toolbar-dropdown-item'\r\n      item.textContent = style.label\r\n      item.onclick = (e) => {\r\n        e.stopPropagation()\r\n        this.setCellBorder(style.value)\r\n        menu.style.display = 'none'\r\n      }\r\n      menu.appendChild(item)\r\n    })\r\n\r\n    dropdown.appendChild(button)\r\n    dropdown.appendChild(menu)\r\n\r\n    button.onclick = (e) => {\r\n      e.stopPropagation()\r\n      menu.style.display = menu.style.display === 'none' ? 'block' : 'none'\r\n    }\r\n\r\n    return dropdown\r\n  }\r\n\r\n  /**\r\n   * 创建对齐方式下拉\r\n   */\r\n  private createAlignDropdown(): HTMLElement {\r\n    const dropdown = document.createElement('div')\r\n    dropdown.className = 'table-toolbar-dropdown'\r\n\r\n    const button = document.createElement('button')\r\n    button.className = 'table-toolbar-btn'\r\n    button.title = '对齐方式'\r\n    button.innerHTML = ICONS.alignLeft\r\n\r\n    const menu = document.createElement('div')\r\n    menu.className = 'table-toolbar-dropdown-menu'\r\n    menu.style.display = 'none'\r\n\r\n    const alignments = [\r\n      { icon: 'alignLeft', value: 'left', label: '左对齐' },\r\n      { icon: 'alignCenter', value: 'center', label: '居中对齐' },\r\n      { icon: 'alignRight', value: 'right', label: '右对齐' },\r\n    ]\r\n\r\n    alignments.forEach(align => {\r\n      const item = document.createElement('button')\r\n      item.className = 'table-toolbar-dropdown-item'\r\n      item.innerHTML = `${ICONS[align.icon as keyof typeof ICONS]}<span>${align.label}</span>`\r\n      item.onclick = (e) => {\r\n        e.stopPropagation()\r\n        this.setCellAlign(align.value)\r\n        menu.style.display = 'none'\r\n      }\r\n      menu.appendChild(item)\r\n    })\r\n\r\n    dropdown.appendChild(button)\r\n    dropdown.appendChild(menu)\r\n\r\n    button.onclick = (e) => {\r\n      e.stopPropagation()\r\n      menu.style.display = menu.style.display === 'none' ? 'block' : 'none'\r\n    }\r\n\r\n    return dropdown\r\n  }\r\n\r\n  /**\r\n   * 添加行\r\n   */\r\n  private addRow(position: 'above' | 'below') {\r\n    if (!this.currentCell || !this.currentTable) return\r\n\r\n    const row = this.currentCell.parentElement as HTMLTableRowElement\r\n    const rowIndex = row.rowIndex\r\n    const colCount = row.cells.length\r\n\r\n    const newRow = this.currentTable.insertRow(position === 'above' ? rowIndex : rowIndex + 1)\r\n    \r\n    for (let i = 0; i < colCount; i++) {\r\n      const cell = newRow.insertCell()\r\n      cell.innerHTML = '&nbsp;'\r\n      cell.style.border = '1px solid #ddd'\r\n      cell.style.padding = '8px'\r\n      cell.setAttribute('contenteditable', 'true')\r\n    }\r\n\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 添加列\r\n   */\r\n  private addColumn(position: 'left' | 'right') {\r\n    if (!this.currentCell || !this.currentTable) return\r\n\r\n    const cellIndex = this.currentCell.cellIndex\r\n    const insertIndex = position === 'left' ? cellIndex : cellIndex + 1\r\n\r\n    for (let i = 0; i < this.currentTable.rows.length; i++) {\r\n      const row = this.currentTable.rows[i]\r\n      const cell = row.insertCell(insertIndex)\r\n      \r\n      // 判断是表头还是表体\r\n      const isHeader = row.parentElement?.tagName === 'THEAD'\r\n      \r\n      if (isHeader) {\r\n        const th = document.createElement('th')\r\n        th.textContent = `列 ${insertIndex + 1}`\r\n        th.style.border = '1px solid #ddd'\r\n        th.style.padding = '8px'\r\n        th.style.backgroundColor = '#f5f5f5'\r\n        th.setAttribute('contenteditable', 'true')\r\n        cell.replaceWith(th)\r\n      } else {\r\n        cell.innerHTML = '&nbsp;'\r\n        cell.style.border = '1px solid #ddd'\r\n        cell.style.padding = '8px'\r\n        cell.setAttribute('contenteditable', 'true')\r\n      }\r\n    }\r\n\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 删除行\r\n   */\r\n  private deleteRow() {\r\n    if (!this.currentCell || !this.currentTable) return\r\n\r\n    const row = this.currentCell.parentElement as HTMLTableRowElement\r\n    \r\n    // 至少保留一行\r\n    if (this.currentTable.rows.length <= 1) {\r\n      alert('表格至少需要保留一行')\r\n      return\r\n    }\r\n\r\n    row.remove()\r\n    this.hideToolbar()\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 删除列\r\n   */\r\n  private deleteColumn() {\r\n    if (!this.currentCell || !this.currentTable) return\r\n\r\n    const cellIndex = this.currentCell.cellIndex\r\n    \r\n    // 至少保留一列\r\n    if (this.currentTable.rows[0].cells.length <= 1) {\r\n      alert('表格至少需要保留一列')\r\n      return\r\n    }\r\n\r\n    for (let i = 0; i < this.currentTable.rows.length; i++) {\r\n      this.currentTable.rows[i].deleteCell(cellIndex)\r\n    }\r\n\r\n    this.hideToolbar()\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 删除表格\r\n   */\r\n  private deleteTable() {\r\n    if (!this.currentTable) return\r\n\r\n    const wrapper = this.currentTable.closest('.table-wrapper')\r\n    if (wrapper) {\r\n      wrapper.remove()\r\n    } else {\r\n      this.currentTable.remove()\r\n    }\r\n\r\n    this.hideToolbar()\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 合并单元格\r\n   */\r\n  private mergeCells() {\r\n    if (this.selectedCells.length < 2) return\r\n\r\n    // 获取选中区域的范围\r\n    let minRow = Infinity, maxRow = -1, minCol = Infinity, maxCol = -1\r\n    \r\n    this.selectedCells.forEach(cell => {\r\n      const row = (cell.parentElement as HTMLTableRowElement).rowIndex\r\n      const col = cell.cellIndex\r\n      minRow = Math.min(minRow, row)\r\n      maxRow = Math.max(maxRow, row)\r\n      minCol = Math.min(minCol, col)\r\n      maxCol = Math.max(maxCol, col)\r\n    })\r\n\r\n    const table = this.currentTable\r\n    if (!table) return\r\n\r\n    // 获取第一个单元格\r\n    const firstCell = table.rows[minRow].cells[minCol]\r\n    \r\n    // 收集所有内容\r\n    let content = ''\r\n    this.selectedCells.forEach(cell => {\r\n      const text = cell.textContent?.trim()\r\n      if (text && text !== '\\u00A0') {\r\n        content += (content ? ' ' : '') + text\r\n      }\r\n    })\r\n\r\n    // 设置合并\r\n    firstCell.rowSpan = maxRow - minRow + 1\r\n    firstCell.colSpan = maxCol - minCol + 1\r\n    firstCell.textContent = content || '\\u00A0'\r\n\r\n    // 删除其他单元格\r\n    for (let i = minRow; i <= maxRow; i++) {\r\n      const row = table.rows[i]\r\n      for (let j = maxCol; j >= minCol; j--) {\r\n        if (i === minRow && j === minCol) continue\r\n        const cell = row.cells[j]\r\n        if (cell) cell.remove()\r\n      }\r\n    }\r\n\r\n    this.clearSelection()\r\n    this.selectCell(firstCell, table)\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 拆分单元格\r\n   */\r\n  private splitCell() {\r\n    if (!this.currentCell || !this.currentTable) return\r\n\r\n    const rowSpan = this.currentCell.rowSpan || 1\r\n    const colSpan = this.currentCell.colSpan || 1\r\n\r\n    if (rowSpan === 1 && colSpan === 1) {\r\n      alert('该单元格未合并，无法拆分')\r\n      return\r\n    }\r\n\r\n    const startRow = (this.currentCell.parentElement as HTMLTableRowElement).rowIndex\r\n    const startCol = this.currentCell.cellIndex\r\n    const content = this.currentCell.textContent\r\n\r\n    // 重置当前单元格\r\n    this.currentCell.rowSpan = 1\r\n    this.currentCell.colSpan = 1\r\n\r\n    // 创建新单元格\r\n    for (let i = 0; i < rowSpan; i++) {\r\n      const row = this.currentTable.rows[startRow + i]\r\n      const insertAt = i === 0 ? startCol + 1 : startCol\r\n\r\n      for (let j = (i === 0 ? 1 : 0); j < colSpan; j++) {\r\n        const cell = row.insertCell(insertAt + j)\r\n        cell.innerHTML = '&nbsp;'\r\n        cell.style.border = '1px solid #ddd'\r\n        cell.style.padding = '8px'\r\n        cell.setAttribute('contenteditable', 'true')\r\n      }\r\n    }\r\n\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 设置单元格背景色\r\n   */\r\n  private setCellBackground(color: string) {\r\n    const cells = this.selectedCells.length > 0 ? this.selectedCells : (this.currentCell ? [this.currentCell] : [])\r\n    cells.forEach(cell => {\r\n      cell.style.backgroundColor = color\r\n    })\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 设置单元格边框\r\n   */\r\n  private setCellBorder(style: string) {\r\n    const cells = this.selectedCells.length > 0 ? this.selectedCells : (this.currentCell ? [this.currentCell] : [])\r\n    cells.forEach(cell => {\r\n      if (style === 'none') {\r\n        cell.style.border = 'none'\r\n      } else {\r\n        cell.style.border = `1px ${style} #ddd`\r\n      }\r\n    })\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 设置单元格对齐\r\n   */\r\n  private setCellAlign(align: string) {\r\n    const cells = this.selectedCells.length > 0 ? this.selectedCells : (this.currentCell ? [this.currentCell] : [])\r\n    cells.forEach(cell => {\r\n      cell.style.textAlign = align\r\n    })\r\n    this.triggerUpdate()\r\n  }\r\n\r\n  /**\r\n   * 触发编辑器更新\r\n   */\r\n  private triggerUpdate() {\r\n    const editorContent = document.querySelector('.ldesign-editor-content')\r\n    if (editorContent) {\r\n      const event = new Event('input', { bubbles: true })\r\n      editorContent.dispatchEvent(event)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 销毁\r\n   */\r\n  destroy() {\r\n    this.hideToolbar()\r\n  }\r\n}\r\n\r\n// 工具栏实例\r\nlet tableToolbarInstance: TableToolbar | null = null\r\n\r\n/**\r\n * 表格工具栏插件\r\n */\r\nexport const TableToolbarPlugin: Plugin = createPlugin({\r\n  name: 'tableToolbar',\r\n  init: () => {\r\n    if (!tableToolbarInstance) {\r\n      tableToolbarInstance = new TableToolbar()\r\n    }\r\n  },\r\n  destroy: () => {\r\n    if (tableToolbarInstance) {\r\n      tableToolbarInstance.destroy()\r\n      tableToolbarInstance = null\r\n    }\r\n  },\r\n})\r\n"],"names":["TOOLBAR_STYLES","ICONS","addRowAbove","addRowBelow","addColLeft","addColRight","deleteRow","deleteCol","deleteTable","mergeCells","splitCell","bgColor","borderStyle","alignLeft","alignCenter","alignRight","more","PRESET_COLORS","BORDER_STYLES","value","label","TableToolbar","constructor","toolbar","currentTable","currentCell","selectedCells","isSelecting","startCell","styleInjected","injectStyles","setupEventListeners","styleId","document","getElementById","style","createElement","id","textContent","head","appendChild","addEventListener","e","target","cell","closest","table","selectCell","hideToolbar","shiftKey","preventDefault","selectRange","key","clearSelection","classList","add","showToolbar","start","end","startRow","parentElement","rowIndex","endRow","startCol","cellIndex","endCol","minRow","Math","min","maxRow","max","minCol","maxCol","i","row","rows","j","cells","push","forEach","remove","createToolbar","body","positionToolbar","rect","getBoundingClientRect","toolbarRect","top","height","left","width","bottom","window","innerWidth","scrollY","scrollX","className","rowColGroup","createButton","addRow","addColumn","deleteGroup","deleteColumn","mergeGroup","length","styleGroup","createColorDropdown","createBorderDropdown","createAlignDropdown","icon","title","onClick","disabled","button","innerHTML","onclick","stopPropagation","dropdown","menu","display","colorPicker","color","colorBtn","background","setCellBackground","item","setCellBorder","alignments","align","setCellAlign","position","colCount","newRow","insertRow","insertCell","border","padding","setAttribute","triggerUpdate","insertIndex","isHeader","tagName","th","backgroundColor","replaceWith","alert","deleteCell","wrapper","Infinity","col","firstCell","content","text","trim","rowSpan","colSpan","insertAt","textAlign","editorContent","querySelector","event","Event","bubbles","dispatchEvent","destroy","tableToolbarInstance","TableToolbarPlugin","createPlugin","name","init"],"mappings":"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"}