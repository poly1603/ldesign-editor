{"version":3,"file":"index.cjs","sources":["../../../src/plugins/codeblock/index.ts"],"sourcesContent":["/**\r\n * 代码块插件\r\n */\r\n\r\nimport type { Command, Plugin } from '../../types'\r\nimport { createPlugin } from '../../core/Plugin'\r\nimport { showCodeBlockDialog } from '../../ui/CodeBlockDialog'\r\n\r\n// 扩展 Window 类型\r\ndeclare global {\r\n  interface Window {\r\n    CodeMirror?: any\r\n  }\r\n}\r\n\r\n// 代码编辑器主题配置\r\nconst CODE_THEMES = {\r\n  oneDark: {\r\n    name: 'One Dark',\r\n    background: '#282c34',\r\n    color: '#abb2bf',\r\n    border: '#3a3f4a',\r\n    lineNumber: '#5c6370',\r\n    lineNumberBg: '#21252b',\r\n  },\r\n  vsLight: {\r\n    name: 'VS Light',\r\n    background: '#ffffff',\r\n    color: '#000000',\r\n    border: '#e5e7eb',\r\n    lineNumber: '#6b7280',\r\n    lineNumberBg: '#f9fafb',\r\n  },\r\n  monokai: {\r\n    name: 'Monokai',\r\n    background: '#272822',\r\n    color: '#f8f8f2',\r\n    border: '#49483e',\r\n    lineNumber: '#75715e',\r\n    lineNumberBg: '#1e1f1c',\r\n  },\r\n  dracula: {\r\n    name: 'Dracula',\r\n    background: '#282a36',\r\n    color: '#f8f8f2',\r\n    border: '#44475a',\r\n    lineNumber: '#6272a4',\r\n    lineNumberBg: '#1e1f29',\r\n  },\r\n}\r\n\r\n// 不再需要内置的对话框代码，已移至 CodeBlockDialog.ts\r\n\r\n/**\r\n * 应用语法高亮\r\n */\r\nfunction applySyntaxHighlighting(codeElement: HTMLElement, language: string) {\r\n  const code = codeElement.textContent || ''\r\n\r\n  // 基础的语法高亮规则\r\n  const highlighters: Record<string, (code: string) => string> = {\r\n    javascript: highlightJavaScript,\r\n    typescript: highlightJavaScript, // TypeScript uses similar highlighting\r\n    python: highlightPython,\r\n    html: highlightHTML,\r\n    css: highlightCSS,\r\n    json: highlightJSON,\r\n    sql: highlightSQL,\r\n    java: highlightJava,\r\n    cpp: highlightCpp,\r\n    csharp: highlightCSharp,\r\n    c: highlightCpp, // C uses similar highlighting to C++\r\n    php: highlightJavaScript, // PHP uses similar highlighting for now\r\n    ruby: highlightPython, // Ruby uses similar highlighting for now\r\n    go: highlightJavaScript, // Go uses similar highlighting for now\r\n    rust: highlightJavaScript, // Rust uses similar highlighting for now\r\n    swift: highlightJavaScript, // Swift uses similar highlighting for now\r\n    kotlin: highlightJava, // Kotlin uses similar highlighting to Java\r\n    yaml: highlightJSON, // YAML uses similar highlighting to JSON\r\n    bash: highlightBash,\r\n    shell: highlightBash,\r\n    sh: highlightBash,\r\n    xml: highlightHTML, // XML uses similar highlighting to HTML\r\n    markdown: highlightMarkdown,\r\n  }\r\n\r\n  // 转换为小写以确保匹配\r\n  const lowerLang = language.toLowerCase()\r\n  const highlighter = highlighters[lowerLang]\r\n\r\n  console.log('[CodeBlock] Language:', language, 'Lowercase:', lowerLang, 'Highlighter found:', !!highlighter)\r\n\r\n  if (highlighter)\r\n    codeElement.innerHTML = highlighter(code)\r\n  else\r\n    console.warn('[CodeBlock] No highlighter found for language:', language)\r\n}\r\n\r\n// JavaScript/TypeScript 高亮\r\nfunction highlightJavaScript(code: string): string {\r\n  // 保存字符串和注释，避免内部内容被高亮\r\n  const strings: string[] = []\r\n  const comments: string[] = []\r\n  let stringIndex = 0\r\n  let commentIndex = 0\r\n\r\n  // 提取字符串\r\n  code = code.replace(/([\"'`])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, (match) => {\r\n    strings.push(match)\r\n    return `__STRING_${stringIndex++}__`\r\n  })\r\n\r\n  // 提取注释\r\n  code = code.replace(/(\\/\\/.*$|\\/\\*[\\s\\S]*?\\*\\/)/gm, (match) => {\r\n    comments.push(match)\r\n    return `__COMMENT_${commentIndex++}__`\r\n  })\r\n\r\n  // 关键字\r\n  const keywords = /\\b(async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|export|extends|finally|for|function|if|import|in|instanceof|let|new|of|return|super|switch|this|throw|try|typeof|var|void|while|with|yield|enum|implements|interface|package|private|protected|public|static|from|as)\\b/g\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600;\">$1</span>')\r\n\r\n  // 内置对象和方法\r\n  const builtins = /\\b(console|window|document|Math|Array|Object|String|Number|Boolean|Date|RegExp|Error|JSON|Promise|Map|Set|Symbol|parseInt|parseFloat|isNaN|isFinite)\\b/g\r\n  code = code.replace(builtins, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // 函数名\r\n  code = code.replace(/(\\w+)(?=\\s*\\()/g, '<span style=\"color: #61afef;\">$1</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?(e[+-]?\\d+)?)\\b/gi, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 操作符\r\n  code = code.replace(/([+\\-*/%=<>!&|^~?:]+)/g, '<span style=\"color: #56b6c2;\">$1</span>')\r\n\r\n  // 还原注释\r\n  for (let i = 0; i < comments.length; i++)\r\n    code = code.replace(`__COMMENT_${i}__`, `<span style=\"color: #5c6370; font-style: italic;\">${escapeHtml(comments[i])}</span>`)\r\n\r\n  // 还原字符串\r\n  for (let i = 0; i < strings.length; i++)\r\n    code = code.replace(`__STRING_${i}__`, `<span style=\"color: #98c379;\">${escapeHtml(strings[i])}</span>`)\r\n\r\n  return code\r\n}\r\n\r\n// Python 高亮\r\nfunction highlightPython(code: string): string {\r\n  // 保存字符串和注释\r\n  const strings: string[] = []\r\n  const comments: string[] = []\r\n  let stringIndex = 0\r\n  let commentIndex = 0\r\n\r\n  // 提取字符串\r\n  code = code.replace(/([\"'])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, (match) => {\r\n    strings.push(match)\r\n    return `__STRING_${stringIndex++}__`\r\n  })\r\n\r\n  // 提取注释\r\n  code = code.replace(/(#.*$)/gm, (match) => {\r\n    comments.push(match)\r\n    return `__COMMENT_${commentIndex++}__`\r\n  })\r\n\r\n  // 关键字\r\n  const keywords = /\\b(and|as|assert|break|class|continue|def|del|elif|else|except|False|finally|for|from|global|if|import|in|is|lambda|None|nonlocal|not|or|pass|raise|return|True|try|while|with|yield)\\b/g\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600;\">$1</span>')\r\n\r\n  // 内置函数\r\n  const builtins = /\\b(print|len|range|int|float|str|list|dict|set|tuple|bool|input|open|file|abs|all|any|bin|chr|dir|eval|exec|filter|format|help|hex|id|map|max|min|oct|ord|pow|round|sorted|sum|type|zip)\\b/g\r\n  code = code.replace(builtins, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // 函数名\r\n  code = code.replace(/def\\s+(\\w+)/g, 'def <span style=\"color: #61afef;\">$1</span>')\r\n  code = code.replace(/(\\w+)(?=\\s*\\()/g, '<span style=\"color: #61afef;\">$1</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?(e[+-]?\\d+)?)\\b/gi, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 还原注释\r\n  for (let i = 0; i < comments.length; i++)\r\n    code = code.replace(`__COMMENT_${i}__`, `<span style=\"color: #5c6370; font-style: italic;\">${escapeHtml(comments[i])}</span>`)\r\n\r\n  // 还原字符串\r\n  for (let i = 0; i < strings.length; i++)\r\n    code = code.replace(`__STRING_${i}__`, `<span style=\"color: #98c379;\">${escapeHtml(strings[i])}</span>`)\r\n\r\n  return code\r\n}\r\n\r\n// HTML 高亮\r\nfunction highlightHTML(code: string): string {\r\n  // HTML标签\r\n  code = code.replace(/(&lt;\\/?)(\\w+)(.*?)(&gt;)/g, (match, open, tag, attrs, close) => {\r\n    let highlighted = `<span style=\"color: #56b6c2;\">${open}</span>`\r\n    highlighted += `<span style=\"color: #e06c75;\">${tag}</span>`\r\n\r\n    // 高亮属性\r\n    if (attrs) {\r\n      attrs = attrs.replace(/(\\w+)(=)([\"'])(.*?)\\3/g, '<span style=\"color: #d19a66;\">$1</span><span style=\"color: #56b6c2;\">$2</span><span style=\"color: #98c379;\">$3$4$3</span>')\r\n      highlighted += attrs\r\n    }\r\n\r\n    highlighted += `<span style=\"color: #56b6c2;\">${close}</span>`\r\n    return highlighted\r\n  })\r\n\r\n  // HTML注释\r\n  code = code.replace(/(&lt;!--[\\s\\S]*?--&gt;)/g, '<span style=\"color: #5c6370; font-style: italic;\">$1</span>')\r\n\r\n  return code\r\n}\r\n\r\n// CSS 高亮\r\nfunction highlightCSS(code: string): string {\r\n  // CSS选择器\r\n  code = code.replace(/([.#]?[\\w-]+)(?=\\s*\\{)/g, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // CSS属性\r\n  code = code.replace(/([\\w-]+)(?=\\s*:)/g, '<span style=\"color: #61afef;\">$1</span>')\r\n\r\n  // CSS值\r\n  code = code.replace(/:\\s*([^;]+)/g, ': <span style=\"color: #98c379;\">$1</span>')\r\n\r\n  // 注释\r\n  code = code.replace(/(\\/\\*[\\s\\S]*?\\*\\/)/g, '<span style=\"color: #5c6370; font-style: italic;\">$1</span>')\r\n\r\n  return code\r\n}\r\n\r\n// JSON 高亮\r\nfunction highlightJSON(code: string): string {\r\n  // 属性名\r\n  code = code.replace(/\"([^\"]+)\"(?=\\s*:)/g, '<span style=\"color: #e06c75;\">\"$1\"</span>')\r\n\r\n  // 字符串值\r\n  code = code.replace(/:\\s*\"([^\"]*)\"/g, ': <span style=\"color: #98c379;\">\"$1\"</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?(e[+-]?\\d+)?)\\b/gi, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 布尔值和null\r\n  code = code.replace(/\\b(true|false|null)\\b/g, '<span style=\"color: #56b6c2;\">$1</span>')\r\n\r\n  return code\r\n}\r\n\r\n// SQL 高亮\r\nfunction highlightSQL(code: string): string {\r\n  // SQL关键字\r\n  const keywords = /\\b(SELECT|FROM|WHERE|JOIN|LEFT|RIGHT|INNER|OUTER|ON|AS|INSERT|INTO|VALUES|UPDATE|SET|DELETE|CREATE|TABLE|DROP|ALTER|ADD|COLUMN|PRIMARY|KEY|FOREIGN|REFERENCES|INDEX|UNIQUE|NOT|NULL|DEFAULT|AUTO_INCREMENT|ORDER|BY|GROUP|HAVING|LIMIT|OFFSET|UNION|ALL|DISTINCT|COUNT|SUM|AVG|MIN|MAX|CASE|WHEN|THEN|ELSE|END|AND|OR|IN|EXISTS|BETWEEN|LIKE|IS)\\b/gi\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600; text-transform: uppercase;\">$1</span>')\r\n\r\n  // 字符串\r\n  code = code.replace(/([\"'])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, '<span style=\"color: #98c379;\">$&</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?)\\b/g, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 注释\r\n  code = code.replace(/(--.*$)/gm, '<span style=\"color: #5c6370; font-style: italic;\">$1</span>')\r\n\r\n  return code\r\n}\r\n\r\n// Java 高亮\r\nfunction highlightJava(code: string): string {\r\n  // 保存字符串和注释\r\n  const strings: string[] = []\r\n  const comments: string[] = []\r\n  let stringIndex = 0\r\n  let commentIndex = 0\r\n\r\n  // 提取字符串\r\n  code = code.replace(/([\"'])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, (match) => {\r\n    strings.push(match)\r\n    return `__STRING_${stringIndex++}__`\r\n  })\r\n\r\n  // 提取注释\r\n  code = code.replace(/(\\/\\/.*$|\\/\\*[\\s\\S]*?\\*\\/)/gm, (match) => {\r\n    comments.push(match)\r\n    return `__COMMENT_${commentIndex++}__`\r\n  })\r\n\r\n  // 关键字\r\n  const keywords = /\\b(abstract|assert|boolean|break|byte|case|catch|char|class|const|continue|default|do|double|else|enum|extends|final|finally|float|for|if|goto|implements|import|instanceof|int|interface|long|native|new|package|private|protected|public|return|short|static|strictfp|super|switch|synchronized|this|throw|throws|transient|try|void|volatile|while)\\b/g\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600;\">$1</span>')\r\n\r\n  // 类型\r\n  code = code.replace(/\\b(String|Integer|Double|Float|Boolean|Character|Byte|Short|Long|Object|Class|System|Math|Thread|Exception|RuntimeException)\\b/g, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // 函数名\r\n  code = code.replace(/(\\w+)(?=\\s*\\()/g, '<span style=\"color: #61afef;\">$1</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?[fld]?)\\b/gi, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 还原注释\r\n  for (let i = 0; i < comments.length; i++)\r\n    code = code.replace(`__COMMENT_${i}__`, `<span style=\"color: #5c6370; font-style: italic;\">${escapeHtml(comments[i])}</span>`)\r\n\r\n  // 还原字符串\r\n  for (let i = 0; i < strings.length; i++)\r\n    code = code.replace(`__STRING_${i}__`, `<span style=\"color: #98c379;\">${escapeHtml(strings[i])}</span>`)\r\n\r\n  return code\r\n}\r\n\r\n// C++ 高亮\r\nfunction highlightCpp(code: string): string {\r\n  // 保存字符串和注释\r\n  const strings: string[] = []\r\n  const comments: string[] = []\r\n  let stringIndex = 0\r\n  let commentIndex = 0\r\n\r\n  // 提取字符串\r\n  code = code.replace(/([\"'])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, (match) => {\r\n    strings.push(match)\r\n    return `__STRING_${stringIndex++}__`\r\n  })\r\n\r\n  // 提取注释\r\n  code = code.replace(/(\\/\\/.*$|\\/\\*[\\s\\S]*?\\*\\/)/gm, (match) => {\r\n    comments.push(match)\r\n    return `__COMMENT_${commentIndex++}__`\r\n  })\r\n\r\n  // 关键字\r\n  const keywords = /\\b(alignas|alignof|and|and_eq|asm|auto|bitand|bitor|bool|break|case|catch|char|char16_t|char32_t|class|compl|const|constexpr|const_cast|continue|decltype|default|delete|do|double|dynamic_cast|else|enum|explicit|export|extern|false|float|for|friend|goto|if|inline|int|long|mutable|namespace|new|noexcept|not|not_eq|nullptr|operator|or|or_eq|private|protected|public|register|reinterpret_cast|return|short|signed|sizeof|static|static_assert|static_cast|struct|switch|template|this|thread_local|throw|true|try|typedef|typeid|typename|union|unsigned|using|virtual|void|volatile|wchar_t|while|xor|xor_eq)\\b/g\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600;\">$1</span>')\r\n\r\n  // 预处理指令\r\n  code = code.replace(/(#\\w+)/g, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // 函数名\r\n  code = code.replace(/(\\w+)(?=\\s*\\()/g, '<span style=\"color: #61afef;\">$1</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?[flu]?)\\b/gi, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 还原注释\r\n  for (let i = 0; i < comments.length; i++)\r\n    code = code.replace(`__COMMENT_${i}__`, `<span style=\"color: #5c6370; font-style: italic;\">${escapeHtml(comments[i])}</span>`)\r\n\r\n  // 还原字符串\r\n  for (let i = 0; i < strings.length; i++)\r\n    code = code.replace(`__STRING_${i}__`, `<span style=\"color: #98c379;\">${escapeHtml(strings[i])}</span>`)\r\n\r\n  return code\r\n}\r\n\r\n// C# 高亮\r\nfunction highlightCSharp(code: string): string {\r\n  // 保存字符串和注释\r\n  const strings: string[] = []\r\n  const comments: string[] = []\r\n  let stringIndex = 0\r\n  let commentIndex = 0\r\n\r\n  // 提取字符串\r\n  code = code.replace(/([\"'])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, (match) => {\r\n    strings.push(match)\r\n    return `__STRING_${stringIndex++}__`\r\n  })\r\n\r\n  // 提取注释\r\n  code = code.replace(/(\\/\\/.*$|\\/\\*[\\s\\S]*?\\*\\/)/gm, (match) => {\r\n    comments.push(match)\r\n    return `__COMMENT_${commentIndex++}__`\r\n  })\r\n\r\n  // 关键字\r\n  const keywords = /\\b(abstract|as|base|bool|break|byte|case|catch|char|checked|class|const|continue|decimal|default|delegate|do|double|else|enum|event|explicit|extern|false|finally|fixed|float|for|foreach|goto|if|implicit|in|int|interface|internal|is|lock|long|namespace|new|null|object|operator|out|override|params|private|protected|public|readonly|ref|return|sbyte|sealed|short|sizeof|stackalloc|static|string|struct|switch|this|throw|true|try|typeof|uint|ulong|unchecked|unsafe|ushort|using|var|virtual|void|volatile|while)\\b/g\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600;\">$1</span>')\r\n\r\n  // 类型\r\n  code = code.replace(/\\b(String|Int32|Int64|Double|Float|Boolean|Char|Byte|Object|Decimal|DateTime|TimeSpan|Guid|Array|List|Dictionary|Task|Action|Func)\\b/g, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // 函数名\r\n  code = code.replace(/(\\w+)(?=\\s*\\()/g, '<span style=\"color: #61afef;\">$1</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+(\\.\\d+)?[fmd]?)\\b/gi, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 还原注释\r\n  for (let i = 0; i < comments.length; i++)\r\n    code = code.replace(`__COMMENT_${i}__`, `<span style=\"color: #5c6370; font-style: italic;\">${escapeHtml(comments[i])}</span>`)\r\n\r\n  // 还原字符串\r\n  for (let i = 0; i < strings.length; i++)\r\n    code = code.replace(`__STRING_${i}__`, `<span style=\"color: #98c379;\">${escapeHtml(strings[i])}</span>`)\r\n\r\n  return code\r\n}\r\n\r\n// Bash/Shell 高亮\r\nfunction highlightBash(code: string): string {\r\n  // 保存字符串和注释\r\n  const strings: string[] = []\r\n  const comments: string[] = []\r\n  let stringIndex = 0\r\n  let commentIndex = 0\r\n\r\n  // 提取字符串\r\n  code = code.replace(/([\"'`])(?:(?=(\\\\?))\\2[\\s\\S])*?\\1/g, (match) => {\r\n    strings.push(match)\r\n    return `__STRING_${stringIndex++}__`\r\n  })\r\n\r\n  // 提取注释\r\n  code = code.replace(/(#.*$)/gm, (match) => {\r\n    comments.push(match)\r\n    return `__COMMENT_${commentIndex++}__`\r\n  })\r\n\r\n  // 关键字\r\n  const keywords = /\\b(if|then|else|elif|fi|for|do|done|while|until|case|esac|function|return|break|continue|exit|export|source|alias|echo|read|cd|ls|mkdir|rm|cp|mv|cat|grep|sed|awk|find|chmod|chown|sudo|apt|yum|npm|git|docker|kubectl)\\b/g\r\n  code = code.replace(keywords, '<span style=\"color: #c678dd; font-weight: 600;\">$1</span>')\r\n\r\n  // 变量\r\n  code = code.replace(/(\\$\\w+|\\$\\{[^}]+\\})/g, '<span style=\"color: #e06c75;\">$1</span>')\r\n\r\n  // 数字\r\n  code = code.replace(/\\b(\\d+)\\b/g, '<span style=\"color: #d19a66;\">$1</span>')\r\n\r\n  // 还原注释\r\n  for (let i = 0; i < comments.length; i++)\r\n    code = code.replace(`__COMMENT_${i}__`, `<span style=\"color: #5c6370; font-style: italic;\">${escapeHtml(comments[i])}</span>`)\r\n\r\n  // 还原字符串\r\n  for (let i = 0; i < strings.length; i++)\r\n    code = code.replace(`__STRING_${i}__`, `<span style=\"color: #98c379;\">${escapeHtml(strings[i])}</span>`)\r\n\r\n  return code\r\n}\r\n\r\n// Markdown 高亮\r\nfunction highlightMarkdown(code: string): string {\r\n  // 代码块\r\n  code = code.replace(/```[\\s\\S]*?```/g, (match) => {\r\n    return `<span style=\"color: #98c379; background: rgba(0,0,0,0.2); padding: 2px 4px; border-radius: 3px;\">${escapeHtml(match)}</span>`\r\n  })\r\n\r\n  // 内联代码\r\n  code = code.replace(/`[^`]+`/g, (match) => {\r\n    return `<span style=\"color: #98c379; background: rgba(0,0,0,0.2); padding: 2px 4px; border-radius: 3px;\">${escapeHtml(match)}</span>`\r\n  })\r\n\r\n  // 标题\r\n  code = code.replace(/^(#{1,6})\\s+(.*)$/gm, (match, hashes, title) => {\r\n    return `<span style=\"color: #e06c75; font-weight: 600;\">${escapeHtml(hashes)}</span> <span style=\"color: #61afef; font-weight: 600;\">${escapeHtml(title)}</span>`\r\n  })\r\n\r\n  // 链接\r\n  code = code.replace(/\\[([^\\]]+)\\]\\(([^)]+)\\)/g, (match, text, url) => {\r\n    return `<span style=\"color: #61afef;\">[${escapeHtml(text)}]</span><span style=\"color: #56b6c2;\">(${escapeHtml(url)})</span>`\r\n  })\r\n\r\n  // 加粗\r\n  code = code.replace(/\\*\\*([^*]+)\\*\\*|__([^_]+)__/g, (match, bold1, bold2) => {\r\n    const text = bold1 || bold2\r\n    return `<span style=\"color: #d19a66; font-weight: 600;\">${escapeHtml(match)}</span>`\r\n  })\r\n\r\n  // 斜体\r\n  code = code.replace(/\\*([^*]+)\\*|_([^_]+)_/g, (match) => {\r\n    return `<span style=\"color: #d19a66; font-style: italic;\">${escapeHtml(match)}</span>`\r\n  })\r\n\r\n  // 列表\r\n  code = code.replace(/^(\\s*[-*+]|\\s*\\d+\\.)\\s+/gm, (match) => {\r\n    return `<span style=\"color: #c678dd;\">${escapeHtml(match)}</span>`\r\n  })\r\n\r\n  return code\r\n}\r\n\r\n// HTML转义函数\r\nfunction escapeHtml(text: string): string {\r\n  const map: Record<string, string> = {\r\n    '&': '&amp;',\r\n    '<': '&lt;',\r\n    '>': '&gt;',\r\n    '\"': '&quot;',\r\n    '\\'': '&#39;',\r\n  }\r\n  return text.replace(/[&<>\"']/g, m => map[m])\r\n}\r\n\r\n/**\r\n * 插入代码块\r\n */\r\nconst insertCodeBlock: Command = (state, dispatch) => {\r\n  console.log('[CodeBlock] insertCodeBlock called', { state, dispatch })\r\n\r\n  // 保存当前的选区\r\n  const editorContent = document.querySelector('.ldesign-editor-content') as HTMLElement\r\n  if (!editorContent) {\r\n    console.error('[CodeBlock] Editor content not found')\r\n    return false\r\n  }\r\n\r\n  console.log('[CodeBlock] Editor content found', editorContent)\r\n\r\n  const selection = window.getSelection()\r\n  let savedRange: Range | null = null\r\n\r\n  if (selection && selection.rangeCount > 0) {\r\n    const range = selection.getRangeAt(0)\r\n    if (editorContent.contains(range.commonAncestorContainer))\r\n      savedRange = range.cloneRange()\r\n  }\r\n\r\n  // 获取选中的文本（如果有）\r\n  const selectedText = selection?.toString() || ''\r\n\r\n  // 显示代码编辑器对话框（使用统一的对话框组件）\r\n  showCodeBlockDialog({\r\n    selectedText,\r\n    onConfirm: (codeContent, language, theme) => {\r\n    // 恢复焦点到编辑器\r\n      editorContent.focus()\r\n\r\n      // 恢复或创建选区\r\n      const currentSelection = window.getSelection()\r\n      if (!currentSelection)\r\n        return\r\n\r\n      let range: Range\r\n      if (savedRange && currentSelection) {\r\n        range = savedRange\r\n        currentSelection.removeAllRanges()\r\n        currentSelection.addRange(range)\r\n      }\r\n      else {\r\n      // 如果没有保存的选区，在编辑器末尾插入\r\n        range = document.createRange()\r\n        range.selectNodeContents(editorContent)\r\n        range.collapse(false)\r\n        currentSelection.removeAllRanges()\r\n        currentSelection.addRange(range)\r\n      }\r\n\r\n      // 获取选择的主题\r\n      const currentTheme = CODE_THEMES[theme as keyof typeof CODE_THEMES] || CODE_THEMES.oneDark\r\n\r\n      // 创建代码块容器\r\n      const codeBlockContainer = document.createElement('div')\r\n      codeBlockContainer.className = 'code-block-container'\r\n      codeBlockContainer.setAttribute('data-theme', theme)\r\n      codeBlockContainer.style.cssText = `\r\n      position: relative;\r\n      margin: 16px 0;\r\n      border-radius: 8px;\r\n      overflow: hidden;\r\n      background: ${currentTheme.background};\r\n      border: 1px solid ${currentTheme.border};\r\n    `\r\n\r\n      // 创建头部（显示语言和复制按钮）\r\n      const header = document.createElement('div')\r\n      header.style.cssText = `\r\n      display: flex;\r\n      justify-content: space-between;\r\n      align-items: center;\r\n      padding: 8px 16px;\r\n      background: #21252b;\r\n      border-bottom: 1px solid #3a3f4a;\r\n      user-select: none;\r\n    `\r\n\r\n      // 语言标签\r\n      const langLabel = document.createElement('span')\r\n      langLabel.textContent = language && language !== 'plaintext' ? language.toUpperCase() : 'CODE'\r\n      langLabel.style.cssText = `\r\n      font-size: 12px;\r\n      font-weight: 600;\r\n      color: #7f848e;\r\n      letter-spacing: 0.5px;\r\n      text-transform: uppercase;\r\n    `\r\n\r\n      // 复制按钮\r\n      const copyButton = document.createElement('button')\r\n      copyButton.textContent = '复制'\r\n      copyButton.style.cssText = `\r\n      padding: 4px 12px;\r\n      background: rgba(255, 255, 255, 0.1);\r\n      border: 1px solid rgba(255, 255, 255, 0.2);\r\n      border-radius: 4px;\r\n      color: #abb2bf;\r\n      font-size: 12px;\r\n      cursor: pointer;\r\n      transition: all 0.2s;\r\n    `\r\n\r\n      copyButton.onmouseover = () => {\r\n        copyButton.style.background = 'rgba(255, 255, 255, 0.2)'\r\n        copyButton.style.color = '#fff'\r\n      }\r\n\r\n      copyButton.onmouseout = () => {\r\n        copyButton.style.background = 'rgba(255, 255, 255, 0.1)'\r\n        copyButton.style.color = '#abb2bf'\r\n      }\r\n\r\n      copyButton.onclick = () => {\r\n        const codeText = code.textContent || ''\r\n        navigator.clipboard.writeText(codeText).then(() => {\r\n          const originalText = copyButton.textContent\r\n          copyButton.textContent = '已复制！'\r\n          copyButton.style.background = '#4caf50'\r\n          copyButton.style.borderColor = '#4caf50'\r\n          copyButton.style.color = '#fff'\r\n          setTimeout(() => {\r\n            copyButton.textContent = originalText\r\n            copyButton.style.background = 'rgba(255, 255, 255, 0.1)'\r\n            copyButton.style.borderColor = 'rgba(255, 255, 255, 0.2)'\r\n            copyButton.style.color = '#abb2bf'\r\n          }, 2000)\r\n        })\r\n      }\r\n\r\n      header.appendChild(langLabel)\r\n      header.appendChild(copyButton)\r\n\r\n      // 创建代码容器（包含行号和代码）\r\n      const codeWrapper = document.createElement('div')\r\n      codeWrapper.style.cssText = `\r\n      display: flex;\r\n      position: relative;\r\n      overflow: auto;\r\n      max-height: 600px;\r\n    `\r\n\r\n      // 行号容器\r\n      const lineNumbers = document.createElement('div')\r\n      lineNumbers.className = 'line-numbers'\r\n      lineNumbers.style.cssText = `\r\n      padding: 16px 8px;\r\n      background: #21252b;\r\n      color: #5c6370;\r\n      text-align: right;\r\n      user-select: none;\r\n      font-family: Consolas, Monaco, \"Courier New\", monospace;\r\n      font-size: 14px;\r\n      line-height: 1.6;\r\n      min-width: 40px;\r\n      border-right: 1px solid #3a3f4a;\r\n    `\r\n\r\n      // 创建 pre 和 code 元素\r\n      const pre = document.createElement('pre')\r\n      const code = document.createElement('code')\r\n\r\n      // 设置语言类（用于语法高亮）\r\n      if (language && language !== 'plaintext') {\r\n        code.className = `language-${language}`\r\n        pre.setAttribute('data-language', language)\r\n      }\r\n\r\n      // 设置 pre 样式\r\n      pre.style.cssText = `\r\n      margin: 0;\r\n      padding: 16px;\r\n      background: transparent;\r\n      overflow: visible;\r\n      flex: 1;\r\n    `\r\n\r\n      // 设置 code 样式\r\n      code.style.cssText = `\r\n      display: block;\r\n      color: #abb2bf;\r\n      font-family: Consolas, Monaco, \"Courier New\", monospace;\r\n      font-size: 14px;\r\n      line-height: 1.6;\r\n      white-space: pre;\r\n      tab-size: 2;\r\n      outline: none;\r\n    `\r\n\r\n      // 设置代码内容\r\n      code.textContent = codeContent\r\n\r\n      // 应用语法高亮\r\n      if (language && language !== 'plaintext') {\r\n      // 调试信息\r\n        console.log('[CodeBlock] Applying syntax highlighting for language:', language)\r\n        applySyntaxHighlighting(code, language)\r\n      }\r\n\r\n      // 更新行号\r\n      function updateLineNumbers() {\r\n        const lines = (code.textContent || '').split('\\n')\r\n        const lineNumbersHtml = lines.map((_, i) => `<div style=\"line-height: 1.6;\">${i + 1}</div>`).join('')\r\n        lineNumbers.innerHTML = lineNumbersHtml\r\n      }\r\n\r\n      // 初始化行号\r\n      updateLineNumbers()\r\n\r\n      // 使代码可编辑\r\n      code.setAttribute('contenteditable', 'true')\r\n      code.spellcheck = false\r\n\r\n      // 组装代码块\r\n      pre.appendChild(code)\r\n      codeWrapper.appendChild(lineNumbers)\r\n      codeWrapper.appendChild(pre)\r\n      codeBlockContainer.appendChild(header)\r\n      codeBlockContainer.appendChild(codeWrapper)\r\n\r\n      // 处理代码块中的键盘事件\r\n      code.addEventListener('keydown', (e) => {\r\n      // 处理 Enter 键，插入换行符而不是新段落\r\n        if (e.key === 'Enter') {\r\n          e.preventDefault()\r\n          const selection = window.getSelection()\r\n          if (selection && selection.rangeCount > 0) {\r\n            const range = selection.getRangeAt(0)\r\n            const textNode = document.createTextNode('\\n')\r\n            range.deleteContents()\r\n            range.insertNode(textNode)\r\n            range.setStartAfter(textNode)\r\n            range.collapse(true)\r\n            selection.removeAllRanges()\r\n            selection.addRange(range)\r\n          }\r\n          // 更新行号\r\n          setTimeout(updateLineNumbers, 0)\r\n        }\r\n        // 处理 Tab 键，插入制表符\r\n        else if (e.key === 'Tab') {\r\n          e.preventDefault()\r\n          const selection = window.getSelection()\r\n          if (selection && selection.rangeCount > 0) {\r\n            const range = selection.getRangeAt(0)\r\n            const textNode = document.createTextNode('  ') // 使用2个空格代替制表符\r\n            range.deleteContents()\r\n            range.insertNode(textNode)\r\n            range.setStartAfter(textNode)\r\n            range.collapse(true)\r\n            selection.removeAllRanges()\r\n            selection.addRange(range)\r\n          }\r\n        }\r\n      })\r\n\r\n      // 监听内容变化以更新行号\r\n      code.addEventListener('input', () => {\r\n        updateLineNumbers()\r\n      // 暂时禁用实时语法高亮，因为它会干扰编辑\r\n      // 可以考虑在失去焦点时或通过按钮手动触发高亮\r\n      })\r\n\r\n      // 在失去焦点时重新应用语法高亮\r\n      code.addEventListener('blur', () => {\r\n        if (language && language !== 'plaintext') {\r\n          console.log('[CodeBlock] Reapplying syntax highlighting on blur')\r\n          applySyntaxHighlighting(code, language)\r\n        }\r\n      })\r\n\r\n      // 删除选中的内容并插入代码块\r\n      range.deleteContents()\r\n      range.insertNode(codeBlockContainer)\r\n\r\n      // 插入一个段落在代码块后面，以便可以继续编辑\r\n      const p = document.createElement('p')\r\n      p.innerHTML = '<br>'\r\n      if (codeBlockContainer.nextSibling)\r\n        codeBlockContainer.parentNode?.insertBefore(p, codeBlockContainer.nextSibling)\r\n      else\r\n        codeBlockContainer.parentNode?.appendChild(p)\r\n\r\n      // 将光标移到段落中\r\n      const newRange = document.createRange()\r\n      newRange.selectNodeContents(p)\r\n      newRange.collapse(true)\r\n      currentSelection.removeAllRanges()\r\n      currentSelection.addRange(newRange)\r\n\r\n      // 触发输入事件以更新编辑器状态\r\n      setTimeout(() => {\r\n        const event = new Event('input', { bubbles: true, cancelable: true })\r\n        editorContent.dispatchEvent(event)\r\n      }, 0)\r\n    },\r\n  })\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * 检查是否在代码块中\r\n */\r\nfunction isCodeBlockActive() {\r\n  return () => {\r\n    const selection = window.getSelection()\r\n    if (!selection || selection.rangeCount === 0)\r\n      return false\r\n\r\n    let node = selection.anchorNode\r\n    while (node && node !== document.body) {\r\n      if (node.nodeName === 'PRE')\r\n        return true\r\n      node = node.parentNode\r\n    }\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * 代码块插件\r\n */\r\nexport const CodeBlockPlugin: Plugin = createPlugin({\r\n  name: 'codeBlock',\r\n  commands: {\r\n    insertCodeBlock,\r\n  },\r\n  keys: {\r\n    'Mod-Alt-C': insertCodeBlock,\r\n  },\r\n  toolbar: [{\r\n    name: 'codeBlock',\r\n    title: '代码块',\r\n    icon: 'code-xml',\r\n    command: insertCodeBlock,\r\n    active: isCodeBlockActive(),\r\n  }],\r\n})\r\n\r\n// 导出代码块工具栏插件\r\nexport { CodeBlockToolbarPlugin } from './code-toolbar'\r\n"],"names":["CODE_THEMES","oneDark","name","background","color","border","lineNumber","lineNumberBg","vsLight","monokai","dracula","applySyntaxHighlighting","codeElement","language","code","textContent","highlighters","javascript","highlightJavaScript","typescript","python","highlightPython","html","highlightHTML","css","highlightCSS","json","highlightJSON","sql","highlightSQL","java","highlightJava","cpp","highlightCpp","csharp","highlightCSharp","c","php","ruby","go","rust","swift","kotlin","yaml","bash","highlightBash","shell","sh","xml","markdown","highlightMarkdown","lowerLang","toLowerCase","highlighter","console","log","innerHTML","warn","strings","comments","stringIndex","commentIndex","replace","match","push","keywords","builtins","i","length","escapeHtml","open","tag","attrs","close","highlighted","hashes","title","text","url","bold1","bold2","map","m","insertCodeBlock","state","dispatch","editorContent","document","querySelector","error","selection","window","getSelection","savedRange","rangeCount","range","getRangeAt","contains","commonAncestorContainer","cloneRange","selectedText","toString","showCodeBlockDialog","onConfirm","codeContent","theme","focus","currentSelection","removeAllRanges","addRange","createRange","selectNodeContents","collapse","currentTheme","codeBlockContainer","createElement","className","setAttribute","style","cssText","header","langLabel","toUpperCase","copyButton","onmouseover","onmouseout","onclick","codeText","navigator","clipboard","writeText","then","originalText","borderColor","setTimeout","appendChild","codeWrapper","lineNumbers","pre","updateLineNumbers","lines","split","lineNumbersHtml","_","join","spellcheck","addEventListener","e","key","preventDefault","textNode","createTextNode","deleteContents","insertNode","setStartAfter","p","nextSibling","parentNode","insertBefore","newRange","event","Event","bubbles","cancelable","dispatchEvent","isCodeBlockActive","node","anchorNode","body","nodeName","CodeBlockPlugin","createPlugin","commands","keys","toolbar","icon","command","active"],"mappings":"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"}