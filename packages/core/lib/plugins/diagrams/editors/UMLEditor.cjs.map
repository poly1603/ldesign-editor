{"version":3,"file":"UMLEditor.cjs","sources":["../../../../src/plugins/diagrams/editors/UMLEditor.ts"],"sourcesContent":["/**\r\n * UML类图编辑器\r\n */\r\n\r\nimport type { DiagramEditor, UMLData } from '../types'\r\nimport { createLogger } from '../../../utils/logger'\r\n\r\nconst logger = createLogger('UMLEditor')\r\n\r\nexport class UMLEditor implements DiagramEditor {\r\n  private container?: HTMLElement\r\n  private data?: UMLData\r\n  private onSave?: (data: UMLData) => void\r\n  private onCancel?: () => void\r\n\r\n  async render(container: HTMLElement, options: {\r\n    data: UMLData\r\n    onSave: (data: UMLData) => void\r\n    onCancel: () => void\r\n  }): Promise<void> {\r\n    logger.info('Rendering UML editor')\r\n    this.container = container\r\n    this.data = JSON.parse(JSON.stringify(options.data))\r\n    this.onSave = options.onSave\r\n    this.onCancel = options.onCancel\r\n    this.createUI()\r\n  }\r\n\r\n  private createUI(): void {\r\n    if (!this.container || !this.data)\r\n      return\r\n\r\n    this.container.innerHTML = `\r\n      <div style=\"display: flex; flex-direction: column; height: 100%; overflow-y: auto; padding: 20px;\">\r\n        <h4>UML类图编辑器 (简化版)</h4>\r\n        <p style=\"color: #666; font-size: 13px;\">添加类、属性、方法和关系</p>\r\n        \r\n        <div style=\"margin-top: 20px;\">\r\n          ${this.data.classes.map((cls, i) => `\r\n            <div style=\"border: 1px solid #ddd; border-radius: 4px; padding: 15px; margin-bottom: 15px; background: white;\">\r\n              <div style=\"display: flex; justify-content: between; align-items: center; margin-bottom: 10px;\">\r\n                <strong style=\"font-size: 16px;\">${cls.name}</strong>\r\n                <button onclick=\"window.deleteUMLClass(${i})\" style=\"padding: 4px 8px; border: 1px solid #f44336; color: #f44336; border-radius: 4px; cursor: pointer;\">删除</button>\r\n              </div>\r\n              <div style=\"font-size: 13px; color: #666;\">\r\n                <div><strong>属性:</strong> ${cls.attributes.join(', ') || '无'}</div>\r\n                <div><strong>方法:</strong> ${cls.methods.join(', ') || '无'}</div>\r\n              </div>\r\n            </div>\r\n          `).join('')}\r\n          \r\n          <button id=\"addClass\" style=\"padding: 10px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%;\">\r\n            ➕ 添加类\r\n          </button>\r\n        </div>\r\n        \r\n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end; gap: 10px;\">\r\n          <button id=\"cancel\" style=\"padding: 8px 20px; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;\">取消</button>\r\n          <button id=\"save\" style=\"padding: 8px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;\">保存</button>\r\n        </div>\r\n      </div>\r\n    `\r\n\r\n    this.bindEvents()\r\n  }\r\n\r\n  private bindEvents(): void {\r\n    (window as any).deleteUMLClass = (index: number) => {\r\n      if (this.data && confirm('确定删除？')) {\r\n        this.data.classes.splice(index, 1)\r\n        this.createUI()\r\n      }\r\n    }\r\n\r\n    this.container?.querySelector('#addClass')?.addEventListener('click', () => {\r\n      const name = prompt('类名：', 'NewClass')\r\n      if (name && this.data) {\r\n        this.data.classes.push({ name, attributes: [], methods: [] })\r\n        this.createUI()\r\n      }\r\n    })\r\n\r\n    this.container?.querySelector('#save')?.addEventListener('click', () => {\r\n      if (this.onSave && this.data)\r\n        this.onSave(this.data)\r\n    })\r\n    this.container?.querySelector('#cancel')?.addEventListener('click', () => this.onCancel?.())\r\n  }\r\n\r\n  destroy(): void {\r\n    delete (window as any).deleteUMLClass\r\n  }\r\n}\r\n"],"names":["logger","createLogger","UMLEditor","render","container","options","info","data","JSON","parse","stringify","onSave","onCancel","createUI","innerHTML","classes","map","cls","i","name","attributes","join","methods","bindEvents","window","deleteUMLClass","index","confirm","splice","querySelector","addEventListener","prompt","push","destroy"],"mappings":"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"}