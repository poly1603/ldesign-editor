{"version":3,"file":"SequenceDiagramEditor.cjs","sources":["../../../../src/plugins/diagrams/editors/SequenceDiagramEditor.ts"],"sourcesContent":["/**\r\n * 时序图编辑器\r\n */\r\n\r\nimport type { DiagramEditor, SequenceData } from '../types'\r\n\r\nexport class SequenceDiagramEditor implements DiagramEditor {\r\n  private container?: HTMLElement\r\n  private data?: SequenceData\r\n  private onSave?: (data: SequenceData) => void\r\n  private onCancel?: () => void\r\n\r\n  async render(container: HTMLElement, options: {\r\n    data: SequenceData\r\n    onSave: (data: SequenceData) => void\r\n    onCancel: () => void\r\n  }): Promise<void> {\r\n    this.container = container\r\n    this.data = JSON.parse(JSON.stringify(options.data))\r\n    this.onSave = options.onSave\r\n    this.onCancel = options.onCancel\r\n    this.createUI()\r\n  }\r\n\r\n  private createUI(): void {\r\n    if (!this.container || !this.data)\r\n      return\r\n\r\n    this.container.innerHTML = `\r\n      <div style=\"padding: 20px; height: 100%; overflow-y: auto;\">\r\n        <h4>时序图编辑器</h4>\r\n        <div style=\"margin: 20px 0;\">\r\n          <strong>参与者：</strong>\r\n          ${this.data.actors.map((actor, i) => `\r\n            <span style=\"display: inline-block; margin: 5px; padding: 6px 12px; background: #e8f4f8; border-radius: 4px;\">\r\n              ${typeof actor === 'string' ? actor : actor.name}\r\n              <button onclick=\"window.delSeqActor(${i})\" style=\"margin-left: 8px; border: none; background: transparent; cursor: pointer; color: #f44336;\">×</button>\r\n            </span>\r\n          `).join('')}\r\n          <button id=\"addActor\" style=\"margin-left: 10px; padding: 6px 12px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;\">+ 添加</button>\r\n        </div>\r\n        \r\n        <div>\r\n          <strong>消息：</strong>\r\n          <div style=\"margin-top: 10px;\">\r\n            ${this.data.messages.map((msg, i) => `\r\n              <div style=\"padding: 8px; margin-bottom: 8px; background: #f5f5f5; border-radius: 4px; display: flex; justify-content: space-between; align-items: center;\">\r\n                <span>${msg.from} → ${msg.to}: ${msg.text}</span>\r\n                <button onclick=\"window.delSeqMsg(${i})\" style=\"padding: 4px 8px; border: 1px solid #f44336; color: #f44336; border-radius: 4px; cursor: pointer;\">删除</button>\r\n              </div>\r\n            `).join('')}\r\n            <button id=\"addMessage\" style=\"padding: 8px 16px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer; width: 100%; margin-top: 10px;\">+ 添加消息</button>\r\n          </div>\r\n        </div>\r\n        \r\n        <div style=\"margin-top: 30px; padding-top: 20px; border-top: 1px solid #e0e0e0; display: flex; justify-content: flex-end; gap: 10px;\">\r\n          <button id=\"cancel\" style=\"padding: 8px 20px; border: 1px solid #ddd; border-radius: 4px; cursor: pointer;\">取消</button>\r\n          <button id=\"save\" style=\"padding: 8px 20px; background: #667eea; color: white; border: none; border-radius: 4px; cursor: pointer;\">保存</button>\r\n        </div>\r\n      </div>\r\n    `\r\n\r\n    this.bindEvents()\r\n  }\r\n\r\n  private bindEvents(): void {\r\n    (window as any).delSeqActor = (i: number) => {\r\n      if (this.data) { this.data.actors.splice(i, 1); this.createUI() }\r\n    };\r\n    (window as any).delSeqMsg = (i: number) => {\r\n      if (this.data) { this.data.messages.splice(i, 1); this.createUI() }\r\n    }\r\n\r\n    this.container?.querySelector('#addActor')?.addEventListener('click', () => {\r\n      const name = prompt('参与者名称：')\r\n      if (name && this.data) { this.data.actors.push(name); this.createUI() }\r\n    })\r\n\r\n    this.container?.querySelector('#addMessage')?.addEventListener('click', () => {\r\n      if (!this.data || this.data.actors.length < 2) {\r\n        alert('至少需要2个参与者')\r\n        return\r\n      }\r\n      const from = prompt(`发送方 (${this.data.actors.join(', ')}):`)\r\n      const to = prompt(`接收方 (${this.data.actors.join(', ')}):`)\r\n      const text = prompt('消息内容：')\r\n      if (from && to && text) {\r\n        this.data.messages.push({ from, to, text })\r\n        this.createUI()\r\n      }\r\n    })\r\n\r\n    this.container?.querySelector('#save')?.addEventListener('click', () => {\r\n      if (this.onSave && this.data)\r\n        this.onSave(this.data)\r\n    })\r\n    this.container?.querySelector('#cancel')?.addEventListener('click', () => this.onCancel?.())\r\n  }\r\n\r\n  destroy(): void {\r\n    delete (window as any).delSeqActor\r\n    delete (window as any).delSeqMsg\r\n  }\r\n}\r\n"],"names":["SequenceDiagramEditor","render","container","options","data","JSON","parse","stringify","onSave","onCancel","createUI","innerHTML","actors","map","actor","i","name","join","messages","msg","from","to","text","bindEvents","window","delSeqActor","splice","delSeqMsg","querySelector","addEventListener","prompt","push","length","alert","destroy"],"mappings":"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"}