{"version":3,"file":"DiagramRenderer.cjs","sources":["../../../src/plugins/diagrams/DiagramRenderer.ts"],"sourcesContent":["/**\r\n * ÂõæË°®Ê∏≤ÊüìÂô®\r\n * Ë¥üË¥£Â∞ÜÂõæË°®Êï∞ÊçÆÊ∏≤Êüì‰∏∫ÂèØËßÜÂåñÂÜÖÂÆπ\r\n */\r\n\r\nimport type { Editor } from '../../core/Editor'\r\nimport type { DiagramData, DiagramOptions, DiagramRendererInterface, DiagramType } from './types'\r\nimport { createLogger } from '../../utils/logger'\r\n\r\nconst logger = createLogger('DiagramRenderer')\r\n\r\nexport class DiagramRenderer implements DiagramRendererInterface {\r\n  private editor: Editor\r\n\r\n  constructor(options: { editor: Editor }) {\r\n    this.editor = options.editor\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÂõæË°®\r\n   */\r\n  render(container: HTMLElement, type: DiagramType, data: DiagramData, options?: DiagramOptions): void {\r\n    logger.info(`Rendering diagram: ${type}`)\r\n\r\n    // Ê∏ÖÁ©∫ÂÆπÂô®\r\n    container.innerHTML = ''\r\n\r\n    // ÂàõÂª∫ÂõæË°®È¢ÑËßà\r\n    const preview = document.createElement('div')\r\n    preview.className = 'diagram-preview'\r\n    preview.style.cssText = `\r\n      width: 100%;\r\n      height: ${options?.height || 400}px;\r\n      background: #f8f9fa;\r\n      border: 1px solid #e0e0e0;\r\n      border-radius: 4px;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n      flex-direction: column;\r\n      position: relative;\r\n    `\r\n\r\n    // Ê∏≤Êüì‰∏çÂêåÁ±ªÂûãÁöÑÂõæË°®\r\n    switch (type) {\r\n      case 'mindmap':\r\n        this.renderMindMapPreview(preview, data)\r\n        break\r\n      case 'flowchart':\r\n        this.renderFlowchartPreview(preview, data)\r\n        break\r\n      case 'uml':\r\n        this.renderUMLPreview(preview, data)\r\n        break\r\n      case 'sequence':\r\n        this.renderSequencePreview(preview, data)\r\n        break\r\n      case 'gantt':\r\n        this.renderGanttPreview(preview, data)\r\n        break\r\n      default:\r\n        preview.innerHTML = `<div style=\"color: #999;\">Êú™Áü•ÂõæË°®Á±ªÂûã: ${type}</div>`\r\n    }\r\n\r\n    // Ê∑ªÂä†ÁºñËæëÊåâÈíÆ\r\n    const editBtn = document.createElement('button')\r\n    editBtn.style.cssText = `\r\n      position: absolute;\r\n      top: 10px;\r\n      right: 10px;\r\n      padding: 6px 12px;\r\n      background: white;\r\n      border: 1px solid #ddd;\r\n      border-radius: 4px;\r\n      cursor: pointer;\r\n      font-size: 12px;\r\n      z-index: 10;\r\n    `\r\n    editBtn.innerHTML = '‚úèÔ∏è ÁºñËæë'\r\n    editBtn.onclick = () => {\r\n      // Ëß¶ÂèëÁºñËæë‰∫ã‰ª∂\r\n      container.dispatchEvent(new CustomEvent('edit-diagram'))\r\n    }\r\n    preview.appendChild(editBtn)\r\n\r\n    container.appendChild(preview)\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÊÄùÁª¥ÂØºÂõæÈ¢ÑËßà\r\n   */\r\n  private renderMindMapPreview(container: HTMLElement, data: any): void {\r\n    const mindmapData = data as any\r\n    if (!mindmapData.root)\r\n      return\r\n\r\n    container.innerHTML = `\r\n      <div style=\"text-align: center; padding: 20px;\">\r\n        <div style=\"font-size: 32px; margin-bottom: 10px;\">üß†</div>\r\n        <div style=\"font-size: 18px; font-weight: bold; margin-bottom: 10px;\">${mindmapData.root.text}</div>\r\n        <div style=\"font-size: 14px; color: #666;\">\r\n          ${mindmapData.root.children?.length || 0} ‰∏™ÂàÜÊîØ\r\n        </div>\r\n        <div style=\"margin-top: 20px; font-size: 12px; color: #999;\">\r\n          ÂèåÂáªÁºñËæëÊÄùÁª¥ÂØºÂõæ\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÊµÅÁ®ãÂõæÈ¢ÑËßà\r\n   */\r\n  private renderFlowchartPreview(container: HTMLElement, data: any): void {\r\n    const flowData = data as any\r\n\r\n    container.innerHTML = `\r\n      <div style=\"text-align: center; padding: 20px;\">\r\n        <div style=\"font-size: 32px; margin-bottom: 10px;\">üîÄ</div>\r\n        <div style=\"font-size: 16px; font-weight: bold; margin-bottom: 10px;\">ÊµÅÁ®ãÂõæ</div>\r\n        <div style=\"font-size: 14px; color: #666;\">\r\n          ${flowData.nodes?.length || 0} ‰∏™ËäÇÁÇπ, ${flowData.edges?.length || 0} ‰∏™ËøûÊé•\r\n        </div>\r\n        <div style=\"margin-top: 20px; font-size: 12px; color: #999;\">\r\n          ÂèåÂáªÁºñËæëÊµÅÁ®ãÂõæ\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìUMLÈ¢ÑËßà\r\n   */\r\n  private renderUMLPreview(container: HTMLElement, data: any): void {\r\n    const umlData = data as any\r\n\r\n    container.innerHTML = `\r\n      <div style=\"text-align: center; padding: 20px;\">\r\n        <div style=\"font-size: 32px; margin-bottom: 10px;\">üìê</div>\r\n        <div style=\"font-size: 16px; font-weight: bold; margin-bottom: 10px;\">UMLÁ±ªÂõæ</div>\r\n        <div style=\"font-size: 14px; color: #666;\">\r\n          ${umlData.classes?.length || 0} ‰∏™Á±ª, ${umlData.relationships?.length || 0} ‰∏™ÂÖ≥Á≥ª\r\n        </div>\r\n        <div style=\"margin-top: 20px; font-size: 12px; color: #999;\">\r\n          ÂèåÂáªÁºñËæëUMLÂõæ\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÊó∂Â∫èÂõæÈ¢ÑËßà\r\n   */\r\n  private renderSequencePreview(container: HTMLElement, data: any): void {\r\n    const seqData = data as any\r\n\r\n    container.innerHTML = `\r\n      <div style=\"text-align: center; padding: 20px;\">\r\n        <div style=\"font-size: 32px; margin-bottom: 10px;\">üìä</div>\r\n        <div style=\"font-size: 16px; font-weight: bold; margin-bottom: 10px;\">Êó∂Â∫èÂõæ</div>\r\n        <div style=\"font-size: 14px; color: #666;\">\r\n          ${seqData.actors?.length || 0} ‰∏™ÂèÇ‰∏éËÄÖ, ${seqData.messages?.length || 0} Êù°Ê∂àÊÅØ\r\n        </div>\r\n        <div style=\"margin-top: 20px; font-size: 12px; color: #999;\">\r\n          ÂèåÂáªÁºñËæëÊó∂Â∫èÂõæ\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÁîòÁâπÂõæÈ¢ÑËßà\r\n   */\r\n  private renderGanttPreview(container: HTMLElement, data: any): void {\r\n    const ganttData = data as any\r\n\r\n    container.innerHTML = `\r\n      <div style=\"text-align: center; padding: 20px;\">\r\n        <div style=\"font-size: 32px; margin-bottom: 10px;\">üìÖ</div>\r\n        <div style=\"font-size: 16px; font-weight: bold; margin-bottom: 10px;\">ÁîòÁâπÂõæ</div>\r\n        <div style=\"font-size: 14px; color: #666;\">\r\n          ${ganttData.tasks?.length || 0} ‰∏™‰ªªÂä°\r\n        </div>\r\n        <div style=\"margin-top: 20px; font-size: 12px; color: #999;\">\r\n          ÂèåÂáªÁºñËæëÁîòÁâπÂõæ\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * ÂØºÂá∫ÂõæË°®\r\n   */\r\n  async export(container: HTMLElement, type: DiagramType, data: DiagramData, format: 'png' | 'svg' | 'pdf' = 'png'): Promise<void> {\r\n    logger.info(`Exporting diagram as ${format}`)\r\n\r\n    // ÁÆÄÂåñÂÆûÁé∞ÔºöÂØºÂá∫‰∏∫JSON\r\n    const json = JSON.stringify({ type, data }, null, 2)\r\n    const blob = new Blob([json], { type: 'application/json' })\r\n    const url = URL.createObjectURL(blob)\r\n\r\n    const a = document.createElement('a')\r\n    a.href = url\r\n    a.download = `diagram-${type}-${Date.now()}.json`\r\n    a.click()\r\n\r\n    URL.revokeObjectURL(url)\r\n\r\n    logger.info('Diagram exported successfully')\r\n  }\r\n\r\n  /**\r\n   * ÈîÄÊØÅÊ∏≤ÊüìÂô®\r\n   */\r\n  destroy(): void {\r\n    logger.info('Diagram renderer destroyed')\r\n  }\r\n}\r\n"],"names":["logger","createLogger","DiagramRenderer","constructor","options","editor","render","container","type","data","info","innerHTML","preview","document","createElement","className","style","cssText","height","renderMindMapPreview","renderFlowchartPreview","renderUMLPreview","renderSequencePreview","renderGanttPreview","editBtn","onclick","dispatchEvent","CustomEvent","appendChild","mindmapData","root","text","children","length","flowData","nodes","edges","umlData","classes","relationships","seqData","actors","messages","ganttData","tasks","export","format","json","JSON","stringify","blob","Blob","url","URL","createObjectURL","a","href","download","Date","now","click","revokeObjectURL","destroy"],"mappings":"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"}