{"version":3,"file":"blockquote.cjs","sources":["../../../src/plugins/text/blockquote.ts"],"sourcesContent":["/**\r\n * 引用块插�?\r\n */\r\n\r\nimport type { Command, Plugin } from '../../types'\r\nimport { createPlugin } from '../../core/Plugin'\r\n\r\n/**\r\n * 切换引用�?\r\n */\r\nconst toggleBlockquote: Command = (state, dispatch) => {\r\n  if (!dispatch)\r\n    return true\r\n\r\n  const selection = window.getSelection()\r\n  if (!selection || selection.rangeCount === 0)\r\n    return false\r\n\r\n  // 检查当前是否在引用块中\r\n  let node = selection.anchorNode\r\n  let inBlockquote = false\r\n\r\n  while (node && node !== document.body) {\r\n    if (node.nodeName === 'BLOCKQUOTE') {\r\n      inBlockquote = true\r\n      break\r\n    }\r\n    node = node.parentNode\r\n  }\r\n\r\n  if (inBlockquote) {\r\n    // 移除引用�?    document.execCommand('outdent', false)\r\n  }\r\n  else {\r\n    // 添加引用�?    document.execCommand('formatBlock', false, 'blockquote')\r\n  }\r\n\r\n  return true\r\n}\r\n\r\n/**\r\n * 检查是否在引用块中\r\n */\r\nfunction isBlockquoteActive() {\r\n  return () => {\r\n    const selection = window.getSelection()\r\n    if (!selection || selection.rangeCount === 0)\r\n      return false\r\n\r\n    let node = selection.anchorNode\r\n    while (node && node !== document.body) {\r\n      if (node.nodeName === 'BLOCKQUOTE')\r\n        return true\r\n      node = node.parentNode\r\n    }\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * 引用块插�?\r\n */\r\nexport const BlockquotePlugin: Plugin = createPlugin({\r\n  name: 'blockquote',\r\n  commands: {\r\n    toggleBlockquote,\r\n  },\r\n  keys: {\r\n    'Mod-Shift-B': toggleBlockquote,\r\n  },\r\n  toolbar: [{\r\n    name: 'blockquote',\r\n    title: '引用',\r\n    icon: 'quote',\r\n    command: toggleBlockquote,\r\n    active: isBlockquoteActive(),\r\n  }],\r\n})\r\n"],"names":["toggleBlockquote","state","dispatch","selection","window","getSelection","rangeCount","node","anchorNode","document","body","nodeName","parentNode","isBlockquoteActive","BlockquotePlugin","createPlugin","name","commands","keys","toolbar","title","icon","command","active"],"mappings":";;;;;;;;;;;;;AAUA,MAAMA,gBAAAA,GAA4BA,CAACC,KAAAA,EAAOC,QAAAA,KAAa;AACrD,EAAA,IAAI,CAACA,QAAAA;AACH,IAAA,OAAO,IAAA;AAET,EAAA,MAAMC,SAAAA,GAAYC,OAAOC,YAAAA,EAAa;AACtC,EAAA,IAAI,CAACF,SAAAA,IAAaA,SAAAA,CAAUG,UAAAA,KAAe,CAAA;AACzC,IAAA,OAAO,KAAA;AAGT,EAAA,IAAIC,OAAOJ,SAAAA,CAAUK,UAAAA;AAGrB,EAAA,OAAOD,IAAAA,IAAQA,IAAAA,KAASE,QAAAA,CAASC,IAAAA,EAAM;AACrC,IAAA,IAAIH,IAAAA,CAAKI,aAAa,YAAA,EAAc;AAElC,MAAA;AAAA,IACF;AACAJ,IAAAA,IAAAA,GAAOA,IAAAA,CAAKK,UAAAA;AAAAA,EACd;AASA,EAAA,OAAO,IAAA;AACT,CAAA;AAKA,SAASC,kBAAAA,GAAqB;AAC5B,EAAA,OAAO,MAAM;AACX,IAAA,MAAMV,SAAAA,GAAYC,OAAOC,YAAAA,EAAa;AACtC,IAAA,IAAI,CAACF,SAAAA,IAAaA,SAAAA,CAAUG,UAAAA,KAAe,CAAA;AACzC,MAAA,OAAO,KAAA;AAET,IAAA,IAAIC,OAAOJ,SAAAA,CAAUK,UAAAA;AACrB,IAAA,OAAOD,IAAAA,IAAQA,IAAAA,KAASE,QAAAA,CAASC,IAAAA,EAAM;AACrC,MAAA,IAAIH,KAAKI,QAAAA,KAAa,YAAA;AACpB,QAAA,OAAO,IAAA;AACTJ,MAAAA,IAAAA,GAAOA,IAAAA,CAAKK,UAAAA;AAAAA,IACd;AACA,IAAA,OAAO,KAAA;AAAA,EACT,CAAA;AACF;AAKO,MAAME,mBAA2BC,mBAAAA,CAAa;AAAA,EACnDC,IAAAA,EAAM,YAAA;AAAA,EACNC,QAAAA,EAAU;AAAA,IACRjB;AAAAA,GACF;AAAA,EACAkB,IAAAA,EAAM;AAAA,IACJ,aAAA,EAAelB;AAAAA,GACjB;AAAA,EACAmB,SAAS,CAAC;AAAA,IACRH,IAAAA,EAAM,YAAA;AAAA,IACNI,KAAAA,EAAO,cAAA;AAAA,IACPC,IAAAA,EAAM,OAAA;AAAA,IACNC,OAAAA,EAAStB,gBAAAA;AAAAA,IACTuB,QAAQV,kBAAAA;AAAmB,GAC5B;AACH,CAAC;;;;;;;"}