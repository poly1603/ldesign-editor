{"version":3,"file":"MediaPropertiesDialog.cjs","sources":["../../../../src/plugins/media/media-context-menu/MediaPropertiesDialog.ts"],"sourcesContent":["import { BaseComponent } from '../../../ui/base/BaseComponent'\r\nimport { createButton } from '../../../utils/dom'\r\n\r\nexport interface MediaProperties {\r\n  src?: string\r\n  alt?: string\r\n  width?: string | number\r\n  height?: string | number\r\n  title?: string\r\n  caption?: string\r\n}\r\n\r\nexport class MediaPropertiesDialog extends BaseComponent {\r\n  private properties: MediaProperties = {}\r\n  private onSave?: (properties: MediaProperties) => void\r\n  private onCancel?: () => void\r\n  private dialogElement?: HTMLElement\r\n  private overlayElement?: HTMLElement\r\n\r\n  constructor(container?: HTMLElement) {\r\n    super({ container, visible: false })\r\n  }\r\n\r\n  protected createElement(): HTMLElement {\r\n    // 返回一个空容器，实际内容在 render() 中创建\r\n    const el = document.createElement('div')\r\n    el.className = 'media-properties-container'\r\n    el.style.display = 'none'\r\n    return el\r\n  }\r\n\r\n  show(properties: MediaProperties, onSave: (props: MediaProperties) => void, onCancel?: () => void): void {\r\n    this.properties = { ...properties }\r\n    this.onSave = onSave\r\n    this.onCancel = onCancel\r\n    this.render()\r\n  }\r\n\r\n  private render(): void {\r\n    // Create overlay\r\n    this.overlayElement = document.createElement('div')\r\n    this.overlayElement.className = 'media-properties-overlay'\r\n    this.overlayElement.onclick = () => this.cancel()\r\n\r\n    // Create dialog\r\n    this.dialogElement = document.createElement('div')\r\n    this.dialogElement.className = 'media-properties-dialog'\r\n    this.dialogElement.onclick = e => e.stopPropagation()\r\n\r\n    // Dialog header\r\n    const header = document.createElement('div')\r\n    header.className = 'dialog-header'\r\n    header.innerHTML = `\r\n      <h3>Media Properties</h3>\r\n      <button class=\"close-btn\" title=\"Close\">&times;</button>\r\n    `\r\n    header.querySelector('.close-btn')?.addEventListener('click', () => this.cancel())\r\n\r\n    // Dialog content\r\n    const content = document.createElement('div')\r\n    content.className = 'dialog-content'\r\n    content.innerHTML = `\r\n      <div class=\"form-group\">\r\n        <label for=\"media-src\">Source URL</label>\r\n        <input type=\"text\" id=\"media-src\" value=\"${this.properties.src || ''}\" />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"media-alt\">Alt Text</label>\r\n        <input type=\"text\" id=\"media-alt\" value=\"${this.properties.alt || ''}\" />\r\n      </div>\r\n      <div class=\"form-row\">\r\n        <div class=\"form-group\">\r\n          <label for=\"media-width\">Width</label>\r\n          <input type=\"text\" id=\"media-width\" value=\"${this.properties.width || ''}\" placeholder=\"auto\" />\r\n        </div>\r\n        <div class=\"form-group\">\r\n          <label for=\"media-height\">Height</label>\r\n          <input type=\"text\" id=\"media-height\" value=\"${this.properties.height || ''}\" placeholder=\"auto\" />\r\n        </div>\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"media-title\">Title</label>\r\n        <input type=\"text\" id=\"media-title\" value=\"${this.properties.title || ''}\" />\r\n      </div>\r\n      <div class=\"form-group\">\r\n        <label for=\"media-caption\">Caption</label>\r\n        <textarea id=\"media-caption\" rows=\"3\">${this.properties.caption || ''}</textarea>\r\n      </div>\r\n    `\r\n\r\n    // Dialog footer\r\n    const footer = document.createElement('div')\r\n    footer.className = 'dialog-footer'\r\n\r\n    const cancelBtn = createButton('Cancel', () => this.cancel())\r\n    cancelBtn.className = 'btn btn-secondary'\r\n\r\n    const saveBtn = createButton('Save', () => this.save())\r\n    saveBtn.className = 'btn btn-primary'\r\n\r\n    footer.appendChild(cancelBtn)\r\n    footer.appendChild(saveBtn)\r\n\r\n    // Assemble dialog\r\n    this.dialogElement.appendChild(header)\r\n    this.dialogElement.appendChild(content)\r\n    this.dialogElement.appendChild(footer)\r\n    this.overlayElement.appendChild(this.dialogElement)\r\n\r\n    // Add to DOM\r\n    document.body.appendChild(this.overlayElement)\r\n\r\n    // Focus first input\r\n    const firstInput = this.dialogElement.querySelector('input')\r\n    if (firstInput instanceof HTMLInputElement)\r\n      firstInput.focus()\r\n  }\r\n\r\n  private save(): void {\r\n    if (!this.dialogElement)\r\n      return\r\n\r\n    const getInputValue = (id: string): string => {\r\n      const input = this.dialogElement?.querySelector(`#${id}`) as HTMLInputElement | HTMLTextAreaElement\r\n      return input?.value || ''\r\n    }\r\n\r\n    const updatedProperties: MediaProperties = {\r\n      src: getInputValue('media-src'),\r\n      alt: getInputValue('media-alt'),\r\n      width: getInputValue('media-width'),\r\n      height: getInputValue('media-height'),\r\n      title: getInputValue('media-title'),\r\n      caption: getInputValue('media-caption'),\r\n    }\r\n\r\n    this.close()\r\n    this.onSave?.(updatedProperties)\r\n  }\r\n\r\n  private cancel(): void {\r\n    this.close()\r\n    this.onCancel?.()\r\n  }\r\n\r\n  private close(): void {\r\n    this.overlayElement?.remove()\r\n    this.overlayElement = undefined\r\n    this.dialogElement = undefined\r\n  }\r\n\r\n  destroy(): void {\r\n    this.close()\r\n    super.destroy()\r\n  }\r\n}\r\n\r\nexport default MediaPropertiesDialog\r\n"],"names":["MediaPropertiesDialog","BaseComponent","constructor","container","visible","properties","createElement","el","document","className","style","display","show","onSave","onCancel","render","overlayElement","onclick","cancel","dialogElement","e","stopPropagation","header","innerHTML","querySelector","addEventListener","content","src","alt","width","height","title","caption","footer","cancelBtn","createButton","saveBtn","save","appendChild","body","firstInput","HTMLInputElement","focus","getInputValue","id","input","value","updatedProperties","close","remove","undefined","destroy"],"mappings":"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"}