{"version":3,"file":"AIService.cjs","sources":["../../src/ai/AIService.ts"],"sourcesContent":["/**\r\n * AI 服务管理器\r\n * 统一管理 AI 功能，支持多种 AI 提供商\r\n */\r\n\r\nimport type {\r\n  AIConfig,\r\n  AIProvider,\r\n  AIProviderInterface,\r\n  AIRequest,\r\n  AIResponse,\r\n} from './types'\r\nimport { BaiduProvider } from './providers/BaiduProvider'\r\nimport { ClaudeProvider } from './providers/ClaudeProvider'\r\nimport { DeepSeekProvider } from './providers/DeepSeekProvider'\r\nimport { GLMProvider } from './providers/GLMProvider'\r\nimport { OpenAIProvider } from './providers/OpenAIProvider'\r\nimport { QwenProvider } from './providers/QwenProvider'\r\nimport { SparkProvider } from './providers/SparkProvider'\r\nimport { defaultAIConfig } from './types'\r\n\r\nexport class AIService {\r\n  private config: AIConfig\r\n  private providers: Map<AIProvider, AIProviderInterface> = new Map()\r\n  private currentProvider: AIProviderInterface | null = null\r\n  private configStorageKey = 'ldesign-editor-ai-config'\r\n\r\n  constructor(config?: Partial<AIConfig>) {\r\n    // 加载保存的配置或使用默认配置\r\n    this.config = this.loadConfig(config)\r\n\r\n    // 初始化提供商\r\n    this.initializeProviders()\r\n\r\n    // 设置当前提供商\r\n    this.setProvider(this.config.defaultProvider)\r\n  }\r\n\r\n  /**\r\n   * 加载配置\r\n   */\r\n  private loadConfig(customConfig?: Partial<AIConfig>): AIConfig {\r\n    // 从 localStorage 加载保存的配置\r\n    let savedConfig: Partial<AIConfig> = {}\r\n\r\n    if (typeof window !== 'undefined' && window.localStorage) {\r\n      try {\r\n        const saved = localStorage.getItem(this.configStorageKey)\r\n        if (saved)\r\n          savedConfig = JSON.parse(saved)\r\n      }\r\n      catch (error) {\r\n        console.error('Failed to load AI config from localStorage:', error)\r\n      }\r\n    }\r\n\r\n    // 合并配置：默认 -> 保存的 -> 自定义的\r\n    return {\r\n      ...defaultAIConfig,\r\n      ...savedConfig,\r\n      ...customConfig,\r\n      providers: {\r\n        ...defaultAIConfig.providers,\r\n        ...savedConfig.providers,\r\n        ...customConfig?.providers,\r\n      },\r\n      features: {\r\n        ...defaultAIConfig.features,\r\n        ...savedConfig.features,\r\n        ...customConfig?.features,\r\n      },\r\n      shortcuts: {\r\n        ...defaultAIConfig.shortcuts,\r\n        ...savedConfig.shortcuts,\r\n        ...customConfig?.shortcuts,\r\n      },\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 保存配置\r\n   */\r\n  private saveConfig(): void {\r\n    if (typeof window !== 'undefined' && window.localStorage) {\r\n      try {\r\n        localStorage.setItem(this.configStorageKey, JSON.stringify(this.config))\r\n      }\r\n      catch (error) {\r\n        console.error('Failed to save AI config to localStorage:', error)\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 初始化提供商\r\n   */\r\n  private initializeProviders(): void {\r\n    // 初始化 DeepSeek\r\n    if (this.config.providers.deepseek?.apiKey)\r\n      this.providers.set('deepseek', new DeepSeekProvider(this.config.providers.deepseek))\r\n\r\n    // 初始化 OpenAI\r\n    if (this.config.providers.openai?.apiKey)\r\n      this.providers.set('openai', new OpenAIProvider(this.config.providers.openai))\r\n\r\n    // 初始化 Claude\r\n    if (this.config.providers.claude?.apiKey)\r\n      this.providers.set('claude', new ClaudeProvider(this.config.providers.claude))\r\n\r\n    // 初始化百度文心一言\r\n    if (this.config.providers.baidu?.apiKey)\r\n      this.providers.set('baidu', new BaiduProvider(this.config.providers.baidu))\r\n\r\n    // 初始化阿里通义千问\r\n    if (this.config.providers.qwen?.apiKey)\r\n      this.providers.set('qwen', new QwenProvider(this.config.providers.qwen))\r\n\r\n    // 初始化讯飞星火\r\n    if (this.config.providers.spark?.apiKey)\r\n      this.providers.set('spark', new SparkProvider(this.config.providers.spark))\r\n\r\n    // 初始化智谱清言\r\n    if (this.config.providers.glm?.apiKey)\r\n      this.providers.set('glm', new GLMProvider(this.config.providers.glm))\r\n  }\r\n\r\n  /**\r\n   * 设置当前提供商\r\n   */\r\n  setProvider(provider: AIProvider): boolean {\r\n    const providerInstance = this.providers.get(provider)\r\n    if (!providerInstance) {\r\n      console.warn(`[AIService] Provider ${provider} is not available. AI features will be disabled.`)\r\n      this.currentProvider = null\r\n      return false\r\n    }\r\n\r\n    this.currentProvider = providerInstance\r\n    this.config.defaultProvider = provider\r\n    this.saveConfig()\r\n    return true\r\n  }\r\n\r\n  /**\r\n   * 更新配置\r\n   */\r\n  updateConfig(config: Partial<AIConfig>): void {\r\n    this.config = {\r\n      ...this.config,\r\n      ...config,\r\n      providers: {\r\n        ...this.config.providers,\r\n        ...config.providers,\r\n      },\r\n      features: {\r\n        ...this.config.features,\r\n        ...config.features,\r\n      },\r\n      shortcuts: {\r\n        ...this.config.shortcuts,\r\n        ...config.shortcuts,\r\n      },\r\n    }\r\n\r\n    // 重新初始化提供商\r\n    this.providers.clear()\r\n    this.initializeProviders()\r\n\r\n    // 重新设置当前提供商\r\n    this.setProvider(this.config.defaultProvider)\r\n\r\n    // 保存配置\r\n    this.saveConfig()\r\n  }\r\n\r\n  /**\r\n   * 更新 API 密钥\r\n   */\r\n  updateApiKey(provider: AIProvider, apiKey: string): void {\r\n    if (this.config.providers[provider]) {\r\n      this.config.providers[provider]!.apiKey = apiKey\r\n\r\n      // 重新初始化该提供商\r\n      const config = this.config.providers[provider]!\r\n\r\n      switch (provider) {\r\n        case 'deepseek':\r\n          this.providers.set('deepseek', new DeepSeekProvider(config))\r\n          break\r\n        case 'openai':\r\n          this.providers.set('openai', new OpenAIProvider(config))\r\n          break\r\n        case 'claude':\r\n          this.providers.set('claude', new ClaudeProvider(config))\r\n          break\r\n        case 'baidu':\r\n          this.providers.set('baidu', new BaiduProvider(config))\r\n          break\r\n        case 'qwen':\r\n          this.providers.set('qwen', new QwenProvider(config))\r\n          break\r\n        case 'spark':\r\n          this.providers.set('spark', new SparkProvider(config))\r\n          break\r\n        case 'glm':\r\n          this.providers.set('glm', new GLMProvider(config))\r\n          break\r\n      }\r\n\r\n      this.saveConfig()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 注册自定义提供商\r\n   */\r\n  registerProvider(name: string, provider: AIProviderInterface): void {\r\n    this.providers.set(name as AIProvider, provider)\r\n  }\r\n\r\n  /**\r\n   * 获取可用的提供商列表\r\n   */\r\n  getAvailableProviders(): AIProvider[] {\r\n    return Array.from(this.providers.keys())\r\n  }\r\n\r\n  /**\r\n   * 获取当前提供商\r\n   */\r\n  getCurrentProvider(): AIProvider | null {\r\n    if (!this.currentProvider)\r\n      return null\r\n\r\n    for (const [name, provider] of this.providers.entries()) {\r\n      if (provider === this.currentProvider)\r\n        return name\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  /**\r\n   * 获取配置\r\n   */\r\n  getConfig(): AIConfig {\r\n    return { ...this.config }\r\n  }\r\n\r\n  /**\r\n   * 检查 AI 功能是否启用\r\n   */\r\n  isEnabled(): boolean {\r\n    return this.config.enabled\r\n  }\r\n\r\n  /**\r\n   * 启用/禁用 AI 功能\r\n   */\r\n  setEnabled(enabled: boolean): void {\r\n    this.config.enabled = enabled\r\n    this.saveConfig()\r\n  }\r\n\r\n  /**\r\n   * 发送 AI 请求\r\n   */\r\n  async request(request: AIRequest): Promise<AIResponse> {\r\n    if (!this.isEnabled()) {\r\n      return {\r\n        success: false,\r\n        error: 'AI features are disabled',\r\n      }\r\n    }\r\n\r\n    if (!this.currentProvider) {\r\n      return {\r\n        success: false,\r\n        error: 'No AI provider is configured',\r\n      }\r\n    }\r\n\r\n    try {\r\n      return await this.currentProvider.request(request)\r\n    }\r\n    catch (error) {\r\n      console.error('AI request failed:', error)\r\n      return {\r\n        success: false,\r\n        error: error instanceof Error ? error.message : 'Unknown error',\r\n      }\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 纠错\r\n   */\r\n  async correct(text: string, context?: string): Promise<AIResponse> {\r\n    if (!this.config.features.errorCorrection) {\r\n      return {\r\n        success: false,\r\n        error: 'Error correction feature is disabled',\r\n      }\r\n    }\r\n\r\n    return this.request({\r\n      type: 'correct',\r\n      text,\r\n      context,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 自动补全\r\n   */\r\n  async complete(text: string, context?: string): Promise<AIResponse> {\r\n    if (!this.config.features.autoComplete) {\r\n      return {\r\n        success: false,\r\n        error: 'Auto-complete feature is disabled',\r\n      }\r\n    }\r\n\r\n    return this.request({\r\n      type: 'complete',\r\n      text,\r\n      context,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 续写\r\n   */\r\n  async continue(text: string, context?: string): Promise<AIResponse> {\r\n    if (!this.config.features.textContinuation) {\r\n      return {\r\n        success: false,\r\n        error: 'Text continuation feature is disabled',\r\n      }\r\n    }\r\n\r\n    return this.request({\r\n      type: 'continue',\r\n      text,\r\n      context,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 重写\r\n   */\r\n  async rewrite(text: string, context?: string): Promise<AIResponse> {\r\n    if (!this.config.features.textRewrite) {\r\n      return {\r\n        success: false,\r\n        error: 'Text rewrite feature is disabled',\r\n      }\r\n    }\r\n\r\n    return this.request({\r\n      type: 'rewrite',\r\n      text,\r\n      context,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 获取建议\r\n   */\r\n  async suggest(text: string, context?: string): Promise<AIResponse> {\r\n    if (!this.config.features.smartSuggestions) {\r\n      return {\r\n        success: false,\r\n        error: 'Smart suggestions feature is disabled',\r\n      }\r\n    }\r\n\r\n    return this.request({\r\n      type: 'suggest',\r\n      text,\r\n      context,\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 清理资源\r\n   */\r\n  cleanup(): void {\r\n    this.providers.forEach(provider => provider.cleanup())\r\n    this.providers.clear()\r\n    this.currentProvider = null\r\n  }\r\n}\r\n\r\n// 创建全局 AI 服务实例\r\nlet aiServiceInstance: AIService | null = null\r\n\r\n/**\r\n * 获取 AI 服务实例\r\n */\r\nexport function getAIService(config?: Partial<AIConfig>): AIService {\r\n  if (!aiServiceInstance)\r\n    aiServiceInstance = new AIService(config)\r\n\r\n  return aiServiceInstance\r\n}\r\n\r\n/**\r\n * 重置 AI 服务实例\r\n */\r\nexport function resetAIService(): void {\r\n  if (aiServiceInstance) {\r\n    aiServiceInstance.cleanup()\r\n    aiServiceInstance = null\r\n  }\r\n}\r\n"],"names":["AIService","constructor","config","providers","Map","currentProvider","configStorageKey","loadConfig","initializeProviders","setProvider","defaultProvider","customConfig","savedConfig","window","localStorage","saved","getItem","JSON","parse","error","console","defaultAIConfig","features","shortcuts","saveConfig","setItem","stringify","deepseek","apiKey","set","DeepSeekProvider","openai","OpenAIProvider","claude","ClaudeProvider","baidu","BaiduProvider","qwen","QwenProvider","spark","SparkProvider","glm","GLMProvider","provider","providerInstance","get","warn","updateConfig","clear","updateApiKey","registerProvider","name","getAvailableProviders","Array","from","keys","getCurrentProvider","entries","getConfig","isEnabled","enabled","setEnabled","request","success","Error","message","correct","text","context","errorCorrection","type","complete","autoComplete","continue","textContinuation","rewrite","textRewrite","suggest","smartSuggestions","cleanup","forEach","aiServiceInstance","getAIService","resetAIService"],"mappings":"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"}