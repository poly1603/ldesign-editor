{"version":3,"file":"logger.cjs","sources":["../../src/utils/logger.ts"],"sourcesContent":["/**\r\n * 日志工具\r\n * 提供统一的日志管理和输出\r\n */\r\n\r\nexport type LogLevel = 'debug' | 'info' | 'warn' | 'error'\r\n\r\nexport interface LoggerOptions {\r\n  level?: LogLevel\r\n  prefix?: string\r\n  timestamp?: boolean\r\n  color?: boolean\r\n}\r\n\r\nexport class Logger {\r\n  private level: LogLevel\r\n  private prefix: string\r\n  private timestamp: boolean\r\n  private color: boolean\r\n\r\n  private static levels: Record<LogLevel, number> = {\r\n    debug: 0,\r\n    info: 1,\r\n    warn: 2,\r\n    error: 3,\r\n  }\r\n\r\n  private static colors: Record<LogLevel, string> = {\r\n    debug: '#888',\r\n    info: '#2196F3',\r\n    warn: '#FF9800',\r\n    error: '#F44336',\r\n  }\r\n\r\n  constructor(prefix: string, options: LoggerOptions = {}) {\r\n    this.prefix = prefix\r\n    this.level = options.level || 'info'\r\n    this.timestamp = options.timestamp !== false\r\n    this.color = options.color !== false\r\n  }\r\n\r\n  debug(...args: any[]): void {\r\n    this.log('debug', ...args)\r\n  }\r\n\r\n  info(...args: any[]): void {\r\n    this.log('info', ...args)\r\n  }\r\n\r\n  warn(...args: any[]): void {\r\n    this.log('warn', ...args)\r\n  }\r\n\r\n  error(...args: any[]): void {\r\n    this.log('error', ...args)\r\n  }\r\n\r\n  private log(level: LogLevel, ...args: any[]): void {\r\n    if (Logger.levels[level] < Logger.levels[this.level])\r\n      return\r\n\r\n    const timestamp = this.timestamp ? new Date().toISOString() : ''\r\n    const prefix = `[${this.prefix}]`\r\n\r\n    const parts = []\r\n    if (timestamp)\r\n      parts.push(timestamp)\r\n    parts.push(prefix)\r\n\r\n    const message = parts.join(' ')\r\n\r\n    if (this.color && typeof console !== 'undefined') {\r\n      const color = Logger.colors[level]\r\n      const css = `color: ${color}; font-weight: bold;`\r\n\r\n      switch (level) {\r\n        case 'debug':\r\n          console.debug(`%c${message}`, css, ...args)\r\n          break\r\n        case 'info':\r\n          console.info(`%c${message}`, css, ...args)\r\n          break\r\n        case 'warn':\r\n          console.warn(`%c${message}`, css, ...args)\r\n          break\r\n        case 'error':\r\n          console.error(`%c${message}`, css, ...args)\r\n          break\r\n      }\r\n    }\r\n    else {\r\n      console[level](message, ...args)\r\n    }\r\n  }\r\n\r\n  setLevel(level: LogLevel): void {\r\n    this.level = level\r\n  }\r\n}\r\n\r\n// 全局日志管理器\r\nclass LoggerManager {\r\n  private loggers: Map<string, Logger> = new Map()\r\n  private defaultOptions: LoggerOptions = {\r\n    level: 'info',\r\n    timestamp: true,\r\n    color: true,\r\n  }\r\n\r\n  createLogger(prefix: string, options?: LoggerOptions): Logger {\r\n    const logger = new Logger(prefix, { ...this.defaultOptions, ...options })\r\n    this.loggers.set(prefix, logger)\r\n    return logger\r\n  }\r\n\r\n  getLogger(prefix: string): Logger | undefined {\r\n    return this.loggers.get(prefix)\r\n  }\r\n\r\n  setGlobalLevel(level: LogLevel): void {\r\n    this.defaultOptions.level = level\r\n    this.loggers.forEach(logger => logger.setLevel(level))\r\n  }\r\n\r\n  setGlobalOptions(options: LoggerOptions): void {\r\n    this.defaultOptions = { ...this.defaultOptions, ...options }\r\n  }\r\n}\r\n\r\n// 单例\r\nconst loggerManager = new LoggerManager()\r\n\r\n/**\r\n * 创建日志记录器\r\n */\r\nexport function createLogger(prefix: string, options?: LoggerOptions): Logger {\r\n  return loggerManager.createLogger(prefix, options)\r\n}\r\n\r\n/**\r\n * 获取日志记录器\r\n */\r\nexport function getLogger(prefix: string): Logger | undefined {\r\n  return loggerManager.getLogger(prefix)\r\n}\r\n\r\n/**\r\n * 设置全局日志级别\r\n */\r\nexport function setGlobalLogLevel(level: LogLevel): void {\r\n  loggerManager.setGlobalLevel(level)\r\n}\r\n\r\n/**\r\n * 设置全局日志选项\r\n */\r\nexport function setGlobalLogOptions(options: LoggerOptions): void {\r\n  loggerManager.setGlobalOptions(options)\r\n}\r\n\r\n// 开发环境默认显示debug日志\r\nif (process.env.NODE_ENV === 'development')\r\n  setGlobalLogLevel('debug')\r\n"],"names":["Logger","constructor","prefix","options","level","timestamp","color","debug","args","log","info","warn","error","levels","Date","toISOString","parts","push","message","join","console","colors","css","setLevel","LoggerManager","loggers","Map","defaultOptions","createLogger","logger","set","getLogger","get","setGlobalLevel","forEach","setGlobalOptions","loggerManager","setGlobalLogLevel","process","env","NODE_ENV"],"mappings":"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"}