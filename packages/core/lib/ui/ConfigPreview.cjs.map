{"version":3,"file":"ConfigPreview.cjs","sources":["../../src/ui/ConfigPreview.ts"],"sourcesContent":["/**\r\n * ÂÆûÊó∂ÈÖçÁΩÆÈ¢ÑËßà\r\n * Âú®‰∏ç‰øùÂ≠òÁöÑÊÉÖÂÜµ‰∏ãÈ¢ÑËßàÈÖçÁΩÆÊïàÊûú\r\n */\r\n\r\nimport type { PresetName } from '../config/presets'\r\nimport { getConfigManager } from '../config/ConfigManager'\r\nimport { getPreset, presetDescriptions } from '../config/presets'\r\nimport { getFeatureFlags } from '../core/FeatureFlags'\r\nimport { getComponentFactory } from './base/ComponentFactory'\r\nimport { Modal } from './base/Modal'\r\n\r\n/**\r\n * ÈÖçÁΩÆÈ¢ÑËßàÁ±ª\r\n */\r\nexport class ConfigPreview {\r\n  private componentFactory = getComponentFactory()\r\n  private configManager = getConfigManager()\r\n  private features = getFeatureFlags()\r\n  private modal: Modal | null = null\r\n  private originalConfig: any = {}\r\n\r\n  /**\r\n   * ÊòæÁ§∫È¢ÑËßà\r\n   */\r\n  show(preset: PresetName): void {\r\n    // ‰øùÂ≠òÂéüÂßãÈÖçÁΩÆ\r\n    this.saveOriginalConfig()\r\n\r\n    // Â∫îÁî®È¢ÑËßàÈÖçÁΩÆ\r\n    this.applyPresetPreview(preset)\r\n\r\n    // ÊòæÁ§∫È¢ÑËßàÈù¢Êùø\r\n    this.showPreviewPanel(preset)\r\n  }\r\n\r\n  /**\r\n   * ‰øùÂ≠òÂéüÂßãÈÖçÁΩÆ\r\n   */\r\n  private saveOriginalConfig(): void {\r\n    this.originalConfig = {\r\n      theme: this.configManager.getThemeManager().getCurrentThemeName(),\r\n      iconSet: this.configManager.getIconSet(),\r\n      locale: this.configManager.getLocale(),\r\n      features: this.features.exportConfig(),\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Â∫îÁî®È¢ÑËÆæÈ¢ÑËßà\r\n   */\r\n  private applyPresetPreview(preset: PresetName): void {\r\n    const config = getPreset(preset)\r\n\r\n    // Â∫îÁî®ÈÖçÁΩÆÔºàÈ¢ÑËßàÔºâ\r\n    if (config.theme?.defaultTheme)\r\n      this.configManager.setTheme(config.theme.defaultTheme)\r\n\r\n    if (config.icons?.defaultSet)\r\n      this.configManager.setIconSet(config.icons.defaultSet)\r\n\r\n    if (config.features)\r\n      this.features.importConfig(config.features as any)\r\n  }\r\n\r\n  /**\r\n   * ÊòæÁ§∫È¢ÑËßàÈù¢Êùø\r\n   */\r\n  private showPreviewPanel(preset: PresetName): void {\r\n    const desc = presetDescriptions[preset]\r\n\r\n    this.modal = new Modal({\r\n      title: 'ÈÖçÁΩÆÈ¢ÑËßà',\r\n      width: 800,\r\n      onClose: () => this.restoreOriginalConfig(),\r\n    })\r\n\r\n    const content = document.createElement('div')\r\n    content.style.cssText = 'padding: 20px;'\r\n\r\n    content.innerHTML = `\r\n      <div style=\"text-align: center; margin-bottom: 24px;\">\r\n        <div style=\"font-size: 64px; margin-bottom: 12px;\">${desc.icon}</div>\r\n        <h2 style=\"font-size: 24px; font-weight: 600; margin-bottom: 8px;\">${desc.name}</h2>\r\n        <p style=\"color: #6b7280;\">${desc.description}</p>\r\n      </div>\r\n      \r\n      <div style=\"background: #f0f9ff; border: 1px solid #3b82f6; border-radius: 8px; padding: 16px; margin-bottom: 20px;\">\r\n        <p style=\"font-size: 14px; color: #1e40af;\">\r\n          <strong>üí° ÊèêÁ§∫Ôºö</strong> ÂΩìÂâçÊ≠£Âú®È¢ÑËßàÊ≠§ÈÖçÁΩÆÁöÑÊïàÊûú„ÄÇ‰Ω†ÂèØ‰ª•Ôºö<br>\r\n          ‚Ä¢ Êü•ÁúãÁºñËæëÂô®ÁöÑÂèòÂåñ<br>\r\n          ‚Ä¢ ÊµãËØï‰∏çÂêåÁöÑÂäüËÉΩ<br>\r\n          ‚Ä¢ ÁÇπÂáª\"Â∫îÁî®\"‰øùÂ≠òÈÖçÁΩÆÔºåÊàñ\"ÂèñÊ∂à\"ÊÅ¢Â§çÂéüÈÖçÁΩÆ\r\n        </p>\r\n      </div>\r\n      \r\n      <div id=\"preview-stats\"></div>\r\n    `\r\n\r\n    this.modal.setContent(content)\r\n    this.modal.setFooter(this.createFooter(preset))\r\n    this.modal.show()\r\n\r\n    // Ê∏≤ÊüìÁªüËÆ°‰ø°ÊÅØ\r\n    this.renderStats()\r\n  }\r\n\r\n  /**\r\n   * Ê∏≤ÊüìÁªüËÆ°‰ø°ÊÅØ\r\n   */\r\n  private renderStats(): void {\r\n    const statsContainer = document.getElementById('preview-stats')\r\n    if (!statsContainer)\r\n      return\r\n\r\n    const features = this.features.getStats()\r\n    const theme = this.configManager.getThemeManager().getCurrentThemeName()\r\n    const iconSet = this.configManager.getIconSet()\r\n    const locale = this.configManager.getLocale()\r\n\r\n    statsContainer.innerHTML = `\r\n      <div style=\"display: grid; grid-template-columns: repeat(2, 1fr); gap: 12px;\">\r\n        <div style=\"padding: 12px; background: white; border-radius: 6px; border: 1px solid #e5e7eb;\">\r\n          <div style=\"font-size: 12px; color: #6b7280; margin-bottom: 4px;\">ÂΩìÂâç‰∏ªÈ¢ò</div>\r\n          <div style=\"font-weight: 600;\">${theme}</div>\r\n        </div>\r\n        <div style=\"padding: 12px; background: white; border-radius: 6px; border: 1px solid #e5e7eb;\">\r\n          <div style=\"font-size: 12px; color: #6b7280; margin-bottom: 4px;\">ÂõæÊ†áÈõÜ</div>\r\n          <div style=\"font-weight: 600;\">${iconSet}</div>\r\n        </div>\r\n        <div style=\"padding: 12px; background: white; border-radius: 6px; border: 1px solid #e5e7eb;\">\r\n          <div style=\"font-size: 12px; color: #6b7280; margin-bottom: 4px;\">ËØ≠Ë®Ä</div>\r\n          <div style=\"font-weight: 600;\">${locale}</div>\r\n        </div>\r\n        <div style=\"padding: 12px; background: white; border-radius: 6px; border: 1px solid #e5e7eb;\">\r\n          <div style=\"font-size: 12px; color: #6b7280; margin-bottom: 4px;\">Â∑≤ÂêØÁî®ÂäüËÉΩ</div>\r\n          <div style=\"font-weight: 600; color: #10b981;\">${features.enabled}</div>\r\n        </div>\r\n      </div>\r\n    `\r\n  }\r\n\r\n  /**\r\n   * ÂàõÂª∫Â∫ïÈÉ®ÊåâÈíÆ\r\n   */\r\n  private createFooter(preset: PresetName): HTMLElement {\r\n    const footer = document.createElement('div')\r\n    footer.style.cssText = `\r\n      display: flex;\r\n      justify-content: flex-end;\r\n      gap: 12px;\r\n      padding: 16px 20px;\r\n      border-top: 1px solid var(--editor-color-border, #e5e7eb);\r\n    `\r\n\r\n    const cancelBtn = this.componentFactory.createButton({\r\n      label: 'ÂèñÊ∂à',\r\n      type: 'secondary',\r\n      onClick: () => {\r\n        this.restoreOriginalConfig()\r\n        this.modal?.hide()\r\n      },\r\n    })\r\n\r\n    const applyBtn = this.componentFactory.createButton({\r\n      label: 'Â∫îÁî®ÈÖçÁΩÆ',\r\n      type: 'primary',\r\n      onClick: () => {\r\n        // ‰øùÂ≠òÈÖçÁΩÆ\r\n        const config = getPreset(preset)\r\n        localStorage.setItem('editor-preset', preset)\r\n\r\n        this.modal?.hide()\r\n        ui.toast('ÈÖçÁΩÆÂ∑≤Â∫îÁî®ÔºÅ', 'success')\r\n      },\r\n    })\r\n\r\n    footer.appendChild(cancelBtn)\r\n    footer.appendChild(applyBtn)\r\n\r\n    return footer\r\n  }\r\n\r\n  /**\r\n   * ÊÅ¢Â§çÂéüÂßãÈÖçÁΩÆ\r\n   */\r\n  private restoreOriginalConfig(): void {\r\n    if (this.originalConfig.theme)\r\n      this.configManager.setTheme(this.originalConfig.theme)\r\n\r\n    if (this.originalConfig.iconSet)\r\n      this.configManager.setIconSet(this.originalConfig.iconSet)\r\n\r\n    if (this.originalConfig.features)\r\n      this.features.importConfig(this.originalConfig.features)\r\n  }\r\n}\r\n\r\n/**\r\n * ÊòæÁ§∫ÈÖçÁΩÆÈ¢ÑËßà\r\n */\r\nexport function showConfigPreview(preset: PresetName): ConfigPreview {\r\n  const preview = new ConfigPreview()\r\n  preview.show(preset)\r\n  return preview\r\n}\r\n"],"names":["ConfigPreview","componentFactory","getComponentFactory","configManager","getConfigManager","features","getFeatureFlags","modal","originalConfig","show","preset","saveOriginalConfig","applyPresetPreview","showPreviewPanel","theme","getThemeManager","getCurrentThemeName","iconSet","getIconSet","locale","getLocale","exportConfig","config","getPreset","defaultTheme","setTheme","icons","defaultSet","setIconSet","importConfig","desc","presetDescriptions","Modal","title","width","onClose","restoreOriginalConfig","content","document","createElement","style","cssText","innerHTML","icon","name","description","setContent","setFooter","createFooter","renderStats","statsContainer","getElementById","getStats","enabled","footer","cancelBtn","createButton","label","type","onClick","hide","applyBtn","localStorage","setItem","ui","toast","appendChild","showConfigPreview","preview"],"mappings":"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"}