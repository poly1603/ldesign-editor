{"version":3,"file":"ContextMenu.cjs","sources":["../../../src/mobile/components/ContextMenu.ts"],"sourcesContent":["/**\r\n * 上下文菜单组件\r\n * 长按后显示的快捷操作菜单\r\n */\r\n\r\nimport { EventEmitter } from '../../core/EventEmitter'\r\nimport { createLogger } from '../../utils/logger'\r\n\r\nconst logger = createLogger('ContextMenu')\r\n\r\nexport interface ContextMenuItem {\r\n  label: string\r\n  icon?: string\r\n  action?: () => void\r\n  type?: 'normal' | 'separator'\r\n  disabled?: boolean\r\n  destructive?: boolean\r\n}\r\n\r\nexport interface ContextMenuOptions {\r\n  container: HTMLElement\r\n  backgroundColor?: string\r\n  textColor?: string\r\n  borderRadius?: string\r\n  maxWidth?: string\r\n  zIndex?: number\r\n}\r\n\r\nexport interface ShowOptions {\r\n  x: number\r\n  y: number\r\n  items: ContextMenuItem[]\r\n  selectedText?: string\r\n}\r\n\r\nexport class ContextMenu extends EventEmitter {\r\n  private container: HTMLElement\r\n  private menuElement: HTMLElement\r\n  private options: Required<ContextMenuOptions>\r\n  private isVisible = false\r\n  private currentItems: ContextMenuItem[] = []\r\n\r\n  constructor(options: ContextMenuOptions) {\r\n    super()\r\n    this.container = options.container\r\n    this.options = {\r\n      backgroundColor: '#ffffff',\r\n      textColor: '#333333',\r\n      borderRadius: '8px',\r\n      maxWidth: '280px',\r\n      zIndex: 1001,\r\n      ...options,\r\n    }\r\n\r\n    this.createMenu()\r\n    this.setupEventListeners()\r\n  }\r\n\r\n  /**\r\n   * 创建菜单DOM\r\n   */\r\n  private createMenu(): void {\r\n    this.menuElement = document.createElement('div')\r\n    this.menuElement.className = 'context-menu'\r\n    this.menuElement.style.cssText = `\r\n      position: fixed;\r\n      background: ${this.options.backgroundColor};\r\n      border-radius: ${this.options.borderRadius};\r\n      box-shadow: 0 2px 16px rgba(0,0,0,0.2);\r\n      padding: 8px 0;\r\n      z-index: ${this.options.zIndex};\r\n      max-width: ${this.options.maxWidth};\r\n      min-width: 180px;\r\n      opacity: 0;\r\n      transform: scale(0.9);\r\n      transition: opacity 0.2s, transform 0.2s;\r\n      pointer-events: none;\r\n      will-change: transform, opacity;\r\n    `\r\n\r\n    document.body.appendChild(this.menuElement)\r\n  }\r\n\r\n  /**\r\n   * 设置事件监听器\r\n   */\r\n  private setupEventListeners(): void {\r\n    // 点击其他地方关闭菜单\r\n    document.addEventListener('click', (e) => {\r\n      if (!this.menuElement.contains(e.target as Node))\r\n        this.hide()\r\n    })\r\n\r\n    // 滚动时关闭菜单\r\n    window.addEventListener('scroll', () => {\r\n      if (this.isVisible)\r\n        this.hide()\r\n    }, { passive: true })\r\n\r\n    // 触摸开始关闭菜单\r\n    document.addEventListener('touchstart', (e) => {\r\n      if (!this.menuElement.contains(e.target as Node))\r\n        this.hide()\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 显示菜单\r\n   */\r\n  show(options: ShowOptions): void {\r\n    logger.info('Showing context menu', options)\r\n\r\n    this.currentItems = options.items\r\n    this.renderItems(options.items)\r\n\r\n    // 设置位置\r\n    const { x, y } = this.adjustPosition(options.x, options.y)\r\n    this.menuElement.style.left = `${x}px`\r\n    this.menuElement.style.top = `${y}px`\r\n\r\n    // 显示动画\r\n    this.menuElement.style.pointerEvents = 'auto'\r\n    requestAnimationFrame(() => {\r\n      this.menuElement.classList.add('visible')\r\n      this.menuElement.style.opacity = '1'\r\n      this.menuElement.style.transform = 'scale(1)'\r\n    })\r\n\r\n    this.isVisible = true\r\n    this.emit('show')\r\n  }\r\n\r\n  /**\r\n   * 隐藏菜单\r\n   */\r\n  hide(): void {\r\n    if (!this.isVisible)\r\n      return\r\n\r\n    this.menuElement.classList.remove('visible')\r\n    this.menuElement.style.opacity = '0'\r\n    this.menuElement.style.transform = 'scale(0.9)'\r\n    this.menuElement.style.pointerEvents = 'none'\r\n\r\n    setTimeout(() => {\r\n      this.menuElement.innerHTML = ''\r\n    }, 200)\r\n\r\n    this.isVisible = false\r\n    this.emit('hide')\r\n    logger.info('Context menu hidden')\r\n  }\r\n\r\n  /**\r\n   * 渲染菜单项\r\n   */\r\n  private renderItems(items: ContextMenuItem[]): void {\r\n    this.menuElement.innerHTML = ''\r\n\r\n    items.forEach((item, index) => {\r\n      if (item.type === 'separator')\r\n        this.menuElement.appendChild(this.createSeparator())\r\n      else\r\n        this.menuElement.appendChild(this.createMenuItem(item, index))\r\n    })\r\n  }\r\n\r\n  /**\r\n   * 创建菜单项\r\n   */\r\n  private createMenuItem(item: ContextMenuItem, index: number): HTMLElement {\r\n    const menuItem = document.createElement('div')\r\n    menuItem.className = 'context-menu-item'\r\n    menuItem.style.cssText = `\r\n      display: flex;\r\n      align-items: center;\r\n      padding: 12px 16px;\r\n      color: ${item.disabled ? '#999' : (item.destructive ? '#ff4444' : this.options.textColor)};\r\n      cursor: ${item.disabled ? 'not-allowed' : 'pointer'};\r\n      transition: background-color 0.15s;\r\n      font-size: 15px;\r\n      line-height: 1.4;\r\n      user-select: none;\r\n      -webkit-tap-highlight-color: transparent;\r\n    `\r\n\r\n    if (!item.disabled) {\r\n      // 悬停效果\r\n      menuItem.addEventListener('mouseenter', () => {\r\n        menuItem.style.backgroundColor = '#f5f5f5'\r\n      })\r\n\r\n      menuItem.addEventListener('mouseleave', () => {\r\n        menuItem.style.backgroundColor = 'transparent'\r\n      })\r\n\r\n      // 点击效果\r\n      menuItem.addEventListener('touchstart', () => {\r\n        menuItem.style.backgroundColor = '#e0e0e0'\r\n      })\r\n\r\n      menuItem.addEventListener('touchend', () => {\r\n        menuItem.style.backgroundColor = 'transparent'\r\n      })\r\n\r\n      // 点击处理\r\n      menuItem.addEventListener('click', (e) => {\r\n        e.stopPropagation()\r\n\r\n        // 点击动画\r\n        this.animateItemClick(menuItem)\r\n\r\n        // 延迟执行动作，让动画完成\r\n        setTimeout(() => {\r\n          if (item.action)\r\n            item.action()\r\n\r\n          this.emit('itemclick', item, index)\r\n          this.hide()\r\n        }, 150)\r\n      })\r\n    }\r\n\r\n    // 图标\r\n    if (item.icon) {\r\n      const icon = document.createElement('span')\r\n      icon.className = 'context-menu-item-icon'\r\n      icon.style.cssText = `\r\n        margin-right: 12px;\r\n        font-size: 18px;\r\n        width: 24px;\r\n        text-align: center;\r\n        flex-shrink: 0;\r\n      `\r\n      icon.textContent = item.icon\r\n      menuItem.appendChild(icon)\r\n    }\r\n\r\n    // 标签\r\n    const label = document.createElement('span')\r\n    label.className = 'context-menu-item-label'\r\n    label.style.cssText = `\r\n      flex: 1;\r\n    `\r\n    label.textContent = item.label\r\n    menuItem.appendChild(label)\r\n\r\n    // 快捷键提示（如果有）\r\n    if ((item as any).shortcut) {\r\n      const shortcut = document.createElement('span')\r\n      shortcut.className = 'context-menu-item-shortcut'\r\n      shortcut.style.cssText = `\r\n        margin-left: 20px;\r\n        color: #999;\r\n        font-size: 13px;\r\n      `\r\n      shortcut.textContent = (item as any).shortcut\r\n      menuItem.appendChild(shortcut)\r\n    }\r\n\r\n    return menuItem\r\n  }\r\n\r\n  /**\r\n   * 创建分隔线\r\n   */\r\n  private createSeparator(): HTMLElement {\r\n    const separator = document.createElement('div')\r\n    separator.className = 'context-menu-separator'\r\n    separator.style.cssText = `\r\n      height: 1px;\r\n      background: #e0e0e0;\r\n      margin: 4px 0;\r\n    `\r\n    return separator\r\n  }\r\n\r\n  /**\r\n   * 调整位置以确保菜单在屏幕内\r\n   */\r\n  private adjustPosition(x: number, y: number): { x: number, y: number } {\r\n    // 临时显示以获取尺寸\r\n    this.menuElement.style.visibility = 'hidden'\r\n    this.menuElement.style.display = 'block'\r\n\r\n    const menuRect = this.menuElement.getBoundingClientRect()\r\n    const menuWidth = menuRect.width\r\n    const menuHeight = menuRect.height\r\n\r\n    this.menuElement.style.visibility = ''\r\n    this.menuElement.style.display = ''\r\n\r\n    const padding = 10\r\n    const viewportWidth = window.innerWidth\r\n    const viewportHeight = window.innerHeight\r\n\r\n    // 调整X坐标\r\n    let adjustedX = x\r\n    if (x + menuWidth + padding > viewportWidth) {\r\n      adjustedX = x - menuWidth\r\n      if (adjustedX < padding)\r\n        adjustedX = viewportWidth - menuWidth - padding\r\n    }\r\n    if (adjustedX < padding)\r\n      adjustedX = padding\r\n\r\n    // 调整Y坐标\r\n    let adjustedY = y\r\n    if (y + menuHeight + padding > viewportHeight) {\r\n      adjustedY = y - menuHeight\r\n      if (adjustedY < padding)\r\n        adjustedY = viewportHeight - menuHeight - padding\r\n    }\r\n    if (adjustedY < padding)\r\n      adjustedY = padding\r\n\r\n    return { x: adjustedX, y: adjustedY }\r\n  }\r\n\r\n  /**\r\n   * 菜单项点击动画\r\n   */\r\n  private animateItemClick(element: HTMLElement): void {\r\n    // 创建涟漪效果\r\n    const ripple = document.createElement('div')\r\n    ripple.style.cssText = `\r\n      position: absolute;\r\n      border-radius: 50%;\r\n      background: rgba(0, 0, 0, 0.1);\r\n      transform: scale(0);\r\n      animation: ripple 0.4s ease-out;\r\n      pointer-events: none;\r\n    `\r\n\r\n    // 设置涟漪位置\r\n    const rect = element.getBoundingClientRect()\r\n    const size = Math.max(rect.width, rect.height)\r\n    ripple.style.width = ripple.style.height = `${size}px`\r\n    ripple.style.left = `${rect.width / 2 - size / 2}px`\r\n    ripple.style.top = `${rect.height / 2 - size / 2}px`\r\n\r\n    element.style.position = 'relative'\r\n    element.appendChild(ripple)\r\n\r\n    // 添加动画样式\r\n    const style = document.createElement('style')\r\n    style.textContent = `\r\n      @keyframes ripple {\r\n        to {\r\n          transform: scale(2);\r\n          opacity: 0;\r\n        }\r\n      }\r\n    `\r\n    document.head.appendChild(style)\r\n\r\n    // 清理\r\n    setTimeout(() => {\r\n      ripple.remove()\r\n      style.remove()\r\n    }, 400)\r\n  }\r\n\r\n  /**\r\n   * 更新菜单项\r\n   */\r\n  updateItems(items: ContextMenuItem[]): void {\r\n    if (this.isVisible) {\r\n      this.currentItems = items\r\n      this.renderItems(items)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 设置菜单项启用/禁用状态\r\n   */\r\n  setItemEnabled(index: number, enabled: boolean): void {\r\n    if (index >= 0 && index < this.currentItems.length) {\r\n      this.currentItems[index].disabled = !enabled\r\n      if (this.isVisible)\r\n        this.renderItems(this.currentItems)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * 获取当前显示状态\r\n   */\r\n  getVisible(): boolean {\r\n    return this.isVisible\r\n  }\r\n\r\n  /**\r\n   * 销毁菜单\r\n   */\r\n  destroy(): void {\r\n    this.hide()\r\n    this.menuElement.remove()\r\n    this.removeAllListeners()\r\n  }\r\n}\r\n"],"names":["logger","createLogger","ContextMenu","EventEmitter","constructor","options","isVisible","currentItems","container","backgroundColor","textColor","borderRadius","maxWidth","zIndex","createMenu","setupEventListeners","menuElement","document","createElement","className","style","cssText","body","appendChild","addEventListener","e","contains","target","hide","window","passive","show","info","items","renderItems","x","y","adjustPosition","left","top","pointerEvents","requestAnimationFrame","classList","add","opacity","transform","emit","remove","setTimeout","innerHTML","forEach","item","index","type","createSeparator","createMenuItem","menuItem","disabled","destructive","stopPropagation","animateItemClick","action","icon","textContent","label","shortcut","separator","visibility","display","menuRect","getBoundingClientRect","menuWidth","width","menuHeight","height","padding","viewportWidth","innerWidth","viewportHeight","innerHeight","adjustedX","adjustedY","element","ripple","rect","size","Math","max","position","head","updateItems","setItemEnabled","enabled","length","getVisible","destroy","removeAllListeners"],"mappings":";;;;;;;;;;;;;;AAQA,MAAMA,MAAAA,GAASC,sBAAa,aAAa,CAAA;AA2BlC,MAAMC,oBAAoBC,kBAAAA,CAAa;AAAA,EAO5CC,YAAYC,OAAAA,EAA6B;AACvC,IAAA,KAAA,EAAM;AAJR,IAAA,IAAA,CAAQC,SAAAA,GAAY,KAAA;AACpB,IAAA,IAAA,CAAQC,eAAkC,EAAA;AAIxC,IAAA,IAAA,CAAKC,YAAYH,OAAAA,CAAQG,SAAAA;AACzB,IAAA,IAAA,CAAKH,OAAAA,GAAU;AAAA,MACbI,eAAAA,EAAiB,SAAA;AAAA,MACjBC,SAAAA,EAAW,SAAA;AAAA,MACXC,YAAAA,EAAc,KAAA;AAAA,MACdC,QAAAA,EAAU,OAAA;AAAA,MACVC,MAAAA,EAAQ,IAAA;AAAA,MACR,GAAGR;AAAAA,KACL;AAEA,IAAA,IAAA,CAAKS,UAAAA,EAAW;AAChB,IAAA,IAAA,CAAKC,mBAAAA,EAAoB;AAAA,EAC3B;AAAA;AAAA;AAAA;AAAA,EAKQD,UAAAA,GAAmB;AACzB,IAAA,IAAA,CAAKE,WAAAA,GAAcC,QAAAA,CAASC,aAAAA,CAAc,KAAK,CAAA;AAC/C,IAAA,IAAA,CAAKF,YAAYG,SAAAA,GAAY,cAAA;AAC7B,IAAA,IAAA,CAAKH,WAAAA,CAAYI,MAAMC,OAAAA,GAAU;AAAA;AAAA,kBAAA,EAEjB,IAAA,CAAKhB,QAAQI,eAAe,CAAA;AAAA,qBAAA,EACzB,IAAA,CAAKJ,QAAQM,YAAY,CAAA;AAAA;AAAA;AAAA,eAAA,EAG/B,IAAA,CAAKN,QAAQQ,MAAM,CAAA;AAAA,iBAAA,EACjB,IAAA,CAAKR,QAAQO,QAAQ,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAA,CAAA;AASpCK,IAAAA,QAAAA,CAASK,IAAAA,CAAKC,WAAAA,CAAY,IAAA,CAAKP,WAAW,CAAA;AAAA,EAC5C;AAAA;AAAA;AAAA;AAAA,EAKQD,mBAAAA,GAA4B;AAElCE,IAAAA,QAAAA,CAASO,gBAAAA,CAAiB,SAAUC,CAAAA,CAAAA,KAAM;AACxC,MAAA,IAAI,CAAC,IAAA,CAAKT,WAAAA,CAAYU,QAAAA,CAASD,EAAEE,MAAc,CAAA;AAC7C,QAAA,IAAA,CAAKC,IAAAA,EAAK;AAAA,IACd,CAAC,CAAA;AAGDC,IAAAA,MAAAA,CAAOL,gBAAAA,CAAiB,UAAU,MAAM;AACtC,MAAA,IAAI,IAAA,CAAKlB,SAAAA;AACP,QAAA,IAAA,CAAKsB,IAAAA,EAAK;AAAA,IACd,CAAA,EAAG;AAAA,MAAEE,OAAAA,EAAS;AAAA,KAAM,CAAA;AAGpBb,IAAAA,QAAAA,CAASO,gBAAAA,CAAiB,cAAeC,CAAAA,CAAAA,KAAM;AAC7C,MAAA,IAAI,CAAC,IAAA,CAAKT,WAAAA,CAAYU,QAAAA,CAASD,EAAEE,MAAc,CAAA;AAC7C,QAAA,IAAA,CAAKC,IAAAA,EAAK;AAAA,IACd,CAAC,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKAG,KAAK1B,OAAAA,EAA4B;AAC/BL,IAAAA,MAAAA,CAAOgC,IAAAA,CAAK,wBAAwB3B,OAAO,CAAA;AAE3C,IAAA,IAAA,CAAKE,eAAeF,OAAAA,CAAQ4B,KAAAA;AAC5B,IAAA,IAAA,CAAKC,WAAAA,CAAY7B,QAAQ4B,KAAK,CAAA;AAG9B,IAAA,MAAM;AAAA,MAAEE,CAAAA;AAAAA,MAAGC;AAAAA,QAAM,IAAA,CAAKC,cAAAA,CAAehC,OAAAA,CAAQ8B,CAAAA,EAAG9B,QAAQ+B,CAAC,CAAA;AACzD,IAAA,IAAA,CAAKpB,WAAAA,CAAYI,KAAAA,CAAMkB,IAAAA,GAAO,CAAA,EAAGH,CAAC,CAAA,EAAA,CAAA;AAClC,IAAA,IAAA,CAAKnB,WAAAA,CAAYI,KAAAA,CAAMmB,GAAAA,GAAM,CAAA,EAAGH,CAAC,CAAA,EAAA,CAAA;AAGjC,IAAA,IAAA,CAAKpB,WAAAA,CAAYI,MAAMoB,aAAAA,GAAgB,MAAA;AACvCC,IAAAA,qBAAAA,CAAsB,MAAM;AAC1B,MAAA,IAAA,CAAKzB,WAAAA,CAAY0B,SAAAA,CAAUC,GAAAA,CAAI,SAAS,CAAA;AACxC,MAAA,IAAA,CAAK3B,WAAAA,CAAYI,MAAMwB,OAAAA,GAAU,GAAA;AACjC,MAAA,IAAA,CAAK5B,WAAAA,CAAYI,MAAMyB,SAAAA,GAAY,UAAA;AAAA,IACrC,CAAC,CAAA;AAED,IAAA,IAAA,CAAKvC,SAAAA,GAAY,IAAA;AACjB,IAAA,IAAA,CAAKwC,KAAK,MAAM,CAAA;AAAA,EAClB;AAAA;AAAA;AAAA;AAAA,EAKAlB,IAAAA,GAAa;AACX,IAAA,IAAI,CAAC,IAAA,CAAKtB,SAAAA;AACR,MAAA;AAEF,IAAA,IAAA,CAAKU,WAAAA,CAAY0B,SAAAA,CAAUK,MAAAA,CAAO,SAAS,CAAA;AAC3C,IAAA,IAAA,CAAK/B,WAAAA,CAAYI,MAAMwB,OAAAA,GAAU,GAAA;AACjC,IAAA,IAAA,CAAK5B,WAAAA,CAAYI,MAAMyB,SAAAA,GAAY,YAAA;AACnC,IAAA,IAAA,CAAK7B,WAAAA,CAAYI,MAAMoB,aAAAA,GAAgB,MAAA;AAEvCQ,IAAAA,UAAAA,CAAW,MAAM;AACf,MAAA,IAAA,CAAKhC,YAAYiC,SAAAA,GAAY,EAAA;AAAA,IAC/B,GAAG,GAAG,CAAA;AAEN,IAAA,IAAA,CAAK3C,SAAAA,GAAY,KAAA;AACjB,IAAA,IAAA,CAAKwC,KAAK,MAAM,CAAA;AAChB9C,IAAAA,MAAAA,CAAOgC,KAAK,qBAAqB,CAAA;AAAA,EACnC;AAAA;AAAA;AAAA;AAAA,EAKQE,YAAYD,KAAAA,EAAgC;AAClD,IAAA,IAAA,CAAKjB,YAAYiC,SAAAA,GAAY,EAAA;AAE7BhB,IAAAA,KAAAA,CAAMiB,OAAAA,CAAQ,CAACC,IAAAA,EAAMC,KAAAA,KAAU;AAC7B,MAAA,IAAID,KAAKE,IAAAA,KAAS,WAAA;AAChB,QAAA,IAAA,CAAKrC,WAAAA,CAAYO,WAAAA,CAAY,IAAA,CAAK+B,eAAAA,EAAiB,CAAA;AAAA;AAEnD,QAAA,IAAA,CAAKtC,YAAYO,WAAAA,CAAY,IAAA,CAAKgC,cAAAA,CAAeJ,IAAAA,EAAMC,KAAK,CAAC,CAAA;AAAA,IACjE,CAAC,CAAA;AAAA,EACH;AAAA;AAAA;AAAA;AAAA,EAKQG,cAAAA,CAAeJ,MAAuBC,KAAAA,EAA4B;AACxE,IAAA,MAAMI,QAAAA,GAAWvC,QAAAA,CAASC,aAAAA,CAAc,KAAK,CAAA;AAC7CsC,IAAAA,QAAAA,CAASrC,SAAAA,GAAY,mBAAA;AACrBqC,IAAAA,QAAAA,CAASpC,MAAMC,OAAAA,GAAU;AAAA;AAAA;AAAA;AAAA,aAAA,EAId8B,IAAAA,CAAKM,WAAW,MAAA,GAAUN,IAAAA,CAAKO,cAAc,SAAA,GAAY,IAAA,CAAKrD,QAAQK,SAAU,CAAA;AAAA,cAAA,EAC/EyC,IAAAA,CAAKM,QAAAA,GAAW,aAAA,GAAgB,SAAS,CAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAA,CAAA;AAQrD,IAAA,IAAI,CAACN,KAAKM,QAAAA,EAAU;AAElBD,MAAAA,QAAAA,CAAShC,gBAAAA,CAAiB,cAAc,MAAM;AAC5CgC,QAAAA,QAAAA,CAASpC,MAAMX,eAAAA,GAAkB,SAAA;AAAA,MACnC,CAAC,CAAA;AAED+C,MAAAA,QAAAA,CAAShC,gBAAAA,CAAiB,cAAc,MAAM;AAC5CgC,QAAAA,QAAAA,CAASpC,MAAMX,eAAAA,GAAkB,aAAA;AAAA,MACnC,CAAC,CAAA;AAGD+C,MAAAA,QAAAA,CAAShC,gBAAAA,CAAiB,cAAc,MAAM;AAC5CgC,QAAAA,QAAAA,CAASpC,MAAMX,eAAAA,GAAkB,SAAA;AAAA,MACnC,CAAC,CAAA;AAED+C,MAAAA,QAAAA,CAAShC,gBAAAA,CAAiB,YAAY,MAAM;AAC1CgC,QAAAA,QAAAA,CAASpC,MAAMX,eAAAA,GAAkB,aAAA;AAAA,MACnC,CAAC,CAAA;AAGD+C,MAAAA,QAAAA,CAAShC,gBAAAA,CAAiB,SAAUC,CAAAA,CAAAA,KAAM;AACxCA,QAAAA,CAAAA,CAAEkC,eAAAA,EAAgB;AAGlB,QAAA,IAAA,CAAKC,iBAAiBJ,QAAQ,CAAA;AAG9BR,QAAAA,UAAAA,CAAW,MAAM;AACf,UAAA,IAAIG,IAAAA,CAAKU,MAAAA;AACPV,YAAAA,IAAAA,CAAKU,MAAAA,EAAO;AAEd,UAAA,IAAA,CAAKf,IAAAA,CAAK,WAAA,EAAaK,IAAAA,EAAMC,KAAK,CAAA;AAClC,UAAA,IAAA,CAAKxB,IAAAA,EAAK;AAAA,QACZ,GAAG,GAAG,CAAA;AAAA,MACR,CAAC,CAAA;AAAA,IACH;AAGA,IAAA,IAAIuB,KAAKW,IAAAA,EAAM;AACb,MAAA,MAAMA,IAAAA,GAAO7C,QAAAA,CAASC,aAAAA,CAAc,MAAM,CAAA;AAC1C4C,MAAAA,IAAAA,CAAK3C,SAAAA,GAAY,wBAAA;AACjB2C,MAAAA,IAAAA,CAAK1C,MAAMC,OAAAA,GAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,MAAA,CAAA;AAOrByC,MAAAA,IAAAA,CAAKC,cAAcZ,IAAAA,CAAKW,IAAAA;AACxBN,MAAAA,QAAAA,CAASjC,YAAYuC,IAAI,CAAA;AAAA,IAC3B;AAGA,IAAA,MAAME,KAAAA,GAAQ/C,QAAAA,CAASC,aAAAA,CAAc,MAAM,CAAA;AAC3C8C,IAAAA,KAAAA,CAAM7C,SAAAA,GAAY,yBAAA;AAClB6C,IAAAA,KAAAA,CAAM5C,MAAMC,OAAAA,GAAU;AAAA;AAAA,IAAA,CAAA;AAGtB2C,IAAAA,KAAAA,CAAMD,cAAcZ,IAAAA,CAAKa,KAAAA;AACzBR,IAAAA,QAAAA,CAASjC,YAAYyC,KAAK,CAAA;AAG1B,IAAA,IAAKb,KAAac,QAAAA,EAAU;AAC1B,MAAA,MAAMA,QAAAA,GAAWhD,QAAAA,CAASC,aAAAA,CAAc,MAAM,CAAA;AAC9C+C,MAAAA,QAAAA,CAAS9C,SAAAA,GAAY,4BAAA;AACrB8C,MAAAA,QAAAA,CAAS7C,MAAMC,OAAAA,GAAU;AAAA;AAAA;AAAA;AAAA,MAAA,CAAA;AAKzB4C,MAAAA,QAAAA,CAASF,cAAeZ,IAAAA,CAAac,QAAAA;AACrCT,MAAAA,QAAAA,CAASjC,YAAY0C,QAAQ,CAAA;AAAA,IAC/B;AAEA,IAAA,OAAOT,QAAAA;AAAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQF,eAAAA,GAA+B;AACrC,IAAA,MAAMY,SAAAA,GAAYjD,QAAAA,CAASC,aAAAA,CAAc,KAAK,CAAA;AAC9CgD,IAAAA,SAAAA,CAAU/C,SAAAA,GAAY,wBAAA;AACtB+C,IAAAA,SAAAA,CAAU9C,MAAMC,OAAAA,GAAU;AAAA;AAAA;AAAA;AAAA,IAAA,CAAA;AAK1B,IAAA,OAAO6C,SAAAA;AAAAA,EACT;AAAA;AAAA;AAAA;AAAA,EAKQ7B,cAAAA,CAAeF,GAAWC,CAAAA,EAAqC;AAErE,IAAA,IAAA,CAAKpB,WAAAA,CAAYI,MAAM+C,UAAAA,GAAa,QAAA;AACpC,IAAA,IAAA,CAAKnD,WAAAA,CAAYI,MAAMgD,OAAAA,GAAU,OAAA;AAEjC,IAAA,MAAMC,QAAAA,GAAW,IAAA,CAAKrD,WAAAA,CAAYsD,qBAAAA,EAAsB;AACxD,IAAA,MAAMC,YAAYF,QAAAA,CAASG,KAAAA;AAC3B,IAAA,MAAMC,aAAaJ,QAAAA,CAASK,MAAAA;AAE5B,IAAA,IAAA,CAAK1D,WAAAA,CAAYI,MAAM+C,UAAAA,GAAa,EAAA;AACpC,IAAA,IAAA,CAAKnD,WAAAA,CAAYI,MAAMgD,OAAAA,GAAU,EAAA;AAEjC,IAAA,MAAMO,OAAAA,GAAU,EAAA;AAChB,IAAA,MAAMC,gBAAgB/C,MAAAA,CAAOgD,UAAAA;AAC7B,IAAA,MAAMC,iBAAiBjD,MAAAA,CAAOkD,WAAAA;AAG9B,IAAA,IAAIC,SAAAA,GAAY7C,CAAAA;AAChB,IAAA,IAAIA,CAAAA,GAAIoC,SAAAA,GAAYI,OAAAA,GAAUC,aAAAA,EAAe;AAC3CI,MAAAA,SAAAA,GAAY7C,CAAAA,GAAIoC,SAAAA;AAChB,MAAA,IAAIS,SAAAA,GAAYL,OAAAA;AACdK,QAAAA,SAAAA,GAAYJ,gBAAgBL,SAAAA,GAAYI,OAAAA;AAAAA,IAC5C;AACA,IAAA,IAAIK,SAAAA,GAAYL,OAAAA;AACdK,MAAAA,SAAAA,GAAYL,OAAAA;AAGd,IAAA,IAAIM,SAAAA,GAAY7C,CAAAA;AAChB,IAAA,IAAIA,CAAAA,GAAIqC,UAAAA,GAAaE,OAAAA,GAAUG,cAAAA,EAAgB;AAC7CG,MAAAA,SAAAA,GAAY7C,CAAAA,GAAIqC,UAAAA;AAChB,MAAA,IAAIQ,SAAAA,GAAYN,OAAAA;AACdM,QAAAA,SAAAA,GAAYH,iBAAiBL,UAAAA,GAAaE,OAAAA;AAAAA,IAC9C;AACA,IAAA,IAAIM,SAAAA,GAAYN,OAAAA;AACdM,MAAAA,SAAAA,GAAYN,OAAAA;AAEd,IAAA,OAAO;AAAA,MAAExC,CAAAA,EAAG6C,SAAAA;AAAAA,MAAW5C,CAAAA,EAAG6C;AAAAA,KAAU;AAAA,EACtC;AAAA;AAAA;AAAA;AAAA,EAKQrB,iBAAiBsB,OAAAA,EAA4B;AAEnD,IAAA,MAAMC,MAAAA,GAASlE,QAAAA,CAASC,aAAAA,CAAc,KAAK,CAAA;AAC3CiE,IAAAA,MAAAA,CAAO/D,MAAMC,OAAAA,GAAU;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAA,CAAA;AAUvB,IAAA,MAAM+D,IAAAA,GAAOF,QAAQZ,qBAAAA,EAAsB;AAC3C,IAAA,MAAMe,OAAOC,IAAAA,CAAKC,GAAAA,CAAIH,IAAAA,CAAKZ,KAAAA,EAAOY,KAAKV,MAAM,CAAA;AAC7CS,IAAAA,MAAAA,CAAO/D,MAAMoD,KAAAA,GAAQW,MAAAA,CAAO/D,KAAAA,CAAMsD,MAAAA,GAAS,GAAGW,IAAI,CAAA,EAAA,CAAA;AAClDF,IAAAA,MAAAA,CAAO/D,MAAMkB,IAAAA,GAAO,CAAA,EAAG8C,KAAKZ,KAAAA,GAAQ,CAAA,GAAIa,OAAO,CAAC,CAAA,EAAA,CAAA;AAChDF,IAAAA,MAAAA,CAAO/D,MAAMmB,GAAAA,GAAM,CAAA,EAAG6C,KAAKV,MAAAA,GAAS,CAAA,GAAIW,OAAO,CAAC,CAAA,EAAA,CAAA;AAEhDH,IAAAA,OAAAA,CAAQ9D,MAAMoE,QAAAA,GAAW,UAAA;AACzBN,IAAAA,OAAAA,CAAQ3D,YAAY4D,MAAM,CAAA;AAG1B,IAAA,MAAM/D,KAAAA,GAAQH,QAAAA,CAASC,aAAAA,CAAc,OAAO,CAAA;AAC5CE,IAAAA,KAAAA,CAAM2C,WAAAA,GAAc;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAA,CAAA;AAQpB9C,IAAAA,QAAAA,CAASwE,IAAAA,CAAKlE,YAAYH,KAAK,CAAA;AAG/B4B,IAAAA,UAAAA,CAAW,MAAM;AACfmC,MAAAA,MAAAA,CAAOpC,MAAAA,EAAO;AACd3B,MAAAA,KAAAA,CAAM2B,MAAAA,EAAO;AAAA,IACf,GAAG,GAAG,CAAA;AAAA,EACR;AAAA;AAAA;AAAA;AAAA,EAKA2C,YAAYzD,KAAAA,EAAgC;AAC1C,IAAA,IAAI,KAAK3B,SAAAA,EAAW;AAClB,MAAA,IAAA,CAAKC,YAAAA,GAAe0B,KAAAA;AACpB,MAAA,IAAA,CAAKC,YAAYD,KAAK,CAAA;AAAA,IACxB;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKA0D,cAAAA,CAAevC,OAAewC,OAAAA,EAAwB;AACpD,IAAA,IAAIxC,KAAAA,IAAS,CAAA,IAAKA,KAAAA,GAAQ,IAAA,CAAK7C,aAAasF,MAAAA,EAAQ;AAClD,MAAA,IAAA,CAAKtF,YAAAA,CAAa6C,KAAK,CAAA,CAAEK,QAAAA,GAAW,CAACmC,OAAAA;AACrC,MAAA,IAAI,IAAA,CAAKtF,SAAAA;AACP,QAAA,IAAA,CAAK4B,WAAAA,CAAY,KAAK3B,YAAY,CAAA;AAAA,IACtC;AAAA,EACF;AAAA;AAAA;AAAA;AAAA,EAKAuF,UAAAA,GAAsB;AACpB,IAAA,OAAO,IAAA,CAAKxF,SAAAA;AAAAA,EACd;AAAA;AAAA;AAAA;AAAA,EAKAyF,OAAAA,GAAgB;AACd,IAAA,IAAA,CAAKnE,IAAAA,EAAK;AACV,IAAA,IAAA,CAAKZ,YAAY+B,MAAAA,EAAO;AACxB,IAAA,IAAA,CAAKiD,kBAAAA,EAAmB;AAAA,EAC1B;AACF;;;;;;;"}